const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/patientAssignmentService-B6ys9UHG.js","assets/vendor-Rp3sEA6r.js","assets/react-router-B7yWDzBH.js","assets/toasts-3Sy9R3Aj.js","assets/toasts-VYesxZYF.css","assets/axios-ngrFHoWO.js","assets/icons-FrqMqd6W.js","assets/date-fns-dl2yiHM3.js"])))=>i.map(i=>d[i]);
import{r as c,f as za,l as e,n as Ys}from"./vendor-Rp3sEA6r.js";import{u as je,L as oa,a as Ks,N as cr,O as qr,b as Xs,B as Qs,R as Zs,c as me}from"./react-router-B7yWDzBH.js";import{z as h,F as Ws,L as et}from"./toasts-3Sy9R3Aj.js";import{a as at}from"./axios-ngrFHoWO.js";import{U as ia,S as Ge,C as cs,a as br,H as Fr,L as Ca,b as Ur,A as zr,X as Fe,M as rt,P as Se,c as st,d as tt,V as ot,e as Pa,f as ve,g as ds,h as Pe,i as la,j as dr,k as da,l as yr,m as Ba,F as ua,n as us,o as Ha,p as ur,q as ca,r as vr,s as mr,t as Sa,u as ms,v as ra,w as Ka,x as ka,T as Ye,y as nt,z as it,B as gr,D as gs,E as lt,G as ct,I as dt,J as ut,K as mt,N as gt,R as xt,O as Va,Q as ht,W as xs,Y as hs,Z as ps}from"./icons-FrqMqd6W.js";import{f as ge,l as Ue,a as fs}from"./date-fns-dl2yiHM3.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))t(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&t(i)}).observe(document,{childList:!0,subtree:!0});function a(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function t(o){if(o.ep)return;o.ep=!0;const n=a(o);fetch(o.href,n)}})();const pt={},Xa=pt,jr=Xa.VITE_SUPABASE_URL||"https://yuanqfswhberkoevtmfr.supabase.co",Ja=Xa.VITE_SUPABASE_ANON_KEY||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inl1YW5xZnN3aGJlcmtvZXZ0bWZyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ5NTQzNjksImV4cCI6MjA3MDUzMDM2OX0.g8Fm4XAvtX46zifBZnYVH4tVuQkqUH6Ia9CXQj4DztQ",bs=Xa.VITE_SERVICE_EMAIL||"",ys=Xa.VITE_SERVICE_PASSWORD||"";function ft(){return!!(bs&&ys)}function Br(s){try{const r=s.replace(/-/g,"+").replace(/_/g,"/")+"===".slice((s.length+3)%4);return decodeURIComponent(atob(r).split("").map(a=>`%${("00"+a.charCodeAt(0).toString(16)).slice(-2)}`).join(""))}catch{return""}}function ma(s){if(!s)return{valid:!1};const r=s.split(".");if(r.length<2)return{valid:!1,raw:s};let a,t;try{a=JSON.parse(Br(r[0])||"{}")}catch{}try{t=JSON.parse(Br(r[1])||"{}")}catch{}let o,n;const i=t?.exp||void 0;return i&&(n=new Date(i*1e3),o=Date.now()>i*1e3),{header:a,payload:t,raw:s,valid:!0,expired:o,expiresAt:n}}function bt(s="[tokenDebug]"){try{const r=localStorage.getItem("authToken")||localStorage.getItem("token"),a=ma(r);return a.valid?(console.info(s,"exp=",a.payload?.exp,a.expiresAt?a.expiresAt.toISOString():void 0,a.expired?"(EXPIRADO)":"(válido)",{sub:a.payload?.sub,role:a.payload?.role,email:a.payload?.email}),a):(console.info(s,"Nenhum token válido encontrado."),a)}catch(r){return console.warn(s,"Falha ao inspecionar token",r),{valid:!1}}}typeof window<"u"&&(window.__logTokenInfo=()=>{bt()});let ze=null,Ea=null,qa=null,tr=null;function vs(){if(!ze?.expires_at)return;const r=ze.expires_at*1e3-Date.now()-60*1e3;if(tr&&window.clearTimeout(tr),r<=500){Hr();return}tr=window.setTimeout(()=>{Hr()},r),console.info("[TokenManager] Próximo refresh em",Math.round(r/1e3),"s")}async function yt(){if(!ft())return console.warn("[TokenManager] Credenciais de serviço ausentes. Configure VITE_SERVICE_EMAIL e VITE_SERVICE_PASSWORD."),null;try{const s=`${jr}/auth/v1/token?grant_type=password`,r=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:bs,password:ys})});if(!r.ok){const o=await r.text();return console.error("[TokenManager] Falha ao obter token",r.status,o),null}const a=await r.json(),t=ma(a.access_token);return ze={access_token:a.access_token,refresh_token:a.refresh_token,expires_at:t.payload?.exp},vs(),console.info("[TokenManager] Token técnico obtido. exp=",t.payload?.exp,"expired?",t.expired),ze.access_token}catch(s){return console.error("[TokenManager] Erro inesperado ao obter token",s),null}finally{qa=null}}async function vt(){if(!Ea){if(ze?.access_token&&!ma(ze.access_token).expired){vs();return}await js()}}async function js(){return Ea||(ze?.access_token&&!ma(ze.access_token).expired?ze.access_token:(qa||(qa=yt()),qa))}async function Hr(){return console.info("[TokenManager] Renovando token técnico..."),js()}function jt(s){Ea=s,console.info(Ea?"[TokenManager] Token externo (LUMI) definido. Ignorando token técnico.":"[TokenManager] Token externo removido.")}typeof window<"u"&&(window.__setApiBearer=s=>{jt(s)});vt();const Nt="modulepreload",wt=function(s){return"/"+s},Vr={},fe=function(r,a,t){let o=Promise.resolve();if(a&&a.length>0){let b=function(y){return Promise.all(y.map(d=>Promise.resolve(d).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),m=i?.nonce||i?.getAttribute("nonce");o=b(a.map(y=>{if(y=wt(y),y in Vr)return;Vr[y]=!0;const d=y.endsWith(".css"),g=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${y}"]${g}`))return;const p=document.createElement("link");if(p.rel=d?"stylesheet":Nt,d||(p.as="script"),p.crossOrigin="",p.href=y,m&&p.setAttribute("nonce",m),document.head.appendChild(p),d)return new Promise((E,j)=>{p.addEventListener("load",E),p.addEventListener("error",()=>j(new Error(`Unable to preload CSS for ${y}`)))})}))}function n(i){const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=i,window.dispatchEvent(m),!m.defaultPrevented)throw i}return o.then(i=>{for(const m of i||[])m.status==="rejected"&&n(m.reason);return r().catch(n)})},Y={DOCTORS:"/rest/v1/doctors",PATIENTS:"/rest/v1/patients",PROFILES:"/rest/v1/profiles",REPORTS:"/rest/v1/reports",APPOINTMENTS:"/rest/v1/appointments",CONSULTATIONS:"/rest/v1/appointments",AVAILABLE_SLOTS:"/functions/v1/get-available-slots",DOCTOR_AVAILABILITY:"/rest/v1/doctor_availability",DOCTOR_EXCEPTIONS:"/rest/v1/doctor_exceptions",PATIENT_ASSIGNMENTS:"/rest/v1/patient_assignments",USER_ROLES:"/rest/v1/user_roles",SMS:"/rest/v1/sms"};class kt{accessToken=null;userData=null;REFRESH_KEY="refreshToken";LEGACY_ACCESS_KEYS=["authToken","token"];LEGACY_REFRESH_KEY="refreshToken";USER_KEY="authUser";migrated=!1;migrateLegacyStorage(){if(!this.migrated)try{for(const t of this.LEGACY_ACCESS_KEYS){const o=localStorage.getItem(t);o&&!this.accessToken&&(this.accessToken=o)}const r=localStorage.getItem(this.LEGACY_REFRESH_KEY);r&&!sessionStorage.getItem(this.REFRESH_KEY)&&sessionStorage.setItem(this.REFRESH_KEY,r);for(const t of this.LEGACY_ACCESS_KEYS)localStorage.removeItem(t);localStorage.removeItem(this.LEGACY_REFRESH_KEY);const a=localStorage.getItem(this.USER_KEY);if(a)try{this.userData=JSON.parse(a)}catch{}localStorage.removeItem(this.USER_KEY)}catch{}finally{this.migrated=!0}}setTokens(r,a){if(this.migrateLegacyStorage(),this.accessToken=r||null,a)try{sessionStorage.setItem(this.REFRESH_KEY,a)}catch{}}setUser(r){this.userData=r}getAccessToken(){return this.migrateLegacyStorage(),this.accessToken}getRefreshToken(){this.migrateLegacyStorage();try{return sessionStorage.getItem(this.REFRESH_KEY)}catch{return null}}getUser(){return this.userData||null}clear(){this.accessToken=null,this.userData=null,this.migrated=!1;try{sessionStorage.removeItem(this.REFRESH_KEY)}catch{}}snapshot(){return{accessToken:this.accessToken,refreshToken:this.getRefreshToken(),user:this.userData}}}const ye=new kt,Ke=Object.freeze(Object.defineProperty({__proto__:null,default:ye,tokenStore:ye},Symbol.toStringTag,{value:"Module"})),Jr={debug:10,info:20,warn:30,error:40},Ct=[/\b([A-Za-z0-9-_]{8,})\.([A-Za-z0-9-_]{8,})\.([A-Za-z0-9-_]{8,})\b/g,/\brefresh[_-]?token[a-z0-9]*=([A-Za-z0-9-_]+)/gi,/[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}/g],St=/\b(\d{3})[.]?(\d{3})[.]?(\d{3})[-]?(\d{2})\b/g;function xr(s){if(s==null)return s;if(typeof s=="string"){let r=s;for(const a of Ct)r=r.replace(a,"[REDACTED]");return r=r.replace(St,(a,t,o,n,i)=>`***CPF***${i}`),r}if(Array.isArray(s))return s.map(xr);if(typeof s=="object"){const r={};for(const[a,t]of Object.entries(s))/token|password|secret|email/i.test(a)?r[a]="[REDACTED]":r[a]=xr(t);return r}return s}class Et{level;enabled;constructor(r={}){this.level=r.level||"debug",this.enabled=r.enabled!==!1}setLevel(r){this.level=r}disable(){this.enabled=!1}enable(){this.enabled=!0}shouldLog(r){return this.enabled&&Jr[r]>=Jr[this.level]}emit(r,a,t){if(!this.shouldLog(r))return;const o=new Date().toISOString(),n=t?xr(t):void 0,i=`[${o}] ${r.toUpperCase()} ${a}`;r==="error"?console.error(i,n||""):r==="warn"?console.warn(i,n||""):r==="info"?console.info(i,n||""):console.debug(i,n||"")}debug(r,a){this.emit("debug",r,a)}info(r,a){this.emit("info",r,a)}warn(r,a){this.emit("warn",r,a)}error(r,a){this.emit("error",r,a)}}const ue=new Et({level:"info"}),ne=at.create({baseURL:jr,headers:{"Content-Type":"application/json",apikey:Ja}});ne.interceptors.request.use(async s=>{try{s.headers=s.headers||{};const r=s.headers;r.apikey||(r.apikey=Ja);const a=(s.url||"").toLowerCase(),t=a.includes("/auth/v1/token")||a.includes("/auth/v1/signup"),o=ye.getAccessToken();if(o&&!t)try{const n=o.split(".");if(n.length===3){const i=JSON.parse(atob(n[1])),m=Math.floor(Date.now()/1e3);i.exp&&i.exp<m?(ue.warn("token expirado detectado - removendo authorization"),ye.clear()):r.Authorization=`Bearer ${o}`}else r.Authorization=`Bearer ${o}`}catch{r.Authorization=`Bearer ${o}`}}catch(r){ue.warn("request interceptor error",{error:r?.message})}return s},s=>Promise.reject(s));ne.interceptors.response.use(s=>s,s=>{try{if(s?.response?.status===401){const t=(s.config||{}).headers||{},o=s?.response?.data?.message||s?.response?.data?.error||"Unauthorized";t.apikey?t.Authorization||ue.warn("401 missing bearer token",{msg:o}):ue.error("401 missing apikey",{msg:o})}}catch{}return Promise.reject(s)});class _t{tokenKey="authToken";userKey="authUser";refreshTokenKey="refreshToken";async login(r){try{ue.debug("login attempt",{email:r.email}),ue.debug("login endpoint",{url:"/auth/v1/token?grant_type=password"});const a=await ne.post("/auth/v1/token",r,{params:{grant_type:"password"}});ue.info("login success",{status:a.status});const t=a.data;return ye.setTokens(t.access_token,t.refresh_token),ye.setUser(t.user),ue.debug("tokens stored"),{success:!0,data:t}}catch(a){ue.error("login error",{error:a?.message});let t="Erro ao fazer login";if(a instanceof Error&&"response"in a){const n=a.response?.data;n?.error_code==="email_not_confirmed"?t="Email não confirmado. Verifique sua caixa de entrada ou configure o Supabase para não exigir confirmação.":n?.msg?t=n.msg:n?.message&&(t=n.message)}return{success:!1,error:t}}}async getUserInfo(){try{const a=(await ne.get("/auth/v1/user")).data;let t={user:{id:a.id,email:a.email,email_confirmed_at:a.email_confirmed_at,created_at:a.created_at,last_sign_in_at:a.last_sign_in_at},roles:[],permissions:{}};try{const o=await ne.get("/functions/v1/user-info");o.data&&(t=o.data)}catch{ue.warn("user-info edge function indisponível, usando dados básicos")}return{success:!0,data:t}}catch(r){return ue.error("erro ao obter user-info",{error:r?.message}),{success:!1,error:r instanceof Error&&"response"in r&&r.response?.data?.message||"Erro ao obter user-info"}}}async logout(){try{const r=await ne.post("/auth/v1/logout");r.status!==204&&r.status!==200&&console.warn("Status inesperado no logout:",r.status)}catch(r){r?.response?.status===401?ue.info("logout 401 token inválido/expirado (tratado)"):ue.warn("erro logout servidor",{error:r?.message})}finally{this.clearLocalAuth();try{ue.debug("snapshot pós-logout")}catch{}}return{success:!0}}async getCurrentUser(){try{return{success:!0,data:(await ne.get("/auth/v1/user")).data}}catch(r){return ue.error("erro ao obter usuário atual",{error:r?.message}),{success:!1,error:r instanceof Error&&"response"in r&&r.response?.data?.message||"Erro ao obter dados do usuário"}}}async getCurrentAuthUser(){return this.getCurrentUser()}getStoredToken(){return ye.getAccessToken()}getStoredUser(){return ye.getUser()}isAuthenticated(){return!!this.getStoredToken()}clearLocalAuth(){ye.clear();try{localStorage.removeItem(this.tokenKey)}catch{}try{localStorage.removeItem(this.userKey)}catch{}try{localStorage.removeItem(this.refreshTokenKey)}catch{}}async refreshToken(){try{const r=ye.getRefreshToken();if(!r)return{success:!1,error:"Refresh token não encontrado"};const a=`${jr}/auth/v1/token?grant_type=refresh_token`,t=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json",apikey:Ja,Authorization:`Bearer ${Ja}`},body:JSON.stringify({refresh_token:r})});if(!t.ok){const n=await t.text();return ue.warn("refresh token falhou",{status:t.status,body:n}),this.clearLocalAuth(),{success:!1,error:"Erro ao renovar token"}}const o=await t.json();return ye.setTokens(o.access_token,o.refresh_token),ye.setUser(o.user),{success:!0,data:o}}catch(r){return ue.error("erro ao renovar token",{error:r?.message}),this.clearLocalAuth(),{success:!1,error:"Erro ao renovar token"}}}async checkIsDoctor(r){try{ue.debug("verificando se usuário é médico",{userId:r});const t=(await ne.get("/rest/v1/doctors",{params:{user_id:`eq.${r}`,select:"*"}})).data;return Array.isArray(t)&&t.length>0?(ue.debug("usuario é médico",{doctorId:t[0].id}),{success:!0,data:{isDoctor:!0,doctorId:t[0].id,doctorData:t[0]}}):(ue.debug("usuario não é médico"),{success:!0,data:{isDoctor:!1}})}catch(a){return ue.error("erro ao verificar médico",{error:a?.message}),{success:!1,error:"Erro ao verificar credenciais de médico"}}}}const Ee=new _t,Ga=Object.freeze(Object.defineProperty({__proto__:null,authService:Ee,default:Ee},Symbol.toStringTag,{value:"Module"})),At={MAX_401_BEFORE_FORCED_LOGOUT:3};function Ns(s){if(typeof s=="string")return{message:s};const r=s,a=r?.response?.status,t=r?.response?.data||{},o=t.message||t.msg||t.error_description||t.error||t.hint||r.message||"Erro desconhecido",n=t.hint,i=t.details,m=n?`${o} (${n})`:i?`${o} (${i})`:o;return console.error("[HTTP] Erro capturado:",{status:a,message:m,code:t.code,details:t}),{status:a,message:m,code:t.code,details:t}}function Gr(s,r){const a=Ns(s);if(a.status===401)try{const t=ye.getAccessToken(),o=ma(t),n=o.valid?{exp:o.payload?.exp,expired:o.expired}:{valid:!1};aa+=1,ue.warn("401 response",{...n,count:aa}),aa>=It&&(ue.error("atingido limite de 401 consecutivos - forçando logout"),ye.clear())}catch{}return{success:!1,error:a.message||r}}async function Pt(s,r){return Qa("get",s,void 0,r,"Erro ao buscar dados")}async function Dt(s,r,a){return Qa("post",s,r,a,"Erro ao criar")}async function Mt(s,r,a){return Qa("patch",s,r,a,"Erro ao atualizar")}async function Tt(s,r){return Qa("delete",s,void 0,r,"Erro ao deletar")}let va=null,aa=0;const{MAX_401_BEFORE_FORCED_LOGOUT:It}=At;async function Rt(){if(va)return va;va=(async()=>ye.getRefreshToken()?(await Ee.refreshToken()).success:!1)();try{return await va}finally{va=null}}async function Qa(s,r,a,t,o){const n={originalErr:null,attemptedRefresh:!1};for(let i=0;i<2;i++)try{let m;return s==="get"?m=await ne.get(r,t):s==="post"?m=await ne.post(r,a,t):s==="patch"?m=await ne.patch(r,a,t):m=await ne.delete(r,t),aa>0&&(aa=0),{success:!0,data:m.data}}catch(m){if(n.originalErr=n.originalErr||m,Ns(m).status===401&&!n.attemptedRefresh){n.attemptedRefresh=!0;try{if(await Rt()){aa>0&&(aa=0);continue}}catch{}}return Gr(m,o)}return Gr(n.originalErr,o)}const Q={get:Pt,post:Dt,patch:Mt,delete:Tt};function ja(s){return{id:s.id,nome:s.full_name||s.nome||"",especialidade:s.specialty||s.especialidade||"",crm:s.crm||"",telefone:s.phone_mobile||s.telefone||"",email:s.email||"",status:s.active?"ativo":"inativo",created_at:s.created_at,updated_at:s.updated_at,crmUf:s.crm_uf,cpf:s.cpf,telefone2:s.phone2,cep:s.cep,rua:s.street,numero:s.number,complemento:s.complement,bairro:s.neighborhood,cidade:s.city,estado:s.state,dataNascimento:s.birth_date,rg:s.rg,active:s.active,createdBy:s.created_by,updatedBy:s.updated_by??null}}class Lt{async listarMedicos(r){try{let a=[];const t=[];let o=null;const n=[Y.DOCTORS];for(const b of n)try{const y={select:"*"};r?.status&&(y.active=r.status==="ativo"?"eq.true":"eq.false"),r?.especialidade&&(y.specialty=`ilike.%${r.especialidade}%`);const d=await Q.get(b,{params:y});if(t.push(b),d.success&&d.data){const g=Array.isArray(d.data)?d.data:[d.data];if(g.length){a=g.map(ja);break}}else d.error&&(o=d.error)}catch(y){o=y;const d=y;t.push(`${b} (erro${d?.response?.status?` status=${d.response.status}`:""})`)}const i=a.filter(b=>!(r?.status&&b.status!==r.status||r?.especialidade&&!b.especialidade.toLowerCase().includes(r.especialidade.toLowerCase()))),m=i.length;return a.length||(console.warn(`[MedicoService] Nenhum médico retornado. Tentados: ${t.join(" -> ")}`),o&&console.debug("[MedicoService] Último erro:",o)),{success:!0,data:{data:i,total:m,page:1,per_page:m},message:t.length?`Endpoints: ${t.join(" | ")}`:void 0}}catch(a){const t=a;return t?.response?.status===404?(console.warn("Endpoint /rest/v1/doctors não encontrado."),{success:!0,data:{data:[],total:0,page:1,per_page:0}}):t?.response?.status===401?(console.warn("Não autorizado. Verifique o token JWT."),{success:!1,error:"Não autorizado. Verifique o token JWT."}):(console.error("Erro ao listar médicos:",a),{success:!1,error:t?.response?.data?.message||"Erro ao listar médicos"})}}async criarMedico(r){const a={full_name:r.nome,email:r.email,crm:r.crm,crm_uf:r.crmUf,specialty:r.especialidade,phone_mobile:r.telefone,phone2:r.telefone2,cpf:r.cpf,cep:r.cep,street:r.rua,number:r.numero,complement:r.complemento,neighborhood:r.bairro,city:r.cidade,state:r.estado,birth_date:r.dataNascimento,rg:r.rg,active:(r.status||"ativo")==="ativo"};Object.keys(a).forEach(t=>{(a[t]===void 0||a[t]==="")&&delete a[t]});try{const t=await Q.post(Y.DOCTORS,a,{headers:{Prefer:"return=representation"}});if(!t.success||!t.data)return{success:!1,error:t.error||"Erro ao criar médico"};const o=t.data,n=Array.isArray(o)?o[0]:o,i=ja(n);return i.status||(i.status=r.status||"ativo"),{success:!0,data:i}}catch(t){return console.error("Falha ao criar médico na API remota.",t),{success:!1,error:"Erro ao criar médico"}}}async buscarMedicoPorId(r){try{try{const o=await Q.get(`${Y.DOCTORS}/${r}`);if(o.success&&o.data){const n=Array.isArray(o.data)?o.data[0]:o.data;if(n&&n.id)return{success:!0,data:ja(n)}}}catch{}const a=await Q.get(Y.DOCTORS,{params:{id:`eq.${r}`,select:"*"}});if(!a.success||!a.data)return{success:!1,error:a.error||"Médico não encontrado"};const t=Array.isArray(a.data)?a.data:[a.data];return!Array.isArray(t)||!t.length?{success:!1,error:"Médico não encontrado"}:{success:!0,data:ja(t[0])}}catch(a){return console.error("Erro ao buscar médico:",a),{success:!1,error:a instanceof Error&&"response"in a&&a.response?.data?.message||"Erro ao buscar médico"}}}async atualizarMedico(r,a){try{const t={};a.nome!==void 0&&(t.full_name=a.nome),a.email!==void 0&&(t.email=a.email),a.crm!==void 0&&(t.crm=a.crm),a.crmUf!==void 0&&(t.crm_uf=a.crmUf),a.cpf!==void 0&&(t.cpf=a.cpf),a.especialidade!==void 0&&(t.specialty=a.especialidade),a.telefone!==void 0&&(t.phone_mobile=a.telefone),a.telefone2!==void 0&&(t.phone2=a.telefone2),a.cep!==void 0&&(t.cep=a.cep),a.rua!==void 0&&(t.street=a.rua),a.numero!==void 0&&(t.number=a.numero),a.complemento!==void 0&&(t.complement=a.complemento),a.bairro!==void 0&&(t.neighborhood=a.bairro),a.cidade!==void 0&&(t.city=a.cidade),a.estado!==void 0&&(t.state=a.estado),a.dataNascimento!==void 0&&(t.birth_date=a.dataNascimento),a.rg!==void 0&&(t.rg=a.rg),a.status!==void 0&&(t.active=a.status==="ativo"),Object.keys(t).forEach(i=>{t[i]===void 0&&delete t[i]});const o=await Q.patch(`${Y.DOCTORS}?id=eq.${r}`,t,{headers:{Prefer:"return=representation"}});let n;return o.success&&o.data&&(n=(Array.isArray(o.data)?o.data:[o.data])[0]),n?{success:!0,data:ja(n)}:{success:!1,error:"Falha ao atualizar médico"}}catch(t){return console.error("Erro ao atualizar médico:",t),{success:!1,error:t instanceof Error&&"response"in t&&t.response?.data?.message||"Erro ao atualizar médico"}}}async deletarMedico(r){try{let a=!1;try{a=(await Q.delete(`${Y.DOCTORS}/${r}`)).success}catch{}return a||(a=(await Q.delete(Y.DOCTORS,{params:{id:`eq.${r}`}})).success),a?{success:!0}:{success:!1,error:"Falha ao deletar médico"}}catch(a){const t=a;let o="Erro ao deletar médico";const n=t.response?.status;return n===401?o="Não autorizado (token inválido ou expirado)":n===403?o="Acesso negado (sem permissão)":n===404?o="Médico não encontrado":t.response?.data?.message&&(o=t.response.data.message),console.error("Erro ao deletar médico:",a),{success:!1,error:o}}}async loginMedico(r,a){try{const t=await this.listarMedicos();if(!t.success||!t.data)return{success:!1,error:"Erro ao verificar dados do médico"};const o=t.data.data.find(n=>n.email===r);return o?o.status!=="ativo"?{success:!1,error:"Médico inativo"}:{success:!0,data:o}:{success:!1,error:"Email não encontrado"}}catch(t){return console.error("Erro no login do médico:",t),{success:!1,error:"Erro ao fazer login"}}}}const Ae=new Lt,ws=c.createContext(void 0),Ie="appSession",$t=({children:s})=>{const[r,a]=c.useState(null),[t,o]=c.useState(!0);c.useEffect(()=>{console.log("[AuthContext] 🔄 ESTADO MUDOU:",{user:r?{id:r.id,nome:r.nome,role:r.role}:null,loading:t,isAuthenticated:!!r,timestamp:new Date().toISOString()})},[r,t]),c.useEffect(()=>{if(!t&&!r){console.log("[AuthContext] 🔍 User é null mas loading false, verificando localStorage...");const k=localStorage.getItem(Ie);if(k)try{const N=JSON.parse(k);N?.user?.role&&(console.log("[AuthContext] 🔧 RECUPERANDO sessão perdida:",N.user.nome),a(N.user),N.token&&fe(()=>Promise.resolve().then(()=>Ke),void 0).then(x=>{x.default.setTokens(N.token,N.refreshToken)}))}catch(N){console.error("[AuthContext] Erro ao recuperar sessão:",N)}}},[r,t]),c.useEffect(()=>{const k=N=>{N.key===Ie&&console.log("[AuthContext] 📢 localStorage MUDOU externamente!",{oldValue:N.oldValue?"TINHA DADOS":"VAZIO",newValue:N.newValue?"TEM DADOS":"VAZIO",url:N.url})};return window.addEventListener("storage",k),()=>window.removeEventListener("storage",k)},[]),c.useEffect(()=>{console.log("[AuthContext] 🚀 INICIANDO RESTAURAÇÃO DE SESSÃO (mount)"),console.log("[AuthContext] 🔍 Verificando TODOS os itens no localStorage:");for(let N=0;N<localStorage.length;N++){const x=localStorage.key(N);if(x){const v=localStorage.getItem(x);console.log(`  - ${x}: ${v?.substring(0,50)}...`)}}(async()=>{try{let N=localStorage.getItem(Ie);if(console.log("[AuthContext] localStorage raw:",N?"EXISTE":"VAZIO"),N||(console.log("[AuthContext] 🔍 localStorage vazio, tentando sessionStorage..."),N=sessionStorage.getItem(Ie),console.log("[AuthContext] sessionStorage raw:",N?"EXISTE":"VAZIO"),N&&(console.log("[AuthContext] 🔄 Restaurando do sessionStorage para localStorage"),localStorage.setItem(Ie,N))),N&&console.log("[AuthContext] Conteúdo completo:",N.substring(0,100)+"..."),N){const x=JSON.parse(N);x?.user?.role?(console.log("[AuthContext] ✅ Restaurando sessão:",{nome:x.user.nome,role:x.user.role,hasToken:!!x.token}),x.token?(console.log("[AuthContext] Restaurando tokens no tokenStore"),(await fe(async()=>{const{default:$}=await Promise.resolve().then(()=>Ke);return{default:$}},void 0)).default.setTokens(x.token,x.refreshToken)):(console.warn("[AuthContext] Sessão encontrada mas sem token. Verificando tokenStore..."),(await fe(async()=>{const{default:Z}=await Promise.resolve().then(()=>Ke);return{default:Z}},void 0)).default.getAccessToken()?console.log("[AuthContext] Token encontrado no tokenStore, mantendo sessão"):console.warn("[AuthContext] ⚠️ Nenhum token encontrado. Sessão pode estar inválida.")),console.log("[AuthContext] 📝 Chamando setUser com:",x.user.nome),a(x.user)):console.log("[AuthContext] ⚠️ Sessão parseada mas sem user.role válido")}else console.log("[AuthContext] ℹ️ Nenhuma sessão salva encontrada no localStorage")}catch(N){console.error("[AuthContext] ❌ Erro ao restaurar sessão:",N)}finally{console.log("[AuthContext] 🏁 Finalizando restauração, setLoading(false)"),o(!1)}})()},[]);const n=c.useCallback(k=>{try{console.log("[AuthContext] 💾 SALVANDO sessão no localStorage E sessionStorage:",{user:k.user.nome,role:k.user.role,hasToken:!!k.token});const N=JSON.stringify(k);localStorage.setItem(Ie,N),sessionStorage.setItem(Ie,N),console.log("[AuthContext] ✅ Sessão salva com sucesso em ambos storages!")}catch(N){console.error("[AuthContext] ❌ ERRO ao salvar sessão:",N)}},[]),i=c.useCallback(()=>{try{console.log("[AuthContext] 🗑️ REMOVENDO sessão do localStorage E sessionStorage"),localStorage.removeItem(Ie),sessionStorage.removeItem(Ie),console.log("[AuthContext] ✅ Sessão removida com sucesso de ambos storages!")}catch(k){console.error("[AuthContext] ❌ ERRO ao remover sessão:",k)}},[]),m=k=>k&&{medico:"medico",doctor:"medico",secretaria:"secretaria",assistant:"secretaria",paciente:"paciente",patient:"paciente",user:"paciente",admin:"admin",gestor:"gestor",manager:"gestor"}[k.toLowerCase()]||void 0,b=k=>{const N=["admin","gestor","medico","secretaria","paciente"];for(const x of N)if(k.includes(x))return x;return k[0]||"paciente"},y=za.useCallback(k=>{console.log("[buildSessionUser] info recebido:",JSON.stringify(k,null,2));const N=(k.roles||[]).map(m).filter(Boolean);console.log("[buildSessionUser] roles normalizadas:",N);const x=k.permissions||{},v=b(N.length?N:[m((k.roles||[])[0])||"paciente"]);console.log("[buildSessionUser] primaryRole escolhida:",v);const $={id:k.user?.id||"",nome:k.profile?.full_name||k.user?.email?.split("@")[0]||"Usuário",email:k.user?.email,role:v,roles:N,permissions:x};return console.log("[buildSessionUser] SessionUser final:",$),v==="medico"?{...$,role:"medico"}:v==="secretaria"?{...$,role:"secretaria"}:v==="admin"?{...$,role:"admin"}:v==="gestor"?{...$,role:"gestor"}:{...$,role:"paciente"}},[]),d=c.useCallback(async(k,N)=>{if(k==="secretaria@clinica.com"&&N==="secretaria123"){const x={id:"sec-1",nome:"Secretária",email:k,role:"secretaria",roles:["secretaria"],permissions:{}};return a(x),n({user:x,savedAt:new Date().toISOString()}),h.success("Login realizado"),!0}return h.error("Credenciais inválidas"),!1},[n]),g=c.useCallback(async(k,N)=>{const x=await Ae.loginMedico(k,N);if(!x.success||!x.data)return h.error(x.error||"Erro ao autenticar médico"),!1;const v=x.data,$={id:v.id,nome:v.nome,email:v.email,role:"medico",crm:v.crm,especialidade:v.especialidade,roles:["medico"],permissions:{}};return a($),n({user:$,savedAt:new Date().toISOString()}),h.success(`Bem-vindo(a) Dr(a). ${v.nome}`),!0},[n]),p=c.useCallback(async(k,N)=>{console.log("[AuthContext] Iniciando login para:",k);const x=await Ee.login({email:k,password:N});if(console.log("[AuthContext] Resposta login:",x),!x.success||!x.data)return console.error("[AuthContext] Login falhou:",x.error),h.error(x.error||"Falha no login"),!1;console.log("[AuthContext] Token recebido, buscando user-info...");const v=await Ee.getUserInfo();if(console.log("[AuthContext] Resposta user-info:",v),!v.success||!v.data)return console.error("[AuthContext] Falha ao obter user-info:",v.error),h.error(v.error||"Falha ao obter user-info"),!1;const $=y(v.data);return console.log("[AuthContext] Usuário da sessão criado:",$),a($),n({user:$,savedAt:new Date().toISOString(),token:x.data.access_token,refreshToken:x.data.refresh_token}),console.log("[AuthContext] Login completo!"),h.success("Login realizado"),!0},[n,y]),E=c.useCallback(async k=>{console.log("[AuthContext] loginPaciente chamado com:",k);const N={id:k.id,nome:k.nome,email:k.email,role:"paciente",pacienteId:k.id,roles:["paciente"],permissions:{}};console.log("[AuthContext] Usuário criado:",N),a(N),n({user:N,savedAt:new Date().toISOString()});try{const x={_id:k.id,nome:k.nome,email:k.email??"",cpf:"",telefone:""};localStorage.setItem("pacienteLogado",JSON.stringify(x))}catch{}return console.log("[AuthContext] Usuário persistido no localStorage"),h.success(`Bem-vindo(a), ${k.nome}`),!0},[n]),j=c.useCallback(async()=>{console.log("[AuthContext] Iniciando logout...");try{const k=await Ee.logout();!k.success&&k.error?(console.warn("[AuthContext] Falha no logout remoto:",k.error),h.error(`Falha no logout remoto: ${k.error}`)):console.log("[AuthContext] Logout remoto bem-sucedido")}catch(k){console.warn("[AuthContext] Erro inesperado ao executar logout remoto",k)}finally{console.log("[AuthContext] Limpando estado local..."),a(null),i(),Ee.clearLocalAuth();try{localStorage.removeItem("pacienteLogado")}catch{}console.log("[AuthContext] Logout completo - usuário removido do estado")}},[i]),C=c.useCallback(async()=>{try{const k=localStorage.getItem(Ie);if(!k)return;const N=JSON.parse(k);if(!N?.user?.role)return;a(N.user)}catch{}},[]),S=c.useMemo(()=>({user:r,role:r?.role??null,roles:r?.roles||(r?.role?[r.role]:[]),permissions:r?.permissions||{},isAuthenticated:!!r,loading:t,loginSecretaria:d,loginMedico:g,loginComEmailSenha:p,loginPaciente:E,logout:j,refreshSession:C}),[r,t,d,g,p,E,j,C]);return e.jsx(ws.Provider,{value:S,children:s})};function ke(){const s=c.useContext(ws);if(!s)throw new Error("useAuth deve ser usado dentro de AuthProvider");return s}const Ot={common:{skipToContent:"Pular para o conteúdo",loading:"Carregando...",error:"Erro",retry:"Tentar novamente",cancel:"Cancelar",confirm:"Confirmar",close:"Fechar",save:"Salvar",edit:"Editar",delete:"Excluir",search:"Pesquisar",filter:"Filtrar",viewAll:"Ver todas",noData:"Nenhum dado disponível"},header:{logo:"MediConnect",subtitle:"Sistema de Agendamento",home:"Início",login:"Entrar",logout:"Sair",notAuthenticated:"Não autenticado",profile:"Perfil",selectProfile:"Selecione seu perfil"},profiles:{patient:"Paciente",doctor:"Médico",secretary:"Secretária",patientDescription:"Agendar e acompanhar consultas",doctorDescription:"Gerenciar consultas e pacientes",secretaryDescription:"Cadastros e agendamentos"},home:{hero:{title:"Sistema de Agendamento Médico",subtitle:"Conectando pacientes e profissionais de saúde com eficiência e segurança",ctaPrimary:"Agendar consulta",ctaSecondary:"Ver próximas consultas"},metrics:{totalPatients:"Total de Pacientes",totalPatientsDescription:"Número total de pacientes cadastrados no sistema",activeDoctors:"Médicos Ativos",activeDoctorsDescription:"Profissionais disponíveis para atendimento",todayAppointments:"Consultas Hoje",todayAppointmentsDescription:"Consultas agendadas para hoje",pendingAppointments:"Pendentes",pendingAppointmentsDescription:"Consultas agendadas ou confirmadas aguardando realização"},emptyStates:{noPatients:"Nenhum paciente cadastrado",noDoctors:"Nenhum médico cadastrado",noAppointments:"Nenhuma consulta agendada",registerPatient:"Cadastrar paciente",inviteDoctor:"Convidar médico",scheduleAppointment:"Agendar consulta"},actionCards:{scheduleAppointment:{title:"Agendar Consulta",description:"Agende consultas médicas de forma rápida e prática",cta:"Acessar Agendamento",ctaAriaLabel:"Ir para página de agendamento de consultas"},doctorPanel:{title:"Painel do Médico",description:"Gerencie consultas, horários e prontuários",cta:"Acessar Painel",ctaAriaLabel:"Ir para painel do médico"},patientManagement:{title:"Gestão de Pacientes",description:"Cadastre e gerencie informações de pacientes",cta:"Acessar Cadastro",ctaAriaLabel:"Ir para área de cadastro de pacientes"}},upcomingConsultations:{title:"Próximas Consultas",empty:"Nenhuma consulta agendada",viewAll:"Ver todas as consultas",date:"Data",time:"Horário",patient:"Paciente",doctor:"Médico",status:"Status",statusScheduled:"Agendada",statusConfirmed:"Confirmada",statusCompleted:"Realizada",statusCanceled:"Cancelada",statusMissed:"Faltou"},errorLoadingStats:"Erro ao carregar estatísticas"},accessibility:{reducedMotion:"Preferência por movimento reduzido detectada",highContrast:"Alto contraste",largeText:"Texto aumentado",darkMode:"Modo escuro"}},qt={common:{skipToContent:"Skip to content",loading:"Loading...",error:"Error",retry:"Try again",cancel:"Cancel",confirm:"Confirm",close:"Close",save:"Save",edit:"Edit",delete:"Delete",search:"Search",filter:"Filter",viewAll:"View all",noData:"No data available"},header:{logo:"MediConnect",subtitle:"Appointment System",home:"Home",login:"Login",logout:"Logout",notAuthenticated:"Not authenticated",profile:"Profile",selectProfile:"Select your profile"},profiles:{patient:"Patient",doctor:"Doctor",secretary:"Secretary",patientDescription:"Schedule and track appointments",doctorDescription:"Manage appointments and patients",secretaryDescription:"Registration and scheduling"},home:{hero:{title:"Medical Appointment System",subtitle:"Connecting patients and healthcare professionals efficiently and securely",ctaPrimary:"Schedule appointment",ctaSecondary:"View upcoming appointments"},metrics:{totalPatients:"Total Patients",totalPatientsDescription:"Total number of patients registered in the system",activeDoctors:"Active Doctors",activeDoctorsDescription:"Professionals available for care",todayAppointments:"Today's Appointments",todayAppointmentsDescription:"Appointments scheduled for today",pendingAppointments:"Pending",pendingAppointmentsDescription:"Scheduled or confirmed appointments awaiting completion"},emptyStates:{noPatients:"No patients registered",noDoctors:"No doctors registered",noAppointments:"No appointments scheduled",registerPatient:"Register patient",inviteDoctor:"Invite doctor",scheduleAppointment:"Schedule appointment"},actionCards:{scheduleAppointment:{title:"Schedule Appointment",description:"Book medical appointments quickly and easily",cta:"Go to Scheduling",ctaAriaLabel:"Go to appointment scheduling page"},doctorPanel:{title:"Doctor Panel",description:"Manage appointments, schedules and records",cta:"Access Panel",ctaAriaLabel:"Go to doctor panel"},patientManagement:{title:"Patient Management",description:"Register and manage patient information",cta:"Access Registration",ctaAriaLabel:"Go to patient registration area"}},upcomingConsultations:{title:"Upcoming Appointments",empty:"No appointments scheduled",viewAll:"View all appointments",date:"Date",time:"Time",patient:"Patient",doctor:"Doctor",status:"Status",statusScheduled:"Scheduled",statusConfirmed:"Confirmed",statusCompleted:"Completed",statusCanceled:"Canceled",statusMissed:"Missed"},errorLoadingStats:"Error loading statistics"},accessibility:{reducedMotion:"Reduced motion preference detected",highContrast:"High contrast",largeText:"Large text",darkMode:"Dark mode"}},or={"pt-BR":Ot,"en-US":qt};class Ft{currentLocale="pt-BR";constructor(){navigator.language.startsWith("en")&&(this.currentLocale="en-US");const a=localStorage.getItem("mediconnect_locale");a&&or[a]&&(this.currentLocale=a)}t(r){const a=r.split(".");let t=or[this.currentLocale];for(const o of a)if(typeof t=="object"&&t&&o in t)t=t[o];else return console.warn(`Translation key not found: ${r}`),r;return typeof t=="string"?t:r}setLocale(r){or[r]&&(this.currentLocale=r,localStorage.setItem("mediconnect_locale",r),document.documentElement.lang=r)}getLocale(){return this.currentLocale}formatDate(r){const a=typeof r=="string"?new Date(r):r;return new Intl.DateTimeFormat(this.currentLocale,{day:"2-digit",month:"2-digit",year:"numeric"}).format(a)}formatTime(r){const a=typeof r=="string"?new Date(r):r;return new Intl.DateTimeFormat(this.currentLocale,{hour:"2-digit",minute:"2-digit"}).format(a)}formatDateTime(r){const a=typeof r=="string"?new Date(r):r;return new Intl.DateTimeFormat(this.currentLocale,{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(a)}}const J=new Ft;class Ut{enabled;constructor(){this.enabled=!0,this.initDataLayer()}initDataLayer(){typeof window<"u"&&!window.dataLayer&&(window.dataLayer=[])}trackEvent(r,a,t,o){if(!this.enabled)return;const n={event:"custom_event",category:r,action:a,label:t,value:o,timestamp:new Date().toISOString()};typeof window<"u"&&window.dataLayer&&window.dataLayer.push(n)}trackCTA(r,a){this.trackEvent("CTA","click",`${r} -> ${a}`)}trackProfileChange(r,a){this.trackEvent("Profile","change",`${r||"none"} -> ${a}`)}trackNavigation(r,a){this.trackEvent("Navigation","page_view",`${r} -> ${a}`)}trackError(r,a){this.trackEvent("Error",r,a)}disable(){this.enabled=!1}enable(){this.enabled=!0}}const hr=new Ut,Yr=[{type:"patient",icon:ia,label:J.t("profiles.patient"),description:J.t("profiles.patientDescription"),path:"/paciente",color:"text-blue-600",bgColor:"bg-blue-50 hover:bg-blue-100"},{type:"doctor",icon:Ge,label:J.t("profiles.doctor"),description:J.t("profiles.doctorDescription"),path:"/login-medico",color:"text-indigo-600",bgColor:"bg-indigo-50 hover:bg-indigo-100"},{type:"secretary",icon:cs,label:J.t("profiles.secretary"),description:J.t("profiles.secretaryDescription"),path:"/login-secretaria",color:"text-green-600",bgColor:"bg-green-50 hover:bg-green-100"}],Kr=()=>{const[s,r]=c.useState(null),[a,t]=c.useState(!1),o=je(),n=c.useRef(null),{isAuthenticated:i,user:m}=ke();c.useEffect(()=>{const g=localStorage.getItem("mediconnect_selected_profile");g&&r(g)},[]),c.useEffect(()=>{const g=p=>{n.current&&!n.current.contains(p.target)&&t(!1)};return a&&document.addEventListener("mousedown",g),()=>{document.removeEventListener("mousedown",g)}},[a]);const b=g=>{const p=s;r(g.type),t(!1),g.type&&localStorage.setItem("mediconnect_selected_profile",g.type),hr.trackProfileChange(p,g.type||"none");let E=g.path;if(i&&m){switch(m.role){case"paciente":g.type==="patient"&&(E="/acompanhamento");break;case"medico":g.type==="doctor"&&(E="/painel-medico");break;case"secretaria":g.type==="secretary"&&(E="/painel-secretaria");break;case"admin":g.type==="secretary"?E="/painel-secretaria":g.type==="doctor"?E="/painel-medico":g.type==="patient"&&(E="/acompanhamento");break}console.log(`🔀 ProfileSelector: Usuário autenticado (${m.role}), redirecionando para ${E}`)}else console.log(`🔀 ProfileSelector: Usuário NÃO autenticado, redirecionando para ${E}`);o(E)},d=Yr.find(g=>g.type===s);return e.jsxs("div",{className:"relative",ref:n,children:[e.jsxs("button",{onClick:()=>t(!a),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ${d?`${d.bgColor} ${d.color}`:"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,"aria-expanded":a,"aria-haspopup":"true","aria-label":J.t("header.selectProfile"),children:[d?e.jsxs(e.Fragment,{children:[e.jsx(d.icon,{className:"w-4 h-4","aria-hidden":"true"}),e.jsx("span",{className:"hidden md:inline",children:d.label})]}):e.jsxs(e.Fragment,{children:[e.jsx(ia,{className:"w-4 h-4","aria-hidden":"true"}),e.jsx("span",{className:"hidden md:inline",children:J.t("header.profile")})]}),e.jsx(br,{className:`w-4 h-4 transition-transform ${a?"rotate-180":""}`,"aria-hidden":"true"})]}),a&&e.jsx("div",{className:"absolute right-0 mt-2 w-72 bg-white rounded-lg shadow-xl border border-gray-200 z-50 animate-in fade-in slide-in-from-top-2 duration-200",role:"menu","aria-orientation":"vertical",children:e.jsxs("div",{className:"p-2",children:[e.jsx("p",{className:"px-3 py-2 text-xs font-semibold text-gray-500 uppercase tracking-wide",children:J.t("header.selectProfile")}),Yr.map(g=>e.jsxs("button",{onClick:()=>b(g),className:`w-full flex items-start gap-3 px-3 py-3 rounded-lg transition-colors text-left focus:outline-none focus:ring-2 focus:ring-blue-500 ${g.type===s?`${g.bgColor} ${g.color}`:"hover:bg-gray-50 text-gray-700"}`,role:"menuitem","aria-label":`Selecionar perfil ${g.label}`,children:[e.jsx("div",{className:`p-2 rounded-lg ${g.type===s?"bg-white":g.bgColor}`,children:e.jsx(g.icon,{className:`w-5 h-5 ${g.color}`,"aria-hidden":"true"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm",children:g.label}),e.jsx("p",{className:"text-xs text-gray-600 mt-0.5",children:g.description})]}),g.type===s&&e.jsx("div",{className:"flex-shrink-0 pt-1",children:e.jsx("svg",{className:`w-5 h-5 ${g.color}`,fill:"currentColor",viewBox:"0 0 20 20","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]},g.type))]})})]})},zt="/assets/logo-Cml-GZFh.PNG",Bt=()=>{const{user:s,logout:r,role:a,isAuthenticated:t}=ke(),o={secretaria:"Secretaria",medico:"Médico",paciente:"Paciente",admin:"Administrador",gestor:"Gestor"};return e.jsxs("header",{className:"bg-white shadow-lg border-b border-gray-200",children:[e.jsx("a",{href:"#main-content",className:"sr-only focus:not-sr-only focus:absolute focus:top-0 focus:left-0 focus:z-50 focus:px-4 focus:py-2 focus:bg-blue-600 focus:text-white focus:outline-none",children:J.t("common.skipToContent")}),e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs("div",{className:"flex items-center justify-between h-16",children:[e.jsxs(oa,{to:"/",className:"flex items-center space-x-3 focus:outline-none focus:ring-2 focus:ring-blue-500 rounded-lg",children:[e.jsx("img",{src:zt,alt:J.t("header.logo"),className:"h-14 w-14 rounded-lg object-contain shadow-sm"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:J.t("header.logo")}),e.jsx("p",{className:"text-xs text-gray-500",children:J.t("header.subtitle")})]})]}),e.jsxs("nav",{className:"hidden md:flex items-center space-x-2","aria-label":"Navegação principal",children:[e.jsxs(oa,{to:"/",className:"flex items-center space-x-2 px-4 py-2 rounded-lg text-sm font-medium transition-colors text-gray-600 hover:text-blue-600 hover:bg-blue-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:[e.jsx(Fr,{className:"w-4 h-4","aria-hidden":"true"}),e.jsx("span",{children:J.t("header.home")})]}),e.jsx(Kr,{}),t&&(a==="admin"||a==="gestor")&&e.jsx(oa,{to:"/admin",className:"flex items-center space-x-2 px-4 py-2 rounded-lg text-sm font-medium transition-colors text-gray-600 hover:text-purple-600 hover:bg-purple-50 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2",children:e.jsx("span",{children:"Painel Admin"})})]}),e.jsx("div",{className:"hidden md:flex items-center space-x-3",children:t&&s?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-right leading-tight min-w-0 flex-shrink",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 truncate max-w-[120px]",title:s.nome,children:s.nome.split(" ").slice(0,2).join(" ")}),e.jsx("p",{className:"text-xs text-gray-500 whitespace-nowrap",children:a?o[a]||a:""})]}),e.jsxs("button",{onClick:r,className:"inline-flex items-center px-3 py-2 text-sm font-medium rounded-md bg-gray-100 hover:bg-gray-200 hover:scale-105 active:scale-95 text-gray-700 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 flex-shrink-0","aria-label":J.t("header.logout"),children:[e.jsx(Ca,{className:"w-4 h-4 mr-1","aria-hidden":"true"}),e.jsx("span",{className:"hidden lg:inline",children:J.t("header.logout")}),e.jsx("span",{className:"lg:hidden",children:"Sair"})]})]}):e.jsxs(oa,{to:"/paciente",className:"inline-flex items-center px-4 py-2 text-sm font-medium rounded-md bg-gradient-to-r from-blue-700 to-blue-400 hover:from-blue-800 hover:to-blue-500 hover:scale-105 active:scale-95 text-white transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 shadow-sm hover:shadow-md","aria-label":J.t("header.login"),children:[e.jsx(Ur,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),J.t("header.login")]})}),e.jsx("div",{className:"md:hidden",children:e.jsx("button",{className:"text-gray-600 hover:text-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 rounded p-2","aria-label":"Menu de navegação",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})})]}),e.jsx("div",{className:"md:hidden border-t border-gray-200 py-3",children:e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsxs(oa,{to:"/",className:"flex items-center space-x-2 px-3 py-2 rounded-lg text-sm font-medium transition-colors text-gray-600 hover:text-blue-600 hover:bg-blue-50 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx(Fr,{className:"w-4 h-4","aria-hidden":"true"}),e.jsx("span",{children:J.t("header.home")})]}),e.jsx("div",{className:"px-3 py-2",children:e.jsx(Kr,{})}),e.jsx("div",{className:"mt-4 flex items-center justify-between bg-gray-50 px-3 py-2 rounded-md",children:t&&s?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex-1 mr-3 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 truncate",title:s.nome,children:s.nome.split(" ").slice(0,2).join(" ")}),e.jsx("p",{className:"text-xs text-gray-500",children:a?o[a]||a:""})]}),e.jsxs("button",{onClick:r,className:"inline-flex items-center px-3 py-2 text-xs font-medium rounded bg-gray-200 text-gray-700 hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 flex-shrink-0","aria-label":J.t("header.logout"),children:[e.jsx(Ca,{className:"w-4 h-4 mr-1"}),e.jsx("span",{children:"Sair"})]})]}):e.jsxs(oa,{to:"/paciente",className:"flex-1 inline-flex items-center justify-center px-3 py-2 text-sm font-medium rounded bg-gradient-to-r from-blue-700 to-blue-400 text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx(Ur,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),J.t("header.login")]})})]})})]})]})},ks="accessibility-prefs",Fa={fontSize:100,highContrast:!1,darkMode:!1,textToSpeech:!1,dyslexicFont:!1,lineSpacing:!1,reducedMotion:!1,lowBlueLight:!1,focusMode:!1};function Ht(){try{const s=localStorage.getItem(ks);if(!s)return Fa;const r=JSON.parse(s);return{...Fa,...r}}catch{return Fa}}function Vt(){const[s,r]=c.useState(()=>Ht()),a=c.useRef(!1);c.useEffect(()=>{a.current||(a.current=!0);try{localStorage.setItem(ks,JSON.stringify(s))}catch{}},[s]),c.useEffect(()=>{const n=document.documentElement;n.style.fontSize=`${s.fontSize}%`;const i=(m,b)=>{m?n.classList.add(b):n.classList.remove(b)};i(s.highContrast,"high-contrast"),i(s.darkMode,"dark"),i(s.dyslexicFont,"dyslexic-font"),i(s.lineSpacing,"line-spacing"),i(s.reducedMotion,"reduced-motion"),i(s.lowBlueLight,"low-blue-light"),i(s.focusMode,"focus-mode")},[s]);const t=c.useCallback(n=>{r(i=>({...i,...n}))},[]),o=c.useCallback(()=>r(Fa),[]);return{prefs:s,update:t,reset:o}}const Xr="a11y-menu-title",Qr="a11y-menu-desc",Jt=()=>{typeof window<"u"&&console.log("[AccessibilityMenu] render");const[s,r]=c.useState(!1),{prefs:a,update:t,reset:o}=Vt(),[n,i]=c.useState(!1),m=c.useRef(null),b=c.useRef(null),y=c.useRef(null);c.useEffect(()=>{i(a.textToSpeech)},[a.textToSpeech]),c.useEffect(()=>{if(typeof window>"u"||typeof window.speechSynthesis>"u"||import.meta.vitest||!n)return;const S=k=>{const N=k.target;if(!N)return;const x=N.innerText?.trim();if(x&&x.length<=180&&window.speechSynthesis){window.speechSynthesis.cancel();const v=new SpeechSynthesisUtterance(x);v.lang="pt-BR",v.rate=.95,window.speechSynthesis.speak(v)}};return document.addEventListener("mouseover",S),()=>document.removeEventListener("mouseover",S)},[n]),c.useEffect(()=>{const S=k=>{k.altKey&&(k.key==="a"||k.key==="A")&&(k.preventDefault(),r(N=>!N)),k.key==="Escape"&&s&&r(!1)};return document.addEventListener("keydown",S),()=>document.removeEventListener("keydown",S)},[s]),c.useEffect(()=>{s?(m.current=document.querySelector('button[aria-label="Menu de Acessibilidade"]'),setTimeout(()=>b.current?.focus(),10)):m.current?.focus?.()},[s]);const d=c.useCallback(S=>{if(s&&S.key==="Tab"&&y.current){const k=y.current.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),N=Array.from(k).filter(Z=>!Z.hasAttribute("disabled"));if(!N.length)return;const x=N[0],v=N[N.length-1],$=document.activeElement;S.shiftKey?$===x&&(S.preventDefault(),v.focus()):$===v&&(S.preventDefault(),x.focus())}},[s]),g=()=>t({fontSize:Math.min(160,a.fontSize+10)}),p=()=>t({fontSize:Math.max(80,a.fontSize-10)}),E=S=>t({[S]:!a[S]}),j=()=>{window.speechSynthesis&&window.speechSynthesis.cancel(),o()},C=S=>e.jsx("h4",{className:"text-xs font-semibold uppercase tracking-wide text-blue-600 dark:text-blue-300",children:S});return e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>r(S=>!S),className:"fixed bottom-6 right-6 z-50 bg-blue-600 text-white p-4 rounded-full shadow-lg hover:bg-blue-700 transition-all duration-300 hover:scale-110 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-blue-500","aria-label":"Menu de Acessibilidade",title:"Abrir menu de acessibilidade","data-testid":"a11y-menu-trigger",children:e.jsx(zr,{className:"w-6 h-6"})}),s&&e.jsxs("div",{ref:y,role:"dialog","aria-modal":"true","aria-labelledby":Xr,"aria-describedby":Qr,className:"fixed bottom-24 right-6 z-50 bg-white dark:bg-slate-800 rounded-lg shadow-2xl w-80 border-2 border-blue-600 transition-all duration-300 animate-slideIn focus:outline-none max-h-[calc(100vh-7rem)]",onKeyDown:d,children:[e.jsxs("div",{className:"flex items-center justify-between p-6 pb-4 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(zr,{className:"w-5 h-5 text-blue-600"}),e.jsx("h3",{id:Xr,className:"font-bold text-lg text-gray-900 dark:text-white",children:"Acessibilidade"})]}),e.jsx("button",{onClick:()=>r(!1),className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-blue-500","aria-label":"Fechar menu",children:e.jsx(Fe,{className:"w-5 h-5"})})]}),e.jsx("p",{id:Qr,className:"sr-only",children:"Ajustes visuais e funcionais para leitura, contraste e foco."}),e.jsxs("div",{className:"space-y-5 overflow-y-auto p-6 pt-4",style:{maxHeight:"calc(100vh - 15rem)",scrollbarWidth:"thin",scrollbarColor:"#3b82f6 #e5e7eb"},children:[e.jsxs("div",{ref:b,tabIndex:-1,children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Tamanho da Fonte: ",a.fontSize,"%"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:p,className:"p-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-200 rounded hover:bg-gray-300 dark:hover:bg-gray-600 disabled:opacity-50",disabled:a.fontSize<=80,"aria-label":"Diminuir fonte",children:e.jsx(rt,{className:"w-4 h-4"})}),e.jsx("div",{className:"flex-1 bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 dark:bg-blue-500 h-2 rounded-full transition-all",style:{width:`${(a.fontSize-80)/80*100}%`}})}),e.jsx("button",{onClick:g,className:"p-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-200 rounded hover:bg-gray-300 dark:hover:bg-gray-600 disabled:opacity-50",disabled:a.fontSize>=160,"aria-label":"Aumentar fonte",children:e.jsx(Se,{className:"w-4 h-4"})})]})]}),C("Temas"),e.jsx(Je,{label:"Modo Escuro",active:a.darkMode,onClick:()=>E("darkMode"),icon:a.darkMode?e.jsx(st,{className:"w-4 h-4 text-blue-400"}):e.jsx(tt,{className:"w-4 h-4 text-yellow-500"}),description:a.darkMode?"Tema escuro ativo":"Tema claro ativo"}),e.jsx(Je,{label:"Alto Contraste",active:a.highContrast,onClick:()=>E("highContrast"),description:a.highContrast?"Contraste máximo":"Contraste padrão"}),e.jsx(Je,{label:"Filtro Amarelo (Luz Azul)",active:a.lowBlueLight,onClick:()=>E("lowBlueLight"),description:"Reduz luz azul para conforto visual"}),C("Leitura & Foco"),e.jsx(Je,{label:"Fonte Disléxica",active:a.dyslexicFont,onClick:()=>E("dyslexicFont"),description:"Fonte alternativa para facilitar leitura"}),e.jsx(Je,{label:"Espaçamento de Linha",active:a.lineSpacing,onClick:()=>E("lineSpacing"),description:"Aumenta o espaçamento entre linhas"}),e.jsx(Je,{label:"Modo Foco",active:a.focusMode,onClick:()=>E("focusMode"),description:"Atenua elementos não focados"}),e.jsx(Je,{label:"Reduzir Movimento",active:a.reducedMotion,onClick:()=>E("reducedMotion"),description:"Remove animações não essenciais"}),e.jsx(Je,{label:"Leitura de Texto",active:a.textToSpeech,onClick:()=>E("textToSpeech"),icon:e.jsx(ot,{className:"w-4 h-4"}),description:"Ler conteúdo ao passar mouse (beta)"}),e.jsx("button",{onClick:j,className:"w-full mt-2 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors font-medium",children:"Resetar Configurações"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 text-center pt-2",children:"Atalho: Alt + A | ESC fecha"})]})]})]})},Je=({label:s,active:r,onClick:a,description:t,icon:o})=>e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 flex items-center gap-2",children:[o,s]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:a,className:"a11y-toggle-button relative inline-flex h-7 w-14 items-center rounded-full focus:outline-none a11y-toggle-track "+(r?" ring-offset-0":" opacity-90 hover:opacity-100"),"data-active":r,"aria-pressed":r,"aria-label":s,type:"button",children:e.jsx("span",{className:"a11y-toggle-thumb inline-block h-5 w-5 transform rounded-full bg-white shadow transition-transform "+(r?"translate-x-8":"translate-x-1")})}),e.jsx("span",{className:"a11y-toggle-status-label select-none text-xs font-medium text-gray-600 dark:text-gray-400 min-w-[2rem] text-center",children:r?"ON":"OFF"})]})]}),t&&e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:t})]}),La=({roles:s,redirectTo:r="/"})=>{const{isAuthenticated:a,role:t,loading:o,user:n}=ke(),i=Ks();console.log("[ProtectedRoute] VERIFICAÇÃO COMPLETA",{path:i.pathname,isAuthenticated:a,role:t,loading:o,requiredRoles:s,user:n?{id:n.id,nome:n.nome,email:n.email}:null,timestamp:new Date().toISOString()});try{const m=localStorage.getItem("appSession");console.log("[ProtectedRoute] localStorage appSession:",m?JSON.parse(m):null)}catch(m){console.error("[ProtectedRoute] Erro ao ler localStorage:",m)}if(o)return console.log("[ProtectedRoute] ⏳ Ainda carregando sessão..."),e.jsx("div",{className:"py-10 text-center text-sm text-gray-500",children:"Verificando sessão..."});if(!a)return console.log("[ProtectedRoute] ❌ NÃO AUTENTICADO! User:",n,"Redirecionando para:",r),e.jsx(cr,{to:r,state:{from:i},replace:!0});if(console.log("[ProtectedRoute] ✅ Autenticado! Verificando roles..."),t==="admin")return console.log("[ProtectedRoute] Admin detectado, permitindo acesso"),e.jsx(qr,{});if(s&&s.length>0){const m=t==="user"?"paciente":t,b=s.map(y=>y==="user"?"paciente":y);if(!m||!b.includes(m))return console.log("[ProtectedRoute] Role não permitida, redirecionando para:",r),e.jsx(cr,{to:r,replace:!0})}return console.log("[ProtectedRoute] Acesso permitido"),e.jsx(qr,{})},Gt=new Set(["true","1","yes","sim","vip","ativo"]),ea=s=>{if(typeof s=="boolean")return s;if(typeof s=="number")return s===1;if(typeof s=="string"){const r=s.trim().toLowerCase();return Gt.has(r)}return!1},Yt=s=>{if(ea(s.vip)||ea(s.is_vip)||ea(s.vip_status)||ea(s.categoria)||ea(s.category))return!0;const r=s.tags;return Array.isArray(r)?r.some(a=>typeof a=="string"?ea(a):a&&typeof a=="object"&&"name"in a?ea(a.name):!1):!1};function Za(s){return{id:s.id||"",nome:s.full_name||s.nome||"",socialName:s.social_name??void 0,email:s.email,telefone:s.phone_mobile||s.phone,dataNascimento:s.birth_date||s.data_nascimento,sexo:s.sex??void 0,tipoSanguineo:s.blood_type??void 0,pesoKg:s.weight_kg??s.peso??void 0,alturaM:s.height_m??s.altura??void 0,imc:s.bmi??void 0,endereco:{rua:s.street??void 0,numero:s.number??void 0,complemento:s.complement??void 0,bairro:s.neighborhood??void 0,cidade:s.city??void 0,estado:s.state??void 0,cep:s.cep??void 0},cpf:s.cpf,created_at:s.created_at,updated_at:s.updated_at,created_by:s.created_by,convenio:s.convenio,numeroCarteirinha:s.numeroCarteirinha||s.numero_carteirinha,observacoes:s.observacoes||null,vip:Yt(s),avatar_url:s.avatar_url}}async function Xe(s){const r=s?.page??1;try{const a=[];let t=[];if(s?.userId)try{const{listAssignments:i}=await fe(async()=>{const{listAssignments:b}=await import("./patientAssignmentService-B6ys9UHG.js");return{listAssignments:b}},__vite__mapDeps([0,1,2,3,4,5,6,7])),m=await i({userId:s.userId,role:"medico"});if(m.success&&m.data){const b=m.data.map(y=>y.patientId).filter(y=>!!y);if(console.log(`[PacienteService] Encontradas ${b.length} atribuições para médico ${s.userId}`),b.length>0){const y=b.map(async g=>{try{const p=await Q.get(`${Y.PATIENTS}?id=eq.${g}`,{params:{select:"*"}});if(p.success&&p.data){const E=p.data;return(Array.isArray(E)?E:E.data||[])[0]}}catch(p){console.error(`Erro ao buscar paciente ${g}:`,p)}return null});t=(await Promise.all(y)).filter(g=>g!==null),console.log(`[PacienteService] ${t.length} pacientes carregados com sucesso`)}else return console.warn(`[PacienteService] Médico ${s.userId} não tem pacientes atribuídos`),{data:[],total:0,page:1,per_page:0}}}catch(i){console.error("Erro ao buscar pacientes por atribuição:",i)}if(t.length===0){const i=[Y.PATIENTS];for(const m of i)try{const b=await Q.get(m,{params:{select:"*"}});if(a.push(m),b.success&&b.data){const y=b.data;if(t=Array.isArray(y)?y:y.data||[],t.length)break}}catch(b){const y=b;a.push(`${m} (erro${y?.response?.status?` status=${y.response.status}`:""})`)}}let o=t.map(Za);if(s?.search){const i=s.search.toLowerCase();o=o.filter(m=>m.nome.toLowerCase().includes(i)||m.cpf?.includes(i)||m.email?.toLowerCase().includes(i))}const n=o.length;return!n&&!s?.userId&&console.warn(`[PacienteService] Nenhum paciente retornado. Tentados: ${a.join(" -> ")}`),{data:o,total:n,page:r,per_page:n}}catch(a){return console.error("Falha ao obter pacientes remotamente.",a),{data:[],total:0,page:1,per_page:0}}}async function Wa(s){if(!s)return{success:!1,error:"ID é obrigatório"};try{let r;try{const a=await Q.get(`${Y.PATIENTS}/${encodeURIComponent(s)}`);a.success&&a.data&&(r=Array.isArray(a.data)?a.data[0]:a.data)}catch{}if(!r){const a=await Q.get(Y.PATIENTS,{params:{id:`eq.${s}`,select:"*"}});a.success&&a.data&&(Array.isArray(a.data)?r=a.data[0]:r=a.data)}return r?{success:!0,data:Za(r)}:{success:!1,error:"Paciente não encontrado"}}catch(r){const a=r;let t="Erro ao buscar paciente";return a.response?.status===404?t="Paciente não encontrado":a.response?.status===401?t="Não autorizado":a.response?.data?.message&&(t=a.response.data.message),console.error(t,r),{success:!1,error:t}}}async function Da(s){const r=(s.cpf||"").replace(/\D/g,"").slice(0,11);let a=(s.telefone||"").replace(/\D/g,"");a.length>15&&(a=a.slice(0,15));const t=s.endereco?{...s.endereco,cep:s.endereco.cep?.replace(/\D/g,"")}:void 0,o=typeof s.pesoKg=="number"&&s.pesoKg>0&&s.pesoKg<500?s.pesoKg:void 0,n=typeof s.alturaM=="number"&&s.alturaM>0&&s.alturaM<3?s.alturaM:void 0;if(!s.nome?.trim())return{success:!1,error:"Nome é obrigatório"};if(!r)return{success:!1,error:"CPF é obrigatório"};if(!s.email?.trim())return{success:!1,error:"Email é obrigatório"};if(!a)return{success:!1,error:"Telefone é obrigatório"};const i=g=>({full_name:s.nome,cpf:g,email:s.email,phone_mobile:a,birth_date:s.dataNascimento,social_name:s.socialName,sex:s.sexo,blood_type:s.tipoSanguineo,weight_kg:o,height_m:n,street:t?.rua,number:t?.numero,complement:t?.complemento,neighborhood:t?.bairro,city:t?.cidade,state:t?.estado,cep:t?.cep});let m=i(r);const b=()=>{Object.keys(m).forEach(g=>{const p=m[g];(p===void 0||p==="")&&delete m[g]})};b();const y=async()=>{const g=await Q.post(Y.PATIENTS,m,{headers:{Prefer:"return=representation"}});if(g.success&&g.data){const p=Array.isArray(g.data)?g.data[0]:g.data;return{success:!0,data:Za(p)}}return{success:!1,error:g.error||"Erro ao criar paciente"}},d=async g=>{if(/numeric field overflow/i.test(g)&&r.length===11){m=i(r.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/,"$1.$2.$3-$4")),b();let p=await y();if(p.success)return p;const E=["weight_kg","height_m","blood_type","cep","number"];for(const j of E)if(j in m&&(delete m[j],p=await y(),p.success))return p;return p}return{success:!1,error:g}};try{let g=await y();return!g.success&&/numeric field overflow/i.test(g.error||"")&&(g=await d(g.error||"numeric field overflow")),g}catch(g){const p=g;let E="Erro ao criar paciente";return p.response?.status===401?E="Não autorizado":p.response?.status===400?E=p.response.data?.message||"Dados inválidos":p.response?.data?.message&&(E=p.response.data.message),/numeric field overflow/i.test(E)?await d(E):{success:!1,error:E}}}async function Ma(s,r){if(!s)return{success:!1,error:"ID é obrigatório"};const a=(r.cpf||"").replace(/\D/g,""),t=(r.telefone||"").replace(/\D/g,""),o=r.endereco?{...r.endereco,cep:r.endereco.cep?.replace(/\D/g,"")}:void 0,n={full_name:r.nome,cpf:a,email:r.email,phone_mobile:t,birth_date:r.dataNascimento,social_name:r.socialName,sex:r.sexo,blood_type:r.tipoSanguineo,weight_kg:r.pesoKg,height_m:r.alturaM,street:o?.rua,number:o?.numero,complement:o?.complemento,neighborhood:o?.bairro,city:o?.cidade,state:o?.estado,cep:o?.cep};Object.keys(n).forEach(i=>{const m=n[i];(m===void 0||m==="")&&delete n[i]});try{const i=await Q.patch(`${Y.PATIENTS}?id=eq.${s}`,n,{headers:{Prefer:"return=representation"}});if(!i.success||!i.data)return{success:!1,error:i.error||"Paciente não retornado"};const m=Array.isArray(i.data)?i.data[0]:i.data;return m?{success:!0,data:Za(m)}:{success:!1,error:"Paciente não retornado"}}catch(i){const m=i;let b="Erro ao atualizar paciente";return m.response?.status===404?b="Paciente não encontrado":m.response?.status===401?b="Não autorizado":m.response?.data?.message&&(b=m.response.data.message),console.error(b,i),{success:!1,error:b}}}async function Ta(s){if(!s)return{success:!1,error:"ID é obrigatório"};try{console.log("[deletePatient] Tentando deletar paciente:",s),console.log("[deletePatient] Endpoint:",`${Y.PATIENTS}?id=eq.${encodeURIComponent(s)}`);const r=await Q.delete(`${Y.PATIENTS}?id=eq.${encodeURIComponent(s)}`,{headers:{Prefer:"return=minimal"}});return console.log("[deletePatient] Resposta:",r),r.success?(console.log("[deletePatient] Paciente deletado com sucesso"),{success:!0}):(console.error("[deletePatient] Falha ao deletar:",r.error),{success:!1,error:r.error||"Falha ao deletar paciente"})}catch(r){const a=r;let t="Erro ao deletar paciente";const o=a.response?.status,n=a.response?.data;return console.error("[deletePatient] Erro capturado:",{status:o,message:n?.message,hint:n?.hint,details:n?.details,error:n?.error,fullError:r}),o===404?t="Paciente não encontrado":o===401?t="Não autorizado - faça login novamente":o===403?t="Acesso negado - você não tem permissão para excluir pacientes":o===406?t="Formato de requisição inválido":n?.error?t=n.error:n?.message?t=n.message:n?.hint&&(t=`${t}: ${n.hint}`),console.error("[deletePatient]",t,r),{success:!1,error:t}}}async function Cs(s,r){const a=new FormData;a.append("foto",r);const t=await Q.post(`/auth/v1/pacientes/${encodeURIComponent(s)}/foto`,a,{headers:{"Content-Type":"multipart/form-data"}});if(t.success&&t.data){const o=t.data,n=o.data,i=n||o;return{foto_url:i.foto_url,thumbnail_url:i.thumbnail_url}}throw new Error(t.error||"Falha no upload de foto")}async function Ss(s){const r=await Q.delete(`/auth/v1/pacientes/${encodeURIComponent(s)}/foto`);if(!r.success)throw new Error(r.error||"Falha ao remover foto")}async function Nr(s){const r=await Q.get(`/auth/v1/pacientes/${encodeURIComponent(s)}/anexos`);if(!r.success)return[];const t=Array.isArray(r.data)?r.data:r.data?.data||r.data?.list||[];return Array.isArray(t)?t:[]}async function wr(s,r){const a=new FormData;a.append("arquivo",r);const t=await Q.post(`/auth/v1/pacientes/${encodeURIComponent(s)}/anexos`,a,{headers:{"Content-Type":"multipart/form-data"}});if(!t.success)throw new Error(t.error||"Falha ao adicionar anexo");if(!t.data)throw new Error("Resposta inválida do servidor");return t.data.data||t.data}async function kr(s,r){const a=await Q.delete(`/pacientes/${encodeURIComponent(s)}/anexos/${encodeURIComponent(r)}`);if(!a.success)throw new Error(a.error||"Falha ao remover anexo")}async function Es(s){const r=await Q.post("/pacientes/validar-cpf",{cpf:s});if(!r.success||!r.data)return{valido:!1,existe:!1,paciente_id:null};const a=r.data.data||r.data;return{valido:!!a.valido,existe:!!a.existe,paciente_id:a.paciente_id??null}}async function _a(s){const r=(s||"").replace(/\D/g,"");if(r.length!==8)return null;const a=await fetch(`https://viacep.com.br/ws/${r}/json/`);if(!a.ok)return null;const t=await a.json();return t.erro?null:{cep:t.cep,rua:t.logradouro,bairro:t.bairro,cidade:t.localidade,estado:t.uf}}const Cr={listPatients:Xe,getPatientById:Wa,createPatient:Da,updatePatient:Ma,deletePatient:Ta,uploadPatientPhoto:Cs,removePatientPhoto:Ss,listPatientAttachments:Nr,addPatientAttachment:wr,removePatientAttachment:kr,validateCPF:Es,buscarEnderecoViaCEP:_a},Ya=Object.freeze(Object.defineProperty({__proto__:null,addPatientAttachment:wr,buscarEnderecoViaCEP:_a,createPatient:Da,default:Cr,deletePatient:Ta,getPatientById:Wa,listPatientAttachments:Nr,listPatients:Xe,removePatientAttachment:kr,removePatientPhoto:Ss,updatePatient:Ma,uploadPatientPhoto:Cs,validateCPF:Es},Symbol.toStringTag,{value:"Module"}));class Kt{async enviarSMS(r){try{return{success:!0,data:(await ne.post(Y.SMS,r)).data}}catch(a){return console.error("Erro ao enviar SMS:",a),{success:!1,error:a instanceof Error&&"response"in a&&a.response?.data?.message||"Erro ao enviar SMS"}}}async enviarLembreteConsulta(r,a,t,o){const n=`Lembrete: Você tem uma consulta agendada com Dr(a). ${t} em ${o}. Paciente: ${a}. Para reagendar, entre em contato.`;return this.enviarSMS({telefone:r,mensagem:n,tipo:"lembrete"})}async enviarConfirmacaoConsulta(r,a,t,o){const n=`Consulta confirmada! Dr(a). ${t} - ${o}. Paciente: ${a}. Chegue 15min antes.`;return this.enviarSMS({telefone:r,mensagem:n,tipo:"confirmacao"})}async enviarCancelamentoConsulta(r,a,t,o,n){const i=n?` Motivo: ${n}`:"",m=`Consulta cancelada: Dr(a). ${t} - ${o}. Paciente: ${a}.${i} Entre em contato para reagendar.`;return this.enviarSMS({telefone:r,mensagem:m,tipo:"cancelamento"})}}const nr=new Kt;class Xt{async listarConsultas(r){try{return{success:!0,data:(await ne.get("/rest/v1/consultations",{params:r})).data}}catch(a){return console.error("Erro ao listar consultas:",a),{success:!1,error:a instanceof Error&&"response"in a&&a.response?.data?.message||"Erro ao listar consultas"}}}async criarConsulta(r){try{return{success:!0,data:(await ne.post("/rest/v1/consultations",{...r,status:"agendada"})).data}}catch(a){return console.error("Erro ao criar consulta:",a),{success:!1,error:a instanceof Error&&"response"in a&&a.response?.data?.message||"Erro ao criar consulta"}}}async buscarConsultaPorId(r){try{return{success:!0,data:(await ne.get(`/rest/v1/consultations/${r}`)).data}}catch(a){return console.error("Erro ao buscar consulta:",a),{success:!1,error:a instanceof Error&&"response"in a&&a.response?.data?.message||"Erro ao buscar consulta"}}}async atualizarConsulta(r,a){try{return{success:!0,data:(await ne.patch(`/rest/v1/consultations/${r}`,a)).data}}catch(t){return console.error("Erro ao atualizar consulta:",t),{success:!1,error:t instanceof Error&&"response"in t&&t.response?.data?.message||"Erro ao atualizar consulta"}}}async deletarConsulta(r){try{return await ne.delete(`/rest/v1/consultations/${r}`),{success:!0}}catch(a){return console.error("Erro ao deletar consulta:",a),{success:!1,error:a instanceof Error&&"response"in a&&a.response?.data?.message||"Erro ao deletar consulta"}}}async confirmarConsulta(r,a,t,o,n){const i=await this.atualizarConsulta(r,{status:"confirmada"});return i.success&&a&&t&&o&&n&&await nr.enviarConfirmacaoConsulta(a,t,o,n),i}async cancelarConsulta(r,a,t,o,n,i){const m=await this.atualizarConsulta(r,{status:"cancelada"});return m.success&&t&&o&&n&&i&&await nr.enviarCancelamentoConsulta(t,o,n,i,a),m}async enviarLembreteConsulta(r,a,t,o,n){try{const i=await nr.enviarLembreteConsulta(a,t,o,n);return i.success?{success:!0}:{success:!1,error:i.error}}catch(i){return console.error("Erro ao enviar lembrete:",i),{success:!1,error:"Erro ao enviar lembrete"}}}async marcarComoRealizada(r,a){return this.atualizarConsulta(r,{status:"realizada",observacoes:a})}async marcarComoFaltou(r){return this.atualizarConsulta(r,{status:"faltou"})}}const pr=new Xt,Qt=()=>e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 animate-pulse",role:"status","aria-label":"Carregando métrica",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-full"}),e.jsxs("div",{className:"ml-4 flex-1",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/2"})]})]})}),Zt=({title:s,onRetry:r})=>e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 border-2 border-red-200",role:"alert","aria-live":"polite",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-red-100 rounded-full",children:e.jsx(Pa,{className:"w-6 h-6 text-red-600"})}),e.jsxs("div",{className:"ml-4 flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:s}),e.jsx("p",{className:"text-sm text-red-600 mt-1",children:"Erro ao carregar"}),r&&e.jsx("button",{onClick:r,className:"mt-2 text-xs text-blue-600 hover:text-blue-800 font-medium focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 rounded px-2 py-1","aria-label":"Tentar carregar novamente",children:"Tentar novamente"})]})]})}),Wt=({title:s,icon:r,iconColor:a,iconBgColor:t,emptyAction:o})=>e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 border-2 border-gray-100",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`p-3 ${t} rounded-full`,children:e.jsx(r,{className:`w-6 h-6 ${a}`})}),e.jsxs("div",{className:"ml-4 flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:s}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:"0"}),e.jsx("button",{onClick:o.onClick,className:"mt-2 text-xs text-blue-600 hover:text-blue-800 font-medium focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 rounded px-2 py-1 transition-colors","aria-label":o.label,children:o.label})]})]})}),$a=({title:s,value:r,icon:a,iconColor:t,iconBgColor:o,description:n,loading:i=!1,error:m=!1,emptyAction:b,ariaLabel:y})=>i?e.jsx(Qt,{}):m?e.jsx(Zt,{title:s}):(typeof r=="number"?r:parseInt(String(r),10)||0)===0&&b?e.jsx(Wt,{title:s,icon:a,iconColor:t,iconBgColor:o,emptyAction:b}):e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow group",role:"region","aria-label":y||s,children:e.jsxs("div",{className:"flex items-center relative",children:[e.jsx("div",{className:`p-3 ${o} rounded-full group-hover:scale-110 transition-transform`,children:e.jsx(a,{className:`w-6 h-6 ${t}`,"aria-hidden":"true"})}),e.jsxs("div",{className:"ml-4 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:s}),e.jsxs("div",{className:"relative group/tooltip",children:[e.jsx("button",{className:"text-gray-400 hover:text-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 rounded-full p-0.5","aria-label":`Informações sobre ${s}`,type:"button",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{className:"absolute z-10 invisible group-hover/tooltip:visible opacity-0 group-hover/tooltip:opacity-100 transition-opacity bg-gray-900 text-white text-xs rounded-lg py-2 px-3 bottom-full left-1/2 transform -translate-x-1/2 mb-2 w-48 pointer-events-none",role:"tooltip",children:[n,e.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1",children:e.jsx("div",{className:"border-4 border-transparent border-t-gray-900"})})]})]})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 tabular-nums","aria-live":"polite",children:r})]})]})}),eo=()=>{const[s,r]=c.useState({totalPacientes:0,totalMedicos:0,consultasHoje:0,consultasPendentes:0}),[a,t]=c.useState(!0),[o,n]=c.useState(!1),i=je();c.useEffect(()=>{m()},[]);const m=async()=>{try{t(!0),n(!1);const[y,d,g]=await Promise.all([Xe().catch(()=>({data:[]})),Ae.listarMedicos().catch(()=>({data:{data:[]}})),pr.listarConsultas().catch(()=>({data:{data:[]}}))]),p=new Date().toISOString().split("T")[0],E=g.data?.data||[],j=E.filter(k=>k.data_hora?.startsWith(p)).length||0,C=E.filter(k=>k.status==="agendada"||k.status==="confirmada").length||0,S=d.data?.data||[];r({totalPacientes:y.data?.length||0,totalMedicos:S.length||0,consultasHoje:j,consultasPendentes:C})}catch(y){console.error("Erro ao carregar estatísticas:",y),n(!0),hr.trackError("stats_load_error",String(y))}finally{t(!1)}},b=(y,d)=>{hr.trackCTA(y,d),i(d)};return e.jsxs("div",{className:"space-y-8",id:"main-content",children:[e.jsxs("div",{className:"relative text-center py-8 md:py-12 lg:py-16 bg-gradient-to-r from-blue-800 via-blue-600 to-blue-500 text-white rounded-xl shadow-lg overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 opacity-10",children:e.jsxs("svg",{width:"100%",height:"100%",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("defs",{children:e.jsx("pattern",{id:"grid",width:"40",height:"40",patternUnits:"userSpaceOnUse",children:e.jsx("circle",{cx:"20",cy:"20",r:"1",fill:"white"})})}),e.jsx("rect",{width:"100%",height:"100%",fill:"url(#grid)"})]})}),e.jsxs("div",{className:"relative z-10 px-4 max-w-4xl mx-auto",children:[e.jsx("h1",{className:"text-3xl md:text-4xl lg:text-5xl font-bold mb-3 md:mb-4",children:J.t("home.hero.title")}),e.jsx("p",{className:"text-base md:text-lg lg:text-xl opacity-95 mb-6 md:mb-8 max-w-2xl mx-auto",children:J.t("home.hero.subtitle")}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 md:gap-4 justify-center items-center",children:[e.jsxs("button",{onClick:()=>b("Agendar consulta","/paciente"),className:"group w-full sm:w-auto inline-flex items-center justify-center px-6 md:px-8 py-3 md:py-4 bg-white text-blue-700 rounded-lg font-semibold hover:bg-blue-50 hover:shadow-xl hover:scale-105 active:scale-95 transition-all duration-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-white/80 focus-visible:ring-offset-blue-600","aria-label":J.t("home.actionCards.scheduleAppointment.ctaAriaLabel"),children:[e.jsx(ve,{className:"w-5 h-5 mr-2 group-hover:scale-110 transition-transform","aria-hidden":"true"}),J.t("home.hero.ctaPrimary"),e.jsx(ds,{className:"w-5 h-5 ml-2 group-hover:translate-x-1 transition-transform","aria-hidden":"true"})]}),e.jsxs("button",{onClick:()=>b("Ver próximas consultas","/consultas"),className:"group w-full sm:w-auto inline-flex items-center justify-center px-6 md:px-8 py-3 md:py-4 bg-blue-700 text-white rounded-lg font-semibold hover:bg-blue-800 hover:shadow-xl hover:scale-105 active:scale-95 border-2 border-white/20 transition-all duration-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-white/80 focus-visible:ring-offset-blue-600","aria-label":"Ver lista de próximas consultas",children:[e.jsx(Pe,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),J.t("home.hero.ctaSecondary")]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6",role:"region","aria-label":"Estatísticas do sistema",children:[e.jsx($a,{title:J.t("home.metrics.totalPatients"),value:s.totalPacientes,icon:la,iconColor:"text-blue-600",iconBgColor:"bg-blue-100",description:J.t("home.metrics.totalPatientsDescription"),loading:a,error:o,ariaLabel:`${J.t("home.metrics.totalPatients")}: ${s.totalPacientes}`}),e.jsx($a,{title:J.t("home.metrics.activeDoctors"),value:s.totalMedicos,icon:dr,iconColor:"text-green-500",iconBgColor:"bg-green-50",description:J.t("home.metrics.activeDoctorsDescription"),loading:a,error:o,ariaLabel:`${J.t("home.metrics.activeDoctors")}: ${s.totalMedicos}`}),e.jsx($a,{title:J.t("home.metrics.todayAppointments"),value:s.consultasHoje,icon:ve,iconColor:"text-yellow-500",iconBgColor:"bg-yellow-50",description:J.t("home.metrics.todayAppointmentsDescription"),loading:a,error:o,ariaLabel:`${J.t("home.metrics.todayAppointments")}: ${s.consultasHoje}`}),e.jsx($a,{title:J.t("home.metrics.pendingAppointments"),value:s.consultasPendentes,icon:Pe,iconColor:"text-purple-500",iconBgColor:"bg-purple-50",description:J.t("home.metrics.pendingAppointmentsDescription"),loading:a,error:o,ariaLabel:`${J.t("home.metrics.pendingAppointments")}: ${s.consultasPendentes}`})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6",role:"region","aria-label":"Ações rápidas",children:[e.jsx(ir,{icon:ve,iconColor:"text-blue-600",iconBgColor:"bg-gradient-to-br from-blue-700 to-blue-400",title:J.t("home.actionCards.scheduleAppointment.title"),description:J.t("home.actionCards.scheduleAppointment.description"),ctaLabel:J.t("home.actionCards.scheduleAppointment.cta"),ctaAriaLabel:J.t("home.actionCards.scheduleAppointment.ctaAriaLabel"),onAction:()=>b("Card Agendar","/paciente")}),e.jsx(ir,{icon:dr,iconColor:"text-indigo-600",iconBgColor:"bg-gradient-to-br from-indigo-600 to-indigo-400",title:J.t("home.actionCards.doctorPanel.title"),description:J.t("home.actionCards.doctorPanel.description"),ctaLabel:J.t("home.actionCards.doctorPanel.cta"),ctaAriaLabel:J.t("home.actionCards.doctorPanel.ctaAriaLabel"),onAction:()=>b("Card Médico","/login-medico")}),e.jsx(ir,{icon:la,iconColor:"text-green-600",iconBgColor:"bg-gradient-to-br from-green-600 to-green-400",title:J.t("home.actionCards.patientManagement.title"),description:J.t("home.actionCards.patientManagement.description"),ctaLabel:J.t("home.actionCards.patientManagement.cta"),ctaAriaLabel:J.t("home.actionCards.patientManagement.ctaAriaLabel"),onAction:()=>b("Card Secretaria","/login-secretaria")})]})]})},ir=({icon:s,iconBgColor:r,title:a,description:t,ctaLabel:o,ctaAriaLabel:n,onAction:i})=>e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-5 md:p-6 hover:shadow-xl transition-all duration-200 group border border-gray-100 focus-within:ring-2 focus-within:ring-blue-500/50 focus-within:ring-offset-2",children:[e.jsx("div",{className:`w-12 h-12 ${r} rounded-lg flex items-center justify-center mb-4 group-hover:scale-110 transition-transform`,children:e.jsx(s,{className:"w-6 h-6 text-white","aria-hidden":"true"})}),e.jsx("h3",{className:"text-lg font-semibold mb-2 text-gray-900",children:a}),e.jsx("p",{className:"text-sm text-gray-600 mb-4 leading-relaxed",children:t}),e.jsxs("button",{onClick:i,className:"w-full inline-flex items-center justify-center px-4 py-2.5 bg-gradient-to-r from-blue-700 to-blue-400 hover:from-blue-800 hover:to-blue-500 hover:scale-105 active:scale-95 text-white rounded-lg font-medium transition-all duration-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-white/80 group-hover:shadow-lg","aria-label":n,children:[o,e.jsx(ds,{className:"w-4 h-4 ml-2 group-hover:translate-x-1 transition-transform","aria-hidden":"true"})]})]}),ao=()=>{const[s,r]=c.useState({email:"",senha:""}),[a,t]=c.useState(!1),[o,n]=c.useState(!1),[i,m]=c.useState({nome:"",email:"",senha:"",confirmarSenha:"",telefone:"",cpf:"",dataNascimento:"",convenio:"",altura:"",peso:"",cep:"",logradouro:"",bairro:"",cidade:"",estado:""}),b=async C=>{if(!(!C||C.replace(/\D/g,"").length<8))try{const k=await(await fetch(`https://viacep.com.br/ws/${C.replace(/\D/g,"")}/json/`)).json();if(k.erro){h.error("CEP não encontrado");return}m(N=>({...N,logradouro:k.logradouro||"",bairro:k.bairro||"",cidade:k.localidade||"",estado:k.uf||""}))}catch{h.error("Erro ao buscar CEP")}},y=je(),{loginPaciente:d}=ke(),g={email:"guilhermesilvagomes1020@gmail.com",senha:"guilherme123",nome:"Guilherme Silva Gomes",id:"guilhermesilvagomes1020@gmail.com"},p=async C=>{C.preventDefault(),t(!0);try{console.log("[LoginPaciente] Fazendo login com email:",s.email);const k=await(await fe(async()=>{const{default:O}=await Promise.resolve().then(()=>Ga);return{default:O}},void 0)).default.login({email:s.email,password:s.senha});if(!k.success){console.log("[LoginPaciente] Erro no login:",k.error),h.error(k.error||"Email ou senha incorretos"),t(!1);return}console.log("[LoginPaciente] Login bem-sucedido!",k.data);const N=(await fe(async()=>{const{default:O}=await Promise.resolve().then(()=>Ke);return{default:O}},void 0)).default,x=N.getAccessToken(),v=N.getRefreshToken();if(console.log("[LoginPaciente] Token salvo:",x?"SIM":"NÃO"),console.log("[LoginPaciente] Refresh token salvo:",v?"SIM":"NÃO"),!x){console.error("[LoginPaciente] Token não foi salvo! Dados do login:",k.data),h.error("Erro ao salvar credenciais de autenticação"),t(!1);return}const{listPatients:$}=await fe(async()=>{const{listPatients:O}=await Promise.resolve().then(()=>Ya);return{listPatients:O}},void 0),Z=await $({search:s.email});console.log("[LoginPaciente] Resultado da busca de pacientes:",Z);const _=Z.data?.[0];_?(console.log("[LoginPaciente] Paciente encontrado:",{id:_.id,nome:_.nome,email:_.email}),await d({id:_.id,nome:_.nome,email:_.email})?(console.log("[LoginPaciente] Navegando para /acompanhamento"),y("/acompanhamento")):(console.error("[LoginPaciente] loginPaciente retornou false"),h.error("Erro ao processar login"))):(console.log("[LoginPaciente] Paciente não encontrado na lista"),h.error("Dados do paciente não encontrados. Entre em contato com o suporte."))}catch(S){console.error("[LoginPaciente] Erro no login:",S),h.error("Erro ao fazer login. Tente novamente.")}finally{t(!1)}},E=async C=>{C.preventDefault(),y("/cadastro-paciente")},j=async()=>{const C=s.email.trim(),S=s.senha;console.log("[LoginPaciente] Login local - tentando com API primeiro"),t(!0);try{const N=await(await fe(async()=>{const{default:O}=await Promise.resolve().then(()=>Ga);return{default:O}},void 0)).default.login({email:C,password:S});if(!N.success){if(console.log("[LoginPaciente] Login via API falhou, usando modo local sem token"),console.log("[LoginPaciente] Erro:",N.error),C!==g.email||S!==g.senha){h.error("Credenciais inválidas"),t(!1);return}h("⚠️ Modo local ativo: algumas funcionalidades podem não funcionar sem API",{icon:"⚠️",duration:5e3}),await d({id:g.id,nome:g.nome,email:g.email})?y("/acompanhamento"):h.error("Não foi possível iniciar a sessão local"),t(!1);return}console.log("[LoginPaciente] Login via API bem-sucedido!");const v=(await fe(async()=>{const{default:O}=await Promise.resolve().then(()=>Ke);return{default:O}},void 0)).default.getAccessToken();console.log("[LoginPaciente] Token salvo:",v?"SIM":"NÃO");const{listPatients:$}=await fe(async()=>{const{listPatients:O}=await Promise.resolve().then(()=>Ya);return{listPatients:O}},void 0),_=(await $({search:C})).data?.[0];_?(console.log("[LoginPaciente] Paciente encontrado na API:",_.nome),await d({id:_.id,nome:_.nome,email:_.email})?y("/acompanhamento"):h.error("Erro ao processar login")):(console.log("[LoginPaciente] Paciente não encontrado na API, usando dados locais"),await d({id:C,nome:C.split("@")[0],email:C})?y("/acompanhamento"):h.error("Erro ao processar login"))}catch(k){console.error("[LoginPaciente] Erro no login:",k),h.error("Erro ao fazer login")}finally{t(!1)}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-white dark:from-gray-900 dark:to-gray-950 flex items-center justify-center p-4 transition-colors",children:e.jsxs("div",{className:"max-w-md w-full",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-700 to-blue-400 dark:from-blue-800 dark:to-blue-500 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 shadow-md",children:e.jsx(ia,{className:"w-8 h-8 text-white"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100 mb-2",children:o?"Criar Conta":"Área do Paciente"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:o?"Preencha seus dados para criar sua conta":"Faça login para acompanhar suas consultas"})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8 border border-transparent dark:border-gray-700 transition-colors","aria-live":"polite",children:o?e.jsxs("form",{onSubmit:E,className:"space-y-4",noValidate:!0,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"cad_nome",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Nome Completo"}),e.jsx("input",{id:"cad_nome",type:"text",value:i.nome,onChange:C=>m(S=>({...S,nome:C.target.value})),className:"form-input dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-gray-100",required:!0,autoComplete:"name"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"cad_cpf",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"CPF"}),e.jsx("input",{id:"cad_cpf",type:"text",value:i.cpf,onChange:C=>m(S=>({...S,cpf:C.target.value})),className:"form-input dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-gray-100",placeholder:"000.000.000-00",required:!0,inputMode:"numeric",pattern:"^\\d{3}\\.\\d{3}\\.\\d{3}-\\d{2}$|^\\d{11}$"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"cad_cep",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"CEP"}),e.jsx("input",{id:"cad_cep",type:"text",value:i.cep,onChange:C=>m(S=>({...S,cep:C.target.value})),onBlur:()=>b(i.cep),className:"form-input dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-gray-100",placeholder:"00000-000",required:!0,inputMode:"numeric",pattern:"^\\d{5}-?\\d{3}$",autoComplete:"postal-code"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"cad_logradouro",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Logradouro"}),e.jsx("input",{id:"cad_logradouro",type:"text",value:i.logradouro,onChange:C=>m(S=>({...S,logradouro:C.target.value})),className:"form-input dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-gray-100",required:!0,autoComplete:"address-line1"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"cad_bairro",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Bairro"}),e.jsx("input",{id:"cad_bairro",type:"text",value:i.bairro,onChange:C=>m(S=>({...S,bairro:C.target.value})),className:"form-input dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-gray-100",required:!0,autoComplete:"address-line2"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"cad_cidade",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Cidade"}),e.jsx("input",{id:"cad_cidade",type:"text",value:i.cidade,onChange:C=>m(S=>({...S,cidade:C.target.value})),className:"form-input dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-gray-100",required:!0,autoComplete:"address-level2"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"cad_estado",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Estado"}),e.jsx("input",{id:"cad_estado",type:"text",value:i.estado,onChange:C=>m(S=>({...S,estado:C.target.value})),className:"form-input dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-gray-100",required:!0,autoComplete:"address-level1"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"cad_email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Email"}),e.jsx("input",{id:"cad_email",type:"email",value:i.email,onChange:C=>m(S=>({...S,email:C.target.value})),className:"form-input dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-gray-100",required:!0,autoComplete:"email"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"cad_senha",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Senha"}),e.jsx("input",{id:"cad_senha",type:"password",value:i.senha,onChange:C=>m(S=>({...S,senha:C.target.value})),className:"form-input dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-gray-100",minLength:6,required:!0,autoComplete:"new-password"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"cad_confirma_senha",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Confirmar Senha"}),e.jsx("input",{id:"cad_confirma_senha",type:"password",value:i.confirmarSenha,onChange:C=>m(S=>({...S,confirmarSenha:C.target.value})),className:"form-input dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-gray-100",required:!0,autoComplete:"new-password","aria-invalid":i.confirmarSenha!==""&&i.confirmarSenha!==i.senha,"aria-describedby":i.confirmarSenha!==""&&i.confirmarSenha!==i.senha?"cad_senha_help":void 0}),i.confirmarSenha!==""&&i.confirmarSenha!==i.senha&&e.jsx("p",{id:"cad_senha_help",className:"mt-1 text-xs text-red-400",children:"As senhas não coincidem."})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"cad_telefone",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Telefone"}),e.jsx("input",{id:"cad_telefone",type:"tel",value:i.telefone,onChange:C=>m(S=>({...S,telefone:C.target.value})),className:"form-input dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-gray-100",placeholder:"(11) 99999-9999",required:!0,inputMode:"numeric",pattern:"^\\(?\\d{2}\\)?\\s?9?\\d{4}-?\\d{4}$",autoComplete:"tel"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"cad_data_nasc",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Data de Nascimento"}),e.jsx("input",{id:"cad_data_nasc",type:"date",value:i.dataNascimento,onChange:C=>m(S=>({...S,dataNascimento:C.target.value})),className:"form-input dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-gray-100",required:!0,autoComplete:"bday"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"cad_convenio",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Convênio"}),e.jsxs("select",{id:"cad_convenio",value:i.convenio,onChange:C=>m(S=>({...S,convenio:C.target.value})),className:"form-input dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-gray-100",children:[e.jsx("option",{value:"",children:"Selecione"}),e.jsx("option",{value:"Particular",children:"Particular"}),e.jsx("option",{value:"Unimed",children:"Unimed"}),e.jsx("option",{value:"Bradesco Saúde",children:"Bradesco Saúde"}),e.jsx("option",{value:"SulAmérica",children:"SulAmérica"}),e.jsx("option",{value:"Amil",children:"Amil"}),e.jsx("option",{value:"NotreDame",children:"NotreDame"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"cad_altura",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Altura (cm)"}),e.jsx("input",{id:"cad_altura",type:"number",value:i.altura,onChange:C=>m(S=>({...S,altura:C.target.value})),className:"form-input dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-gray-100",placeholder:"170",min:"50",max:"250"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"cad_peso",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Peso (kg)"}),e.jsx("input",{id:"cad_peso",type:"number",value:i.peso,onChange:C=>m(S=>({...S,peso:C.target.value})),className:"form-input dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-gray-100",placeholder:"70",min:"20",max:"300",step:"0.1"})]})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("button",{type:"button",onClick:()=>n(!1),className:"flex-1 bg-gray-100 text-gray-700 py-3 px-4 rounded-lg font-medium hover:bg-gray-200 transition-colors",children:"Voltar"}),e.jsx("button",{type:"submit",disabled:a,className:"flex-1 bg-gradient-to-r from-blue-700 to-blue-400 text-white py-3 px-4 rounded-lg font-medium hover:from-blue-800 hover:to-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:a?"Cadastrando...":"Cadastrar"})]})]}):e.jsxs("form",{onSubmit:p,className:"space-y-6",noValidate:!0,children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"login_email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(da,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{id:"login_email",type:"email",value:s.email,onChange:C=>r(S=>({...S,email:C.target.value})),className:"form-input pl-10 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-gray-100",placeholder:"seu@email.com",required:!0,autoComplete:"email"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"login_password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Senha"}),e.jsxs("div",{className:"relative",children:[e.jsx(yr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{id:"login_password",type:"password",value:s.senha,onChange:C=>r(S=>({...S,senha:C.target.value})),className:"form-input pl-10 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-gray-100",placeholder:"Sua senha",required:!0,autoComplete:"current-password"})]})]}),e.jsx("button",{type:"button",onClick:j,disabled:a,className:"w-full bg-gradient-to-r from-blue-700 to-blue-400 text-white py-3 px-4 rounded-lg font-medium hover:from-blue-800 hover:to-blue-500 hover:scale-105 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100 transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2",children:a?"Entrando...":"Entrar"}),e.jsxs("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400 text-center",children:[e.jsx("strong",{children:g.email})," /"," ",e.jsx("strong",{children:g.senha})]})]})})]})})},ro=()=>{const[s,r]=c.useState({email:"",senha:""}),[a,t]=c.useState(!1),o=je(),{loginComEmailSenha:n}=ke(),i={email:"secretaria.mediconnect@gmail.com",senha:"secretaria@mediconnect"},m=async b=>{b.preventDefault(),t(!0);try{console.log("[LoginSecretaria] Fazendo login com email:",s.email);const d=await(await fe(async()=>{const{default:j}=await Promise.resolve().then(()=>Ga);return{default:j}},void 0)).default.login({email:s.email,password:s.senha});if(!d.success){console.log("[LoginSecretaria] Erro no login:",d.error),h.error(d.error||"Email ou senha incorretos"),t(!1);return}console.log("[LoginSecretaria] Login bem-sucedido!",d.data);const p=(await fe(async()=>{const{default:j}=await Promise.resolve().then(()=>Ke);return{default:j}},void 0)).default.getAccessToken();if(console.log("[LoginSecretaria] Token salvo:",p?"SIM":"NÃO"),!p){console.error("[LoginSecretaria] Token não foi salvo!"),h.error("Erro ao salvar credenciais de autenticação"),t(!1);return}await n(s.email,s.senha)?(console.log("[LoginSecretaria] Navegando para /painel-secretaria"),h.success("Login realizado com sucesso!"),o("/painel-secretaria")):(console.error("[LoginSecretaria] loginComEmailSenha retornou false"),h.error("Erro ao processar login"))}catch(y){console.error("[LoginSecretaria] Erro no login:",y),h.error("Erro ao fazer login. Tente novamente.")}finally{t(!1)}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-white dark:from-gray-900 dark:to-gray-950 flex items-center justify-center p-4 transition-colors",children:e.jsxs("div",{className:"max-w-md w-full",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"bg-gradient-to-r from-green-600 to-green-400 dark:from-green-700 dark:to-green-500 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 shadow-md",children:e.jsx(cs,{className:"w-8 h-8 text-white"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100 mb-2",children:"Área da Secretaria"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Faça login para acessar o sistema de gestão"})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8 border border-transparent dark:border-gray-700 transition-colors","aria-live":"polite",children:e.jsxs("form",{onSubmit:m,className:"space-y-6",noValidate:!0,children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sec_email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(da,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{id:"sec_email",type:"email",value:s.email,onChange:b=>r(y=>({...y,email:b.target.value})),className:"form-input pl-10 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-gray-100",placeholder:"seu@email.com",required:!0,autoComplete:"email"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sec_password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Senha"}),e.jsxs("div",{className:"relative",children:[e.jsx(yr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{id:"sec_password",type:"password",value:s.senha,onChange:b=>r(y=>({...y,senha:b.target.value})),className:"form-input pl-10 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-gray-100",placeholder:"Sua senha",required:!0,autoComplete:"current-password"})]})]}),e.jsx("button",{type:"submit",disabled:a,className:"w-full bg-gradient-to-r from-green-600 to-green-400 text-white py-3 px-4 rounded-lg font-medium hover:from-green-700 hover:to-green-500 hover:scale-105 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100 transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-green-500 focus-visible:ring-offset-2",children:a?"Entrando...":"Entrar"}),e.jsxs("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400 text-center",children:[e.jsx("strong",{children:i.email})," /"," ",e.jsx("strong",{children:i.senha})]})]})})]})})},so=()=>{const[s,r]=c.useState({email:"",senha:""}),[a,t]=c.useState(!1),o=je(),{loginComEmailSenha:n}=ke(),i={email:"fernando.pirichowski@souunit.com.br",senha:"fernando"},m=async b=>{b.preventDefault(),t(!0);try{console.log("[LoginMedico] Fazendo login com email:",s.email);const d=await(await fe(async()=>{const{default:j}=await Promise.resolve().then(()=>Ga);return{default:j}},void 0)).default.login({email:s.email,password:s.senha});if(!d.success){console.log("[LoginMedico] Erro no login:",d.error),h.error(d.error||"Email ou senha incorretos"),t(!1);return}console.log("[LoginMedico] Login bem-sucedido!",d.data);const p=(await fe(async()=>{const{default:j}=await Promise.resolve().then(()=>Ke);return{default:j}},void 0)).default.getAccessToken();if(console.log("[LoginMedico] Token salvo:",p?"SIM":"NÃO"),!p){console.error("[LoginMedico] Token não foi salvo!"),h.error("Erro ao salvar credenciais de autenticação"),t(!1);return}await n(s.email,s.senha)?(console.log("[LoginMedico] Navegando para /painel-medico"),h.success("Login realizado com sucesso!"),o("/painel-medico")):(console.error("[LoginMedico] loginComEmailSenha retornou false"),h.error("Erro ao processar login"))}catch(y){console.error("[LoginMedico] Erro no login:",y),h.error("Erro ao fazer login. Tente novamente.")}finally{t(!1)}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-indigo-50 to-white dark:from-gray-900 dark:to-gray-950 flex items-center justify-center p-4 transition-colors",children:e.jsxs("div",{className:"max-w-md w-full",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"bg-gradient-to-r from-indigo-600 to-indigo-400 dark:from-indigo-700 dark:to-indigo-500 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 shadow-md",children:e.jsx(Ge,{className:"w-8 h-8 text-white"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100 mb-2",children:"Área do Médico"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Faça login para acessar seu painel médico"})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8 border border-transparent dark:border-gray-700 transition-colors","aria-live":"polite",children:e.jsxs("form",{onSubmit:m,className:"space-y-6",noValidate:!0,children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"med_email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(da,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{id:"med_email",type:"email",value:s.email,onChange:b=>r(y=>({...y,email:b.target.value})),className:"form-input pl-10 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-gray-100",placeholder:"seu@email.com",required:!0,autoComplete:"email"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"med_password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Senha"}),e.jsxs("div",{className:"relative",children:[e.jsx(yr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{id:"med_password",type:"password",value:s.senha,onChange:b=>r(y=>({...y,senha:b.target.value})),className:"form-input pl-10 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-gray-100",placeholder:"Sua senha",required:!0,autoComplete:"current-password"})]})]}),e.jsx("button",{type:"submit",disabled:a,className:"w-full bg-gradient-to-r from-indigo-600 to-indigo-400 text-white py-3 px-4 rounded-lg font-medium hover:from-indigo-700 hover:to-indigo-500 hover:scale-105 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100 transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500 focus-visible:ring-offset-2",children:a?"Entrando...":"Entrar"}),e.jsxs("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400 text-center",children:[e.jsx("strong",{children:i.email})," /"," ",e.jsx("strong",{children:i.senha})]})]})})]})})};class to{async listarTodas(){try{const r=await ne.get(Y.CONSULTATIONS,{params:{select:"*"}});return{success:!0,data:(Array.isArray(r.data)?r.data:r.data?.data||[]).map(this.mapConsulta)}}catch(r){return console.error("Erro ao listar todas as consultas:",r),{success:!1,error:"Erro ao listar todas as consultas"}}}async listarPorPaciente(r,a){try{const t={patient_id:`eq.${r}`};a?.limit&&(t.limit=String(a.limit)),a?.sort&&(t.order=`dataHora.${a.sort}`);const o=await ne.get(Y.CONSULTATIONS,{params:t});return{success:!0,data:(Array.isArray(o.data)?o.data:o.data?.data||[]).map(this.mapConsulta)}}catch(t){return console.error("Erro ao listar consultas por paciente:",t),{success:!1,error:"Erro ao listar consultas"}}}async listarPorMedico(r,a){try{const t={doctor_id:`eq.${r}`};a?.status&&(t.status=`eq.${a.status}`),a?.dateFrom&&(t.dataHora=`gte.${a.dateFrom}`),a?.dateTo&&(t.dataHora=`lte.${a.dateTo}`),a?.limit&&(t.limit=String(a.limit));const o=await ne.get(Y.CONSULTATIONS,{params:t});return{success:!0,data:(Array.isArray(o.data)?o.data:o.data?.data||[]).map(this.mapConsulta)}}catch(t){return console.error("Erro ao listar consultas por médico:",t),{success:!1,error:"Erro ao listar consultas"}}}async criar(r){try{const a=await ne.post(Y.CONSULTATIONS,r);return{success:!0,data:this.mapConsulta(a.data)}}catch(a){return console.error("Erro ao criar consulta:",a),{success:!1,error:"Erro ao criar consulta"}}}async atualizar(r,a){try{const t=await ne.patch(`${Y.CONSULTATIONS}/${r}`,a);return{success:!0,data:this.mapConsulta(t.data)}}catch(t){return console.error("Erro ao atualizar consulta:",t),{success:!1,error:"Erro ao atualizar consulta"}}}async deletar(r){try{return await ne.delete(`${Y.CONSULTATIONS}/${r}`),{success:!0}}catch(a){return console.error("Erro ao deletar consulta:",a),{success:!1,error:"Erro ao deletar consulta"}}}async obterUltimaPorPaciente(r){try{const a=await this.listarPorPaciente(r,{limit:10});return!a.success||!a.data?{success:!0,data:null}:{success:!0,data:[...a.data].sort((o,n)=>n.dataHora.localeCompare(o.dataHora))[0]||null}}catch{return{success:!1,error:"Erro ao obter última consulta"}}}async obterProximaPorPaciente(r){try{const a=new Date().toISOString(),t=await this.listarPorPaciente(r,{limit:50});if(!t.success||!t.data)return{success:!0,data:null};const o=t.data.filter(n=>n.dataHora>=a);return o.sort((n,i)=>n.dataHora.localeCompare(i.dataHora)),{success:!0,data:o[0]||null}}catch{return{success:!1,error:"Erro ao obter próxima consulta"}}}mapConsulta(r){return{id:r.id||r._id||r.Id||r.consultaId||Math.random().toString(36).slice(2,11),pacienteId:r.pacienteId||r.patient_id||r.paciente||"",medicoId:r.medicoId||r.doctor_id||r.medico||"",dataHora:r.dataHora||r.data_hora||r.date||new Date().toISOString(),status:r.status||"agendada",tipo:r.tipo||r.tipoConsulta||r.type||void 0,motivo:r.motivo||r.motivoConsulta||void 0,observacoes:r.observacoes||r.notes||void 0,valorPago:r.valorPago??r.valor_pago??void 0,formaPagamento:r.formaPagamento||r.payment_method||void 0,created_at:r.created_at,updated_at:r.updated_at}}}const Aa=new to;function er(s){return{id:s.id||"",patientId:s.patient_id,orderNumber:s.order_number,exam:s.exam??null,diagnosis:s.diagnosis??null,conclusion:s.conclusion??null,cidCode:s.cid_code??null,contentHtml:s.content_html??null,contentJson:s.content_json??null,status:s.status,requestedBy:s.requested_by??null,dueAt:s.due_at??null,hideDate:s.hide_date??null,hideSignature:s.hide_signature??null,createdAt:s.created_at,updatedAt:s.updated_at,createdBy:s.created_by}}async function oo(s){const r={select:"*"};s?.patientId&&(r.patient_id=`eq.${s.patientId}`),s?.status&&(r.status=`eq.${s.status}`);const a=await Q.get(Y.REPORTS,{params:r});if(!a.success)return{success:!1,error:a.error};const t=Array.isArray(a.data)?a.data:a.data?.data;return{success:!0,data:(Array.isArray(t)?t:[]).map(er)}}async function no(s){if(!s.patientId?.trim())return{success:!1,error:"patientId é obrigatório"};if(!s.orderNumber?.trim())return{success:!1,error:"orderNumber é obrigatório"};const r={patient_id:s.patientId,order_number:s.orderNumber,exam:s.exam,diagnosis:s.diagnosis,conclusion:s.conclusion,cid_code:s.cidCode,content_html:s.contentHtml,content_json:s.contentJson,status:s.status,requested_by:s.requestedBy,due_at:s.dueAt,hide_date:s.hideDate,hide_signature:s.hideSignature};Object.keys(r).forEach(n=>{(r[n]===void 0||r[n]==="")&&delete r[n]});const a=await Q.post(Y.REPORTS,r,{headers:{Prefer:"return=representation"}});if(!a.success)return{success:!1,error:a.error};const t=a.data,o=Array.isArray(t)?t[0]:t;return o?{success:!0,data:er(o)}:{success:!1,error:"Resposta inesperada da API"}}async function io(s){if(!s)return{success:!1,error:"ID é obrigatório"};const r=await Q.get(`${Y.REPORTS}/${encodeURIComponent(s)}`);let a;if(r.success&&r.data)a=r.data;else{const t=await Q.get(Y.REPORTS,{params:{id:`eq.${s}`,select:"*"}});if(t.success){const o=t.data,n=Array.isArray(o)?o:o&&typeof o=="object"?o.data:void 0;a=Array.isArray(n)?n[0]:void 0}else return{success:!1,error:r.error||t.error||"Erro ao buscar relatório"}}return!a||typeof a!="object"?{success:!1,error:"Relatório não encontrado"}:{success:!0,data:er(a)}}async function lo(s,r){if(!s)return{success:!1,error:"ID é obrigatório"};if(!r.patientId?.trim())return{success:!1,error:"patientId é obrigatório"};if(!r.orderNumber?.trim())return{success:!1,error:"orderNumber é obrigatório"};const a={patient_id:r.patientId,order_number:r.orderNumber,exam:r.exam,diagnosis:r.diagnosis,conclusion:r.conclusion,cid_code:r.cidCode,content_html:r.contentHtml,content_json:r.contentJson,status:r.status,requested_by:r.requestedBy,due_at:r.dueAt,hide_date:r.hideDate,hide_signature:r.hideSignature};Object.keys(a).forEach(i=>{(a[i]===void 0||a[i]==="")&&delete a[i]});const t=await Q.patch(`${Y.REPORTS}?id=eq.${encodeURIComponent(s)}`,a,{headers:{Prefer:"return=representation"}});if(!t.success)return{success:!1,error:t.error};const o=t.data,n=Array.isArray(o)?o[0]:o;return n?{success:!0,data:er(n)}:{success:!1,error:"Relatório não retornado"}}const Zr={listReports:oo,createReport:no,getReportById:io,updateReport:lo};class co{async getAvailableSlots(r){try{const a=await Q.post(Y.AVAILABLE_SLOTS,r);return a.success&&a.data?{success:!0,data:a.data}:{success:!1,error:a.error||"Erro ao buscar horários disponíveis"}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Erro desconhecido"}}}async listAppointments(r){try{const a={};r?.select&&(a.select=r.select),r?.doctor_id&&(a.doctor_id=`eq.${r.doctor_id}`),r?.patient_id&&(a.patient_id=`eq.${r.patient_id}`),r?.status&&(a.status=`eq.${r.status}`),r?.scheduled_at&&(a.scheduled_at=r.scheduled_at),r?.order&&(a.order=r.order),r?.limit&&(a.limit=String(r.limit)),r?.offset&&(a.offset=String(r.offset)),a.select||(a.select="*"),a.order||(a.order="scheduled_at.desc"),a.limit||(a.limit="100");const t=await Q.get(Y.APPOINTMENTS,{params:a});return t.success&&t.data?{success:!0,data:Array.isArray(t.data)?t.data:[t.data]}:{success:!1,error:t.error||"Erro ao listar agendamentos"}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Erro desconhecido"}}}async createAppointment(r){try{const a=Ee.getStoredUser();if(!a?.id)return{success:!1,error:"Usuário não autenticado"};const t={...r,created_by:a.id},o=await Q.post(Y.APPOINTMENTS,t,{headers:{Prefer:"return=representation"}});return o.success&&o.data?{success:!0,data:Array.isArray(o.data)?o.data[0]:o.data,message:"Agendamento criado com sucesso"}:{success:!1,error:o.error||"Erro ao criar agendamento"}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Erro desconhecido"}}}async getAppointmentById(r){try{const a=await Q.get(`${Y.APPOINTMENTS}?id=eq.${r}&select=*`);if(a.success&&a.data){const t=Array.isArray(a.data)?a.data:[a.data];if(t.length>0)return{success:!0,data:t[0]}}return{success:!1,error:"Agendamento não encontrado"}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Erro desconhecido"}}}async updateAppointment(r,a){try{const t=await Q.patch(`${Y.APPOINTMENTS}?id=eq.${r}`,a,{headers:{Prefer:"return=representation"}});return t.success&&t.data?{success:!0,data:Array.isArray(t.data)?t.data[0]:t.data,message:"Agendamento atualizado com sucesso"}:{success:!1,error:t.error||"Erro ao atualizar agendamento"}}catch(t){return{success:!1,error:t instanceof Error?t.message:"Erro desconhecido"}}}async deleteAppointment(r){try{const a=await Q.delete(`${Y.APPOINTMENTS}?id=eq.${r}`);return a.success?{success:!0,data:void 0,message:"Agendamento deletado com sucesso"}:{success:!1,error:a.error||"Erro ao deletar agendamento"}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Erro desconhecido"}}}confirmAppointment(r){return this.updateAppointment(r,{status:"confirmed"})}checkInAppointment(r){return this.updateAppointment(r,{status:"checked_in",checked_in_at:new Date().toISOString()})}startAppointment(r){return this.updateAppointment(r,{status:"in_progress"})}completeAppointment(r,a){return this.updateAppointment(r,{status:"completed",completed_at:new Date().toISOString(),notes:a})}cancelAppointment(r,a){return this.updateAppointment(r,{status:"cancelled",cancelled_at:new Date().toISOString(),cancellation_reason:a})}markAsNoShow(r){return this.updateAppointment(r,{status:"no_show"})}listDoctorAppointments(r,a){return this.listAppointments({...a,doctor_id:r})}listPatientAppointments(r,a){return this.listAppointments({...a,patient_id:r})}listTodayAppointments(r){const a=new Date().toISOString().split("T")[0];return this.listAppointments({doctor_id:r,scheduled_at:`gte.${a}T00:00:00`,order:"scheduled_at.asc"})}listUpcomingPatientAppointments(r){const a=new Date().toISOString();return this.listAppointments({patient_id:r,scheduled_at:`gte.${a}`,order:"scheduled_at.asc",limit:10})}}const sa=new co,uo={segunda:"monday",terca:"tuesday",quarta:"wednesday",quinta:"thursday",sexta:"friday",sabado:"saturday",domingo:"sunday"},mo={monday:"segunda",tuesday:"terca",wednesday:"quarta",thursday:"quinta",friday:"sexta",saturday:"sabado",sunday:"domingo"};function Wr(s){return uo[s]}function lr(s){return mo[s]}class go{async listAvailability(r){try{const a={};r?.select&&(a.select=r.select),r?.doctor_id&&(a.doctor_id=`eq.${r.doctor_id}`),r?.active!==void 0&&(a.active=`eq.${r.active}`),a.select||(a.select="*");const t=await Q.get(Y.DOCTOR_AVAILABILITY,{params:a});return t.success&&t.data?{success:!0,data:(Array.isArray(t.data)?t.data:[t.data]).map(i=>i.weekday?{...i,weekday:lr(i.weekday)}:i)}:{success:!1,error:t.error||"Erro ao listar disponibilidades"}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Erro desconhecido"}}}async createAvailability(r){try{console.log("[AvailabilityService] Criando disponibilidade (PT-BR):",r);const a=Ee.getStoredUser();if(!a?.id)return{success:!1,error:"Usuário não autenticado"};const t={...r,weekday:Wr(r.weekday),created_by:a.id};console.log("[AvailabilityService] Payload convertido (EN):",t),console.log("[AvailabilityService] Endpoint:",Y.DOCTOR_AVAILABILITY);const o=await Q.post(Y.DOCTOR_AVAILABILITY,t,{headers:{Prefer:"return=representation"}});if(console.log("[AvailabilityService] Resposta:",o),o.success&&o.data){const n=Array.isArray(o.data)?o.data[0]:o.data;return n.weekday&&(n.weekday=lr(n.weekday)),{success:!0,data:n,message:"Disponibilidade criada com sucesso"}}return{success:!1,error:o.error||"Erro ao criar disponibilidade"}}catch(a){return console.error("[AvailabilityService] Exceção:",a),{success:!1,error:a instanceof Error?a.message:"Erro desconhecido"}}}async updateAvailability(r,a){try{const t=a.weekday?{...a,weekday:Wr(a.weekday)}:a,o=await Q.patch(`${Y.DOCTOR_AVAILABILITY}?id=eq.${r}`,t,{headers:{Prefer:"return=representation"}});if(o.success&&o.data){const n=Array.isArray(o.data)?o.data[0]:o.data;return n.weekday&&(n.weekday=lr(n.weekday)),{success:!0,data:n,message:"Disponibilidade atualizada com sucesso"}}return{success:!1,error:o.error||"Erro ao atualizar disponibilidade"}}catch(t){return{success:!1,error:t instanceof Error?t.message:"Erro desconhecido"}}}async deleteAvailability(r){try{const a=await Q.delete(`${Y.DOCTOR_AVAILABILITY}?id=eq.${r}`);return a.success?{success:!0,data:void 0,message:"Disponibilidade deletada com sucesso"}:{success:!1,error:a.error||"Erro ao deletar disponibilidade"}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Erro desconhecido"}}}async listDoctorActiveAvailability(r){return this.listAvailability({doctor_id:r,active:!0})}activateAvailability(r){return this.updateAvailability(r,{active:!0})}deactivateAvailability(r){return this.updateAvailability(r,{active:!1})}async createWeekSchedule(r,a,t,o,n=30,i="presencial"){const m=[],b=[];for(const y of a){const d=await this.createAvailability({doctor_id:r,weekday:y,start_time:t,end_time:o,slot_minutes:n,appointment_type:i,active:!0});d.success&&d.data?m.push(d.data):b.push(`${y}: ${d.error}`)}return b.length?{success:!1,error:`Erros: ${b.join(", ")}`}:{success:!0,data:m,message:"Horários da semana criados com sucesso"}}async getDoctorAvailabilityForDay(r,a){const t=await this.listAvailability({doctor_id:r,active:!0});return!t.success||!t.data?t:{success:!0,data:t.data.filter(o=>o.weekday===a)}}async isDoctorAvailableOnDay(r,a){const t=await this.getDoctorAvailabilityForDay(r,a);return!!(t.success&&t.data&&t.data.length>0)}async getDoctorScheduleSummary(r){const a=await this.listDoctorActiveAvailability(r);if(!a.success||!a.data)return{success:!1,error:"Erro ao buscar horários"};const t={segunda:[],terca:[],quarta:[],quinta:[],sexta:[],sabado:[],domingo:[]};return a.data.forEach(o=>{o.weekday&&o.start_time&&o.end_time&&t[o.weekday].push({start:o.start_time,end:o.end_time,type:o.appointment_type||"presencial"})}),{success:!0,data:t}}async getAvailability(r){try{const a=await this.listAvailability({doctor_id:r});if(!a.success||!a.data)return{success:!1,error:a.error||"Nenhuma disponibilidade"};const t=a.data[0];if(t&&t.domingo!==void 0)return{success:!0,data:a.data};const n={domingo:{ativo:!1,horarios:[]},segunda:{ativo:!1,horarios:[]},terca:{ativo:!1,horarios:[]},quarta:{ativo:!1,horarios:[]},quinta:{ativo:!1,horarios:[]},sexta:{ativo:!1,horarios:[]},sabado:{ativo:!1,horarios:[]}};return a.data.forEach(i=>{const m=i.weekday;if(!m)return;const b={ativo:i.active??i.ativo??!0,horarios:[{inicio:i.start_time||i.inicio||"",fim:i.end_time||i.fim||"",ativo:i.active??i.ativo??!0}]};n[m]=b}),{success:!0,data:[n]}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Erro desconhecido"}}}}const qe=new go;function es(s){const r=s.getFullYear(),a=String(s.getMonth()+1).padStart(2,"0"),t=String(s.getDate()).padStart(2,"0");return`${r}-${a}-${t}`}class xo{async listExceptions(r){try{const a={};r?.select&&(a.select=r.select),r?.doctor_id&&(a.doctor_id=`eq.${r.doctor_id}`),r?.date&&(a.date=`eq.${r.date}`),a.select||(a.select="*");const t=await Q.get(Y.DOCTOR_EXCEPTIONS,{params:a});return t.success&&t.data?{success:!0,data:Array.isArray(t.data)?t.data:[t.data]}:{success:!1,error:t.error||"Erro ao listar exceções"}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Erro desconhecido"}}}async createException(r){try{const a=Ee.getStoredUser();if(!a?.id)return{success:!1,error:"Usuário não autenticado"};const t={...r,created_by:a.id},o=await Q.post(Y.DOCTOR_EXCEPTIONS,t,{headers:{Prefer:"return=representation"}});return o.success&&o.data?{success:!0,data:Array.isArray(o.data)?o.data[0]:o.data,message:"Exceção criada com sucesso"}:{success:!1,error:o.error||"Erro ao criar exceção"}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Erro desconhecido"}}}async deleteException(r){try{const a=await Q.delete(`${Y.DOCTOR_EXCEPTIONS}?id=eq.${r}`);return a.success?{success:!0,data:void 0,message:"Exceção deletada com sucesso"}:{success:!1,error:a.error||"Erro ao deletar exceção"}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Erro desconhecido"}}}blockFullDay(r,a,t){return this.createException({doctor_id:r,date:a,kind:"bloqueio",reason:t})}blockTimeSlot(r,a,t,o,n){return this.createException({doctor_id:r,date:a,start_time:t,end_time:o,kind:"bloqueio",reason:n})}async blockVacation(r,a,t,o="Férias"){const n=new Date(a),i=new Date(t),m=[],b=[];for(let y=new Date(n);y<=i;y.setDate(y.getDate()+1)){const d=es(y),g=await this.blockFullDay(r,d,o);g.success&&g.data?m.push(g.data):b.push(`${d}: ${g.error}`)}return b.length?{success:!1,error:`Erros ao bloquear férias: ${b.join(", ")}`}:{success:!0,data:m,message:`${m.length} dia(s) bloqueado(s)`}}releaseFullDay(r,a,t){return this.createException({doctor_id:r,date:a,kind:"liberacao",reason:t})}releaseTimeSlot(r,a,t,o,n){return this.createException({doctor_id:r,date:a,start_time:t,end_time:o,kind:"liberacao",reason:n})}async listDoctorBlocks(r){const a=await this.listExceptions({doctor_id:r});return!a.success||!a.data?a:{success:!0,data:a.data.filter(t=>t.kind==="bloqueio")}}async listDoctorReleases(r){const a=await this.listExceptions({doctor_id:r});return!a.success||!a.data?a:{success:!0,data:a.data.filter(t=>t.kind==="liberacao")}}async isDayBlocked(r,a){const t=await this.listExceptions({doctor_id:r,date:a});return!t.success||!t.data?!1:t.data.some(o=>o.kind==="bloqueio")}async isTimeSlotBlocked(r,a,t){const o=await this.listExceptions({doctor_id:r,date:a});if(!o.success||!o.data)return!1;for(const n of o.data)if(n.kind==="bloqueio"&&(!n.start_time&&!n.end_time||n.start_time&&n.end_time&&t>=n.start_time&&t<=n.end_time))return!0;return!1}async getFutureExceptions(r){const a=await this.listExceptions({doctor_id:r});if(!a.success||!a.data)return a;const t=es(new Date);return{success:!0,data:a.data.filter(o=>o.date&&o.date>=t)}}async getMonthExceptionsSummary(r,a,t){const o=await this.listExceptions({doctor_id:r});if(!o.success||!o.data)return{success:!1,error:"Erro ao buscar exceções"};const n=`${a}-${String(t).padStart(2,"0")}`,i=o.data.filter(y=>y.date&&y.date.startsWith(n)),m=i.filter(y=>y.kind==="bloqueio"),b=i.filter(y=>y.kind==="liberacao");return{success:!0,data:{blocks:m,releases:b,totalBlocks:m.length,totalReleases:b.length}}}async deleteExceptionsInRange(r,a,t){const o=await this.listExceptions({doctor_id:r});if(!o.success||!o.data)return{success:!1,error:"Erro ao buscar exceções"};const n=o.data.filter(b=>b.date&&b.date>=a&&b.date<=t);let i=0;const m=[];for(const b of n){if(!b.id)continue;const y=await this.deleteException(b.id);y.success?i++:m.push(`${b.date}: ${y.error}`)}return m.length?{success:!1,error:`Erros ao deletar: ${m.join(", ")}`}:{success:!0,data:{deletedCount:i},message:`${i} exceção(ões) deletada(s)`}}}const na=new xo,_s=({doctorId:s,date:r,onSelect:a,appointment_type:t})=>{const[o,n]=c.useState([]),[i,m]=c.useState(!1),b=c.useMemo(()=>{if(!r)return null;const y=new Date(`${r}T00:00:00Z`).toISOString(),d=new Date(`${r}T23:59:59Z`).toISOString();return{start:y,end:d}},[r]);return c.useEffect(()=>{async function y(){if(!s||!b)return;m(!0);const d=await sa.getAvailableSlots({doctor_id:s,start_date:b.start,end_date:b.end,appointment_type:t});if(m(!1),d.success&&d.data){const g=d.data.slots.filter(p=>p.available).map(p=>p.datetime.slice(11,16));n(g)}else h.error(d.error||"Erro ao buscar horários")}y()},[s,r,t]),!r||!s?null:i?e.jsx("div",{className:"text-sm text-gray-500",children:"Carregando horários..."}):o.length?e.jsx("div",{className:"grid grid-cols-3 md:grid-cols-6 gap-2",children:o.map(y=>e.jsx("button",{onClick:()=>a(y),className:"px-3 py-2 rounded bg-blue-50 hover:bg-blue-100 text-blue-700 text-sm",children:y},y))}):e.jsx("div",{className:"text-sm text-gray-500",children:"Nenhum horário disponível para a data selecionada."})},ho=()=>{const[s,r]=c.useState([]),[a,t]=c.useState(null),[o,n]=c.useState(!1),[i,m]=c.useState(1),[b,y]=c.useState({medicoId:"",data:"",horario:"",tipoConsulta:"primeira-vez",motivoConsulta:"",observacoes:""}),d=je();c.useEffect(()=>{const x=localStorage.getItem("pacienteLogado");if(!x){console.log("[AgendamentoPaciente] Paciente não logado, redirecionando..."),d("/paciente");return}try{const v=JSON.parse(x);console.log("[AgendamentoPaciente] Paciente logado:",v),t(v),g()}catch(v){console.error("[AgendamentoPaciente] Erro ao carregar dados do paciente:",v),d("/paciente")}},[d]);const g=async()=>{try{console.log("[AgendamentoPaciente] Iniciando busca de médicos...");const v=(await fe(async()=>{const{default:O}=await Promise.resolve().then(()=>Ke);return{default:O}},void 0)).default.getAccessToken();console.log("[AgendamentoPaciente] Token disponível:",v?"SIM":"NÃO"),v||console.warn("[AgendamentoPaciente] Nenhum token encontrado - requisição pode falhar");const $=await Ae.listarMedicos({status:"ativo"});if(console.log("[AgendamentoPaciente] Resposta da API:",$),!$.success){console.error("[AgendamentoPaciente] Erro na resposta:",$.error),h.error($.error||"Erro ao carregar médicos");return}const Z=$.data?.data||[];console.log("[AgendamentoPaciente] Médicos recebidos:",Z.length,Z);const _=Z.map(O=>({_id:O.id||Math.random().toString(36).slice(2,9),nome:O.nome||"",especialidade:O.especialidade||"",valorConsulta:0,horarioAtendimento:{}}));console.log("[AgendamentoPaciente] Médicos mapeados:",_),r(_),_.length===0&&($.error&&$.error.includes("404")?h.error("⚠️ Tabela de médicos não existe no banco de dados. Configure o Supabase primeiro.",{duration:6e3}):h.error("Nenhum médico ativo encontrado. Por favor, cadastre médicos primeiro."))}catch(x){console.error("[AgendamentoPaciente] Erro ao carregar médicos:",x),h.error("Erro ao carregar lista de médicos")}},p=x=>{y(v=>({...v,medicoId:x,data:"",horario:""}))},E=x=>{y(v=>({...v,data:x,horario:""}))},j=async()=>{if(a)try{n(!0);const x=new Date(`${b.data}T${b.horario}:00.000Z`);await sa.createAppointment({patient_id:a._id,doctor_id:b.medicoId,scheduled_at:x.toISOString(),appointment_type:"presencial",chief_complaint:b.motivoConsulta}),h.success("Consulta agendada com sucesso!"),m(4)}catch(x){console.error("Erro ao agendar consulta:",x),h.error("Erro ao agendar consulta. Tente novamente.")}finally{n(!1)}},C=()=>{y({medicoId:"",data:"",horario:"",tipoConsulta:"primeira-vez",motivoConsulta:"",observacoes:""}),m(1)},S=()=>{localStorage.removeItem("pacienteLogado"),d("/paciente")},k=()=>{const x=[];for(let v=1;v<=7;v++){const $=fs(new Date,v);x.push({valor:ge($,"yyyy-MM-dd"),label:ge($,"EEEE, dd/MM",{locale:Ue})})}return x},N=s.find(x=>x._id===b.medicoId);return a?i===4?e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-8 text-center",children:[e.jsx(Ba,{className:"w-16 h-16 text-green-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Consulta Agendada com Sucesso!"}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-6 mb-6 text-left",children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Detalhes do Agendamento:"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Paciente:"})," ",a.nome]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Médico:"})," ",N?.nome]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Especialidade:"})," ",N?.especialidade]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Data:"})," ",ge(new Date(b.data),"dd/MM/yyyy",{locale:Ue})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Horário:"})," ",b.horario]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Tipo:"})," ",b.tipoConsulta]}),b.motivoConsulta&&e.jsxs("p",{children:[e.jsx("strong",{children:"Motivo:"})," ",b.motivoConsulta]})]})]}),e.jsx("button",{onClick:C,className:"btn-primary",children:"Fazer Novo Agendamento"})]})}):e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-700 to-blue-500 rounded-xl p-6 mb-8 text-white shadow",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold",children:["Bem-vindo(a), ",a.nome,"!"]}),e.jsx("p",{className:"opacity-90",children:"Agende sua consulta médica"})]}),e.jsxs("button",{onClick:S,className:"flex items-center space-x-2 bg-white/20 hover:bg-white/30 px-4 py-2 rounded-lg transition-colors focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-white/70",children:[e.jsx(Ca,{className:"w-4 h-4"}),e.jsx("span",{children:"Sair"})]})]})}),e.jsx("div",{className:"flex items-center justify-center mb-8",children:[1,2,3].map(x=>e.jsxs(za.Fragment,{children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${i>=x?"bg-blue-600 text-white":"bg-gray-300 text-gray-600"}`,children:x}),x<3&&e.jsx("div",{className:`w-16 h-1 ${i>x?"bg-blue-600":"bg-gray-300"}`})]},x))}),e.jsxs("div",{className:"bg-white rounded-xl shadow border border-gray-200 p-6",children:[i===1&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h2",{className:"text-xl font-semibold flex items-center",children:[e.jsx(ia,{className:"w-5 h-5 mr-2"}),"Selecione o Médico"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Médico/Especialidade"}),e.jsxs("select",{value:b.medicoId,onChange:x=>p(x.target.value),className:"form-input",required:!0,children:[e.jsx("option",{value:"",children:"Selecione um médico"}),s.map(x=>e.jsxs("option",{value:x._id,children:[x.nome," - ",x.especialidade," (R$"," ",x.valorConsulta,")"]},x._id))]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:()=>m(2),disabled:!b.medicoId,className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:"Próximo"})})]}),i===2&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h2",{className:"text-xl font-semibold flex items-center",children:[e.jsx(ve,{className:"w-5 h-5 mr-2"}),"Selecione Data e Horário"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data da Consulta"}),e.jsxs("select",{value:b.data,onChange:x=>E(x.target.value),className:"form-input",required:!0,children:[e.jsx("option",{value:"",children:"Selecione uma data"}),k().map(x=>e.jsx("option",{value:x.valor,children:x.label},x.valor))]})]}),b.data&&b.medicoId&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Horários Disponíveis"}),e.jsx(_s,{doctorId:b.medicoId,date:b.data,onSelect:x=>y(v=>({...v,horario:x}))})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("button",{onClick:()=>m(1),className:"btn-secondary focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-gray-300",children:"Voltar"}),e.jsx("button",{onClick:()=>m(3),disabled:!b.horario,className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-blue-500",children:"Próximo"})]})]}),i===3&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h2",{className:"text-xl font-semibold flex items-center",children:[e.jsx(ua,{className:"w-5 h-5 mr-2"}),"Informações da Consulta"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tipo de Consulta"}),e.jsxs("select",{value:b.tipoConsulta,onChange:x=>y(v=>({...v,tipoConsulta:x.target.value})),className:"form-input",children:[e.jsx("option",{value:"primeira-vez",children:"Primeira Consulta"}),e.jsx("option",{value:"retorno",children:"Retorno"}),e.jsx("option",{value:"urgencia",children:"Urgência"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Motivo da Consulta"}),e.jsx("textarea",{value:b.motivoConsulta,onChange:x=>y(v=>({...v,motivoConsulta:x.target.value})),className:"form-input",rows:3,placeholder:"Descreva brevemente o motivo da consulta"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Observações (opcional)"}),e.jsx("textarea",{value:b.observacoes,onChange:x=>y(v=>({...v,observacoes:x.target.value})),className:"form-input",rows:2,placeholder:"Informações adicionais relevantes"})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Resumo do Agendamento:"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Paciente:"})," ",a.nome]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Médico:"})," ",N?.nome]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Data:"})," ",ge(new Date(b.data),"dd/MM/yyyy",{locale:Ue})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Horário:"})," ",b.horario]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Valor:"})," R$ ",N?.valorConsulta]})]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("button",{onClick:()=>m(2),className:"btn-secondary focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-gray-300",children:"Voltar"}),e.jsx("button",{onClick:j,disabled:o,className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-blue-500",children:o?"Agendando...":"Confirmar Agendamento"})]})]})]})]}):e.jsx("div",{className:"flex justify-center items-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})},Re="consultasLocais";class po{getConsultas(r){try{const a=localStorage.getItem(Re);return a?JSON.parse(a).filter(o=>o.pacienteId===r):[]}catch(a){return console.error("Erro ao carregar consultas locais:",a),[]}}saveConsulta(r){try{const a=localStorage.getItem(Re),t=a?JSON.parse(a):[],o={...r,id:`local_${Date.now()}_${Math.random().toString(36).substr(2,9)}`};return t.push(o),localStorage.setItem(Re,JSON.stringify(t)),o}catch(a){throw console.error("Erro ao salvar consulta local:",a),new Error("Erro ao salvar consulta")}}updateStatus(r,a){try{const t=localStorage.getItem(Re);if(!t)return!1;const o=JSON.parse(t),n=o.findIndex(i=>i.id===r);return n===-1?!1:(o[n].status=a,localStorage.setItem(Re,JSON.stringify(o)),!0)}catch(t){return console.error("Erro ao atualizar status da consulta:",t),!1}}deleteConsulta(r){try{const a=localStorage.getItem(Re);if(!a)return!1;const o=JSON.parse(a).filter(n=>n.id!==r);return localStorage.setItem(Re,JSON.stringify(o)),!0}catch(a){return console.error("Erro ao deletar consulta:",a),!1}}getConsulta(r){try{const a=localStorage.getItem(Re);return a&&JSON.parse(a).find(o=>o.id===r)||null}catch(a){return console.error("Erro ao buscar consulta:",a),null}}clearConsultas(r){try{const a=localStorage.getItem(Re);if(!a)return;const o=JSON.parse(a).filter(n=>n.pacienteId!==r);localStorage.setItem(Re,JSON.stringify(o))}catch(a){console.error("Erro ao limpar consultas:",a)}}}const fr=new po;function fo({medico:s}){const[r,a]=c.useState(null),[t,o]=c.useState(""),[n,i]=c.useState(""),[m,b]=c.useState(!1),y=async()=>{try{if(!s||!r){h.error("Selecione um médico e uma data válida.");return}const d="default",g=ge(r,"yyyy-MM-dd")+"T"+t+":00";fr.saveConsulta({medicoId:s.id,medicoNome:s.nome,especialidade:s.especialidade,dataHora:g,tipo:"presencial",motivo:n.trim(),status:"agendada",valorConsulta:s.valorConsulta||0,pacienteId:d}),await new Promise(p=>setTimeout(p,1500)),h.success("Consulta agendada com sucesso!"),a(null),o(""),i("")}catch(d){console.error("Erro ao agendar consulta:",d),h.error("Erro ao agendar consulta. Tente novamente.")}finally{b(!1)}};return e.jsxs("div",{className:"max-w-4xl mx-auto p-6 space-y-6",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Agendar Consulta"}),s?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{children:"Data:"}),e.jsxs("select",{value:r?.toISOString()||"",onChange:d=>a(d.target.value?new Date(d.target.value):null),children:[e.jsx("option",{value:"",children:"Selecione uma data"}),Array.from({length:30},(d,g)=>{const p=fs(new Date,g+1);return p.getDay()===0?null:e.jsx("option",{value:p.toISOString(),children:p.toLocaleDateString()},p.toISOString())})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{children:"Horário:"}),e.jsx("input",{value:t,onChange:d=>o(d.target.value),placeholder:"Ex: 09:00"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{children:"Motivo:"}),e.jsx("input",{value:n,onChange:d=>i(d.target.value),placeholder:"Motivo da consulta"})]}),e.jsx("button",{onClick:y,disabled:m,className:"bg-blue-600 text-white px-4 py-2 rounded",children:"Agendar"})]}):e.jsx("div",{className:"text-red-600",children:"Médico não encontrado."})]})}const bo=()=>{const{user:s,roles:r=[],logout:a}=ke(),t=je(),[o,n]=c.useState("dashboard"),[i,m]=c.useState([]),[b,y]=c.useState([]),[d,g]=c.useState(!0),[p,E]=c.useState(""),[j,C]=c.useState(!0),[S,k]=c.useState(""),N=s?.id||"",x=s?.nome||"Paciente";c.useEffect(()=>{const w=s?.role==="paciente"||r.includes("paciente");(!s||!w)&&t("/paciente")},[s,r,t]);const v=c.useCallback(async()=>{if(N){C(!0),g(!0);try{const w=await pr.listarConsultas({paciente_id:N}),V=await Ae.listarMedicos({});V.success&&V.data&&y(V.data.data),g(!1);let G=[];w.success&&w.data&&(G=(Array.isArray(w.data)?w.data:w.data.data||[]).map(he=>({_id:he._id||he.id,pacienteId:he.pacienteId,medicoId:he.medicoId,dataHora:he.dataHora,status:he.status||"agendada",tipoConsulta:he.tipoConsulta||he.tipo||"presencial",motivoConsulta:he.motivoConsulta||he.observacoes||"Consulta médica",observacoes:he.observacoes,resultados:he.resultados,prescricoes:he.prescricoes,proximaConsulta:he.proximaConsulta})));const de=fr.getConsultas(N).map(ie=>({_id:ie.id,pacienteId:ie.pacienteId,medicoId:ie.medicoId,dataHora:ie.dataHora,status:ie.status,tipoConsulta:ie.tipo,motivoConsulta:ie.motivo,observacoes:ie.motivo,medicoNome:ie.medicoNome,especialidade:ie.especialidade,valorConsulta:ie.valorConsulta})),we=[...G,...de];m(we)}catch(w){g(!1),console.error("Erro ao carregar consultas:",w),h.error("Erro ao carregar consultas");try{const G=fr.getConsultas(N).map(R=>({_id:R.id,pacienteId:R.pacienteId,medicoId:R.medicoId,dataHora:R.dataHora,status:R.status,tipoConsulta:R.tipo,motivoConsulta:R.motivo,observacoes:R.motivo,medicoNome:R.medicoNome,especialidade:R.especialidade,valorConsulta:R.valorConsulta}));m(G)}catch(V){console.error("Erro ao carregar consultas locais:",V),m([])}}finally{C(!1)}}},[N]);c.useEffect(()=>{v()},[v]),c.useEffect(()=>{o==="appointments"&&v()},[o,v]);const $=w=>b.find(G=>G._id===w||G.id===w)?.nome||"Médico",Z=w=>b.find(G=>G._id===w||G.id===w)?.especialidade||"Especialidade",_=()=>{n("book"),h.success("Selecione um novo horário para remarcar sua consulta")},O=async w=>{if(window.confirm("Tem certeza que deseja cancelar esta consulta?"))try{await pr.atualizarConsulta(w,{status:"cancelada"}),h.success("Consulta cancelada com sucesso"),v()}catch(V){console.error("Erro ao cancelar consulta:",V),h.error("Erro ao cancelar consulta. Tente novamente.")}},H=i.filter(w=>w.status==="agendada"||w.status==="confirmada").sort((w,V)=>new Date(w.dataHora).getTime()-new Date(V.dataHora).getTime()).slice(0,3),A=i.filter(w=>w.status==="realizada").sort((w,V)=>new Date(V.dataHora).getTime()-new Date(w.dataHora).getTime()).slice(0,5),X=w=>{switch(w){case"confirmada":return"bg-green-100 text-green-800 border-green-200 dark:bg-green-900/30 dark:text-green-300 dark:border-green-800";case"agendada":return"bg-blue-100 text-blue-800 border-blue-200 dark:bg-blue-900/30 dark:text-blue-300 dark:border-blue-800";case"realizada":return"bg-gray-100 text-gray-800 border-gray-200 dark:bg-gray-900/30 dark:text-gray-300 dark:border-gray-800";case"cancelada":case"faltou":return"bg-red-100 text-red-800 border-red-200 dark:bg-red-900/30 dark:text-red-300 dark:border-red-800";default:return"bg-gray-100 text-gray-800 border-gray-200 dark:bg-gray-900/30 dark:text-gray-300 dark:border-gray-800"}},ae=w=>{switch(w){case"confirmada":return"Confirmada";case"agendada":return"Agendada";case"realizada":return"Concluída";case"cancelada":return"Cancelada";case"faltou":return"Não Compareceu";default:return w}},se=w=>{switch(w){case"confirmada":return e.jsx(Ba,{className:"h-4 w-4"});case"agendada":return e.jsx(Pe,{className:"h-4 w-4"});case"cancelada":case"faltou":return e.jsx(mr,{className:"h-4 w-4"});default:return e.jsx(Pa,{className:"h-4 w-4"})}},oe=[{id:"dashboard",label:"Início",icon:us},{id:"appointments",label:"Minhas Consultas",icon:ve},{id:"book",label:"Agendar Consulta",icon:Ge},{id:"messages",label:"Mensagens",icon:Ha},{id:"help",label:"Ajuda",icon:ur},{id:"profile",label:"Meu Perfil",icon:ia}],le=()=>e.jsxs("div",{className:"w-64 h-screen bg-white dark:bg-slate-900 border-r border-gray-200 dark:border-slate-700 flex flex-col",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-slate-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-gradient-to-br from-blue-700 to-blue-400 flex items-center justify-center text-white font-semibold text-lg",children:x.split(" ").map(w=>w[0]).join("").toUpperCase().slice(0,2)}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:x}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Paciente"})]})]})}),e.jsx("nav",{className:"flex-1 p-4",children:e.jsx("div",{className:"space-y-1",children:oe.map(w=>{const V=w.icon,G=o===w.id;return e.jsxs("button",{onClick:()=>{w.id==="help"?t("/ajuda"):n(w.id)},className:`w-full flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 ${G?"bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-slate-800"}`,children:[e.jsx(V,{className:"h-5 w-5"}),w.label]},w.id)})})}),e.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-slate-700",children:e.jsxs("button",{onClick:()=>{a(),t("/paciente")},className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-red-500 focus-visible:ring-offset-2",children:[e.jsx(Ca,{className:"h-5 w-5"}),"Sair"]})})]}),te=(w,V,G,R)=>{const de=G;return e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-lg border border-gray-200 dark:border-slate-700 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:w}),e.jsx(de,{className:"h-5 w-5 text-gray-400 dark:text-gray-500"})]}),e.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-1",children:V}),R&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:R})]})},re=(w,V=!1)=>{const G=w.medicoNome||$(w.medicoId),R=w.especialidade||Z(w.medicoId);return e.jsxs("div",{className:"flex items-start gap-4 p-4 rounded-lg border border-gray-200 dark:border-slate-700 hover:bg-gray-50 dark:hover:bg-slate-800/50 transition-colors",children:[e.jsx("div",{className:"h-14 w-14 rounded-full bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center text-white font-semibold",children:G.split(" ").map(de=>de[0]).join("").toUpperCase().slice(0,2)}),e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:G}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:R})]}),e.jsxs("div",{className:`flex items-center gap-1 px-2 py-1 rounded-md text-xs font-medium border ${X(w.status)}`,children:[se(w.status),ae(w.status)]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ve,{className:"h-4 w-4"}),e.jsx("span",{children:ge(new Date(w.dataHora),"dd/MM/yyyy",{locale:Ue})})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Pe,{className:"h-4 w-4"}),e.jsx("span",{children:ge(new Date(w.dataHora),"HH:mm",{locale:Ue})})]}),e.jsx("div",{className:"flex items-center gap-1",children:w.tipoConsulta==="online"||w.tipoConsulta==="telemedicina"?e.jsxs(e.Fragment,{children:[e.jsx(ca,{className:"h-4 w-4"}),e.jsx("span",{children:"Online"})]}):e.jsxs(e.Fragment,{children:[e.jsx(vr,{className:"h-4 w-4"}),e.jsx("span",{children:"Presencial"})]})})]}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Motivo: ",w.motivoConsulta]}),!V&&w.status!=="cancelada"&&e.jsxs("div",{className:"flex gap-2",children:[w.status==="confirmada"&&(w.tipoConsulta==="online"||w.tipoConsulta==="telemedicina")&&e.jsxs("button",{className:"flex items-center gap-1 px-3 py-1 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500",children:[e.jsx(ca,{className:"h-4 w-4"}),"Entrar na Consulta"]}),e.jsx("button",{onClick:_,className:"flex items-center gap-1 px-3 py-1 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-md hover:bg-gray-50 dark:hover:bg-slate-700 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500",children:"Remarcar"}),e.jsxs("button",{onClick:()=>O(w._id),className:"flex items-center gap-1 px-3 py-1 text-sm font-medium text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-md transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-red-500",children:[e.jsx(mr,{className:"h-4 w-4"}),"Cancelar"]})]})]})]},w._id)},W=()=>{const w=H[0];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["Bem-vindo, ",x.split(" ")[0],"!"]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Gerencie suas consultas e cuide da sua saúde"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[te("Próxima Consulta",w?ge(new Date(w.dataHora),"dd MMM",{locale:Ue}):"Nenhuma",ve,w?`${Z(w.medicoId)} - ${ge(new Date(w.dataHora),"HH:mm")}`:"Agende uma consulta"),te("Consultas Agendadas",H.length,Pe,"Este mês"),te("Médicos Favoritos",new Set(i.map(V=>V.medicoId)).size,Ge,"Salvos")]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-lg border border-gray-200 dark:border-slate-700",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-slate-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Próximas Consultas"}),e.jsx("button",{onClick:()=>n("appointments"),className:"text-sm text-blue-600 dark:text-blue-400 hover:underline focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 rounded px-2 py-1",children:"Ver todas"})]})}),e.jsx("div",{className:"p-6",children:j?e.jsx("div",{className:"text-center py-8",children:e.jsx("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-blue-600 border-r-transparent"})}):H.length===0?e.jsx("p",{className:"text-center py-8 text-gray-600 dark:text-gray-400",children:"Nenhuma consulta agendada"}):e.jsx("div",{className:"space-y-4",children:H.map(V=>e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg border border-gray-200 dark:border-slate-700",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center",children:e.jsx(ve,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:$(V.medicoId)}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:Z(V.medicoId)}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:ge(new Date(V.dataHora),"dd/MM/yyyy - HH:mm",{locale:Ue})})]})]},V._id))})})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-lg border border-gray-200 dark:border-slate-700",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-slate-700",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Ações Rápidas"})}),e.jsxs("div",{className:"p-6 space-y-2",children:[e.jsxs("button",{onClick:()=>n("book"),className:"w-full flex items-center gap-3 px-4 py-3 text-left text-gray-900 dark:text-white bg-white dark:bg-slate-800 border border-gray-200 dark:border-slate-700 rounded-lg hover:bg-gray-50 dark:hover:bg-slate-700 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500",children:[e.jsx(ve,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"}),e.jsx("span",{children:"Agendar Nova Consulta"})]}),e.jsxs("button",{onClick:()=>n("messages"),className:"w-full flex items-center gap-3 px-4 py-3 text-left text-gray-900 dark:text-white bg-white dark:bg-slate-800 border border-gray-200 dark:border-slate-700 rounded-lg hover:bg-gray-50 dark:hover:bg-slate-700 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500",children:[e.jsx(Ha,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"}),e.jsx("span",{children:"Mensagens"})]}),e.jsxs("button",{onClick:()=>n("profile"),className:"w-full flex items-center gap-3 px-4 py-3 text-left text-gray-900 dark:text-white bg-white dark:bg-slate-800 border border-gray-200 dark:border-slate-700 rounded-lg hover:bg-gray-50 dark:hover:bg-slate-700 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500",children:[e.jsx(ia,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"}),e.jsx("span",{children:"Editar Perfil"})]}),e.jsxs("button",{onClick:()=>t("/ajuda"),className:"w-full flex items-center gap-3 px-4 py-3 text-left text-gray-900 dark:text-white bg-white dark:bg-slate-800 border border-gray-200 dark:border-slate-700 rounded-lg hover:bg-gray-50 dark:hover:bg-slate-700 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500",children:[e.jsx(ur,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"}),e.jsx("span",{children:"Central de Ajuda"})]})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-lg border border-gray-200 dark:border-slate-700",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-slate-700",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Dicas de Saúde"})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-4 rounded-lg bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800",children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-1",children:"💧 Hidratação"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Beba pelo menos 2 litros de água por dia para manter seu corpo hidratado"})]}),e.jsxs("div",{className:"p-4 rounded-lg bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800",children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-1",children:"🏃 Exercícios"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"30 minutos de atividade física diária ajudam a prevenir doenças"})]})]})})]})]})},P=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Minhas Consultas"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Visualize e gerencie todas as suas consultas"})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-lg border border-gray-200 dark:border-slate-700",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-slate-700",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Próximas Consultas"})}),e.jsx("div",{className:"p-6",children:j?e.jsx("div",{className:"text-center py-8",children:e.jsx("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-blue-600 border-r-transparent"})}):H.length===0?e.jsx("p",{className:"text-center py-8 text-gray-600 dark:text-gray-400",children:"Nenhuma consulta agendada"}):e.jsx("div",{className:"space-y-4",children:H.map(w=>re(w))})})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-lg border border-gray-200 dark:border-slate-700",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-slate-700",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Histórico"})}),e.jsx("div",{className:"p-6",children:A.length===0?e.jsx("p",{className:"text-center py-8 text-gray-600 dark:text-gray-400",children:"Nenhuma consulta realizada"}):e.jsx("div",{className:"space-y-4",children:A.map(w=>re(w,!0))})})]})]}),q=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Agendar Nova Consulta"}),e.jsx("div",{className:"flex items-center justify-center mb-6",children:e.jsxs("div",{className:"flex gap-8",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"w-8 h-8 flex items-center justify-center rounded-full bg-blue-600 text-white font-bold",children:"1"}),e.jsx("span",{className:"text-xs mt-2",children:"Escolha o médico"})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"w-8 h-8 flex items-center justify-center rounded-full bg-gray-200 text-gray-500 font-bold",children:"2"}),e.jsx("span",{className:"text-xs mt-2",children:"Horário"})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"w-8 h-8 flex items-center justify-center rounded-full bg-gray-200 text-gray-500 font-bold",children:"3"}),e.jsx("span",{className:"text-xs mt-2",children:"Confirmação"})]})]})}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Escolha um Médico"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"mr-2 font-medium",children:"Escolha a especialidade:"}),e.jsxs("select",{className:"border rounded px-2 py-1",value:S,onChange:w=>k(w.target.value),children:[e.jsx("option",{value:"",children:"Selecione..."}),e.jsx("option",{value:"__all__",children:"Todas"}),Array.from(new Set(b.map(w=>w.especialidade).filter(Boolean))).sort().map(w=>e.jsx("option",{value:w,children:w},w))]})]}),d?e.jsx("div",{className:"text-center py-8",children:e.jsx("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-blue-600 border-r-transparent"})}):e.jsx("div",{className:"space-y-4",children:(S==="__all__"?b:S?b.filter(w=>w.especialidade===S):[]).length===0?e.jsx("p",{className:"text-center py-8 text-gray-600 dark:text-gray-400",children:"Nenhum médico disponível"}):(S==="__all__"?b:S?b.filter(w=>w.especialidade===S):[]).map(w=>e.jsxs("div",{className:"flex items-center justify-between bg-white dark:bg-slate-800 border border-gray-200 dark:border-slate-700 rounded-lg px-6 py-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsx(Ge,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900 dark:text-white",children:w.nome}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:w.especialidade}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["CRM/SP ",w.crm]})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"text-green-600 font-bold text-lg",children:["R$ ",w.valorConsulta]}),e.jsx("button",{className:`px-6 py-2 rounded-lg bg-blue-600 text-white font-semibold hover:bg-blue-700 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 ${p===(w.id||w._id)?"ring-2 ring-blue-500":""}`,onClick:()=>E(w.id||w._id||""),children:"Selecionar"})]})]},w.id||w._id))}),p&&(()=>{const w=b.find(G=>G.id===p||G._id===p),V=w?{id:w.id||w._id||"",nome:w.nome,especialidade:w.especialidade,crm:w.crm||"",valorConsulta:w.valorConsulta||w.valor_consulta||0}:null;return e.jsx(fo,{medico:V})})()]}),D=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Mensagens"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Converse com seus médicos"})]}),e.jsx("div",{className:"bg-white dark:bg-slate-900 rounded-lg border border-gray-200 dark:border-slate-700 p-6",children:e.jsx("p",{className:"text-center py-16 text-gray-600 dark:text-gray-400",children:"Sistema de mensagens em desenvolvimento"})})]}),I=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Central de Ajuda"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Como podemos ajudar você?"})]}),e.jsx("div",{className:"bg-white dark:bg-slate-900 rounded-lg border border-gray-200 dark:border-slate-700 p-6",children:e.jsx("p",{className:"text-center py-16 text-gray-600 dark:text-gray-400",children:"Central de ajuda em desenvolvimento"})})]}),K=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Meu Perfil"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Gerencie suas informações pessoais"})]}),e.jsx("div",{className:"bg-white dark:bg-slate-900 rounded-lg border border-gray-200 dark:border-slate-700 p-6",children:e.jsx("p",{className:"text-center py-16 text-gray-600 dark:text-gray-400",children:"Edição de perfil em desenvolvimento"})})]}),ee=()=>{switch(o){case"dashboard":return W();case"appointments":return P();case"book":return q();case"messages":return D();case"help":return I();case"profile":return K();default:return null}};return s?e.jsxs("div",{className:"flex h-screen bg-gray-50 dark:bg-slate-950",children:[le(),e.jsx("main",{className:"flex-1 overflow-y-auto",children:e.jsx("div",{className:"container mx-auto p-8",children:ee()})})]}):e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Acesso Negado"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"Você precisa estar logado para acessar esta página."}),e.jsx("button",{onClick:()=>t("/paciente"),className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 transition-colors",children:"Fazer Login"})]})})};class yo{async createUser(r){try{console.log("[userService] Criando usuário:",{email:r.email,full_name:r.full_name,role:r.role});const a=await ne.post("/functions/v1/create-user",r);return console.log("[userService] Resposta:",a.data),a.data.success&&a.data.user?{success:!0,data:a.data.user}:{success:!1,error:"Falha ao criar usuário"}}catch(a){console.error("[userService] Erro ao criar usuário:",a);const t=a;return{success:!1,error:t?.response?.data?.error||t?.response?.data?.message||t?.message||"Erro ao criar usuário"}}}async createMedico(r){return this.createUser({email:r.email,password:r.password,full_name:r.nome,phone:r.telefone||null,role:"medico"})}async createSecretaria(r){return this.createUser({email:r.email,password:r.password,full_name:r.nome,phone:r.telefone||null,role:"secretaria"})}async createPaciente(r){return this.createUser({email:r.email,password:r.password,full_name:r.nome,phone:r.telefone||null,role:"user"})}async signupPaciente(r){try{console.log("[userService] Cadastro público de paciente:",{email:r.email,nome:r.nome});const a=await ne.post("/auth/v1/signup",{email:r.email,password:r.password,data:{full_name:r.nome,phone:r.telefone,cpf:r.cpf,data_nascimento:r.dataNascimento,endereco:r.endereco,role:"paciente"}});return console.log("[userService] Paciente cadastrado via signup:",a.data),{success:!0,data:a.data}}catch(a){console.error("[userService] Erro no signup de paciente:",a);const t=a;return{success:!1,error:t?.response?.data?.error_description||t?.response?.data?.error||t?.response?.data?.message||t?.message||"Erro ao cadastrar paciente"}}}}const ar=new yo,vo=()=>{const[s,r]=c.useState([]),[a,t]=c.useState(!0),[o,n]=c.useState(""),[i,m]=c.useState(!1),[b,y]=c.useState(null),[d,g]=c.useState({nome:"",cpf:"",telefone:"",email:"",dataNascimento:"",altura:"",peso:"",endereco:{rua:"",numero:"",bairro:"",cidade:"",cep:""},convenio:"",numeroCarteirinha:"",observacoes:""}),p=async()=>{try{t(!0);const x=await Xe();r(x.data.map(v=>({_id:v.id,nome:v.nome,cpf:v.cpf,telefone:v.telefone,email:v.email,dataNascimento:v.dataNascimento,altura:v.alturaM?Math.round(v.alturaM*100):void 0,peso:v.pesoKg,endereco:{rua:v.endereco?.rua,numero:v.endereco?.numero,bairro:v.endereco?.bairro,cidade:v.endereco?.cidade,cep:v.endereco?.cep},convenio:v.convenio,numeroCarteirinha:v.numeroCarteirinha,observacoes:v.observacoes||void 0,criadoEm:v.created_at})))}catch(x){console.error("Erro ao carregar pacientes:",x),h.error("Erro ao carregar lista de pacientes")}finally{t(!1)}};c.useEffect(()=>{p()},[]);const E=(x,v)=>{if(!x||!v)return null;const $=x/100;return(v/($*$)).toFixed(1)},j=x=>x<18.5?{status:"Abaixo do peso",color:"text-blue-600"}:x<25?{status:"Peso normal",color:"text-green-600"}:x<30?{status:"Sobrepeso",color:"text-yellow-600"}:{status:"Obesidade",color:"text-red-600"},C=async x=>{x.preventDefault();try{t(!0);const v={...d,altura:d.altura?parseFloat(d.altura):void 0,peso:d.peso?parseFloat(d.peso):void 0,ativo:!0,criadoPor:"secretaria",criadoEm:new Date().toISOString(),atualizadoEm:new Date().toISOString()};if(b?(await Ma(b._id,v),h.success("Paciente atualizado com sucesso!")):(await Da(v),h.success("Paciente cadastrado com sucesso!")),!b&&d.email&&d.nome)try{const $=Math.random().toString(36).slice(-10)+"!A1",Z=await ar.createSecretaria({nome:d.nome,email:d.email,password:$,telefone:d.telefone});Z.success?(h.success("Secretária criada (fluxo real). Senha temporária gerada."),console.info("[CadastroSecretaria] Secretária criada: ",Z.data?.id)):h.error("Falha ao criar secretária (fluxo real): "+(Z.error||"erro desconhecido"))}catch($){console.warn("Falha inesperada ao criar secretária:",$),h.error("Erro inesperado ao criar secretária")}y(null),m(!1)}catch(v){console.error("Erro ao salvar paciente:",v),h.error("Erro ao salvar paciente. Tente novamente.")}finally{t(!1)}},S=x=>{g({nome:x.nome||"",cpf:x.cpf||"",telefone:x.telefone||"",email:x.email||"",dataNascimento:x.dataNascimento?x.dataNascimento.split("T")[0]:"",altura:x.altura?.toString()||"",peso:x.peso?.toString()||"",endereco:{rua:x.endereco?.rua||"",numero:x.endereco?.numero||"",bairro:x.endereco?.bairro||"",cidade:x.endereco?.cidade||"",cep:x.endereco?.cep||""},convenio:x.convenio||"",numeroCarteirinha:x.numeroCarteirinha||"",observacoes:x.observacoes||""}),y(x),m(!0)},k=async x=>{if(window.confirm("Tem certeza que deseja excluir este paciente?"))try{await Ta(x),h.success("Paciente removido com sucesso!"),p()}catch(v){console.error("Erro ao remover paciente:",v),h.error("Erro ao remover paciente")}},N=s.filter(x=>(x.nome||"").toLowerCase().includes(o.toLowerCase())||(x.cpf||"").includes(o)||(x.telefone||"").includes(o));return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Cadastro de Pacientes"}),e.jsx("p",{className:"text-gray-600",children:"Gerencie o cadastro de pacientes da clínica"})]}),e.jsxs("button",{onClick:()=>m(!0),className:"btn-primary mt-4 md:mt-0 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-blue-500",children:[e.jsx(Sa,{className:"w-5 h-5 mr-2"}),"Novo Paciente"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-gradient-to-l from-blue-700 to-blue-400 rounded-full",children:e.jsx(la,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total de Pacientes"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:s.length})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-full",children:e.jsx(ua,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Com Convênio"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:s.filter(x=>x.convenio&&x.convenio!=="Particular").length})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-full",children:e.jsx(Sa,{className:"w-6 h-6 text-purple-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Cadastros Hoje"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:s.filter(x=>{const v=new Date().toISOString().split("T")[0];return x.criadoEm?.startsWith(v)}).length})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-orange-100 rounded-full",children:e.jsx(ms,{className:"w-6 h-6 text-orange-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Com Dados Físicos"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:s.filter(x=>x.altura&&x.peso).length})]})]})})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:e.jsxs("div",{className:"relative",children:[e.jsx(ra,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Buscar por nome, CPF ou telefone...",value:o,onChange:x=>n(x.target.value),className:"pl-10 form-input"})]})}),a?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"sticky top-0 z-10 bg-gradient-to-l from-blue-700 to-blue-400",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Paciente"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Contato"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Dados Físicos"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Convênio"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Ações"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:N.map(x=>{const v=E(x.altura,x.peso),$=v?j(parseFloat(v)):null;return e.jsxs("tr",{className:"odd:bg-white even:bg-gray-50 hover:bg-gray-100",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:x.nome||"Nome não informado"}),e.jsxs("div",{className:"text-sm text-gray-500",children:["CPF: ",x.cpf||"Não informado"]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Nascimento:"," ",x.dataNascimento?ge(new Date(x.dataNascimento),"dd/MM/yyyy"):"Não informado"]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-900",children:[e.jsx(Ka,{className:"w-4 h-4 mr-2 text-gray-400"}),x.telefone||"Não informado"]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-900",children:[e.jsx(da,{className:"w-4 h-4 mr-2 text-gray-400"}),x.email||"Não informado"]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[e.jsx(vr,{className:"w-4 h-4 mr-2 text-gray-400"}),x.endereco?.cidade||"Cidade não informada"]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"space-y-1",children:[x.altura&&e.jsxs("div",{className:"text-sm text-gray-900",children:["Altura: ",x.altura," cm"]}),x.peso&&e.jsxs("div",{className:"text-sm text-gray-900",children:["Peso: ",x.peso," kg"]}),v&&$&&e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"IMC: "}),e.jsxs("span",{className:`font-medium ${$.color}`,children:[v," (",$.status,")"]})]}),!x.altura&&!x.peso&&e.jsx("div",{className:"text-sm text-gray-400",children:"Dados não informados"})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-900",children:x.convenio||"Não informado"}),x.numeroCarteirinha&&e.jsxs("div",{className:"text-sm text-gray-500",children:["Carteirinha: ",x.numeroCarteirinha]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>S(x),className:"inline-flex items-center p-1.5 rounded-lg text-blue-600 hover:text-blue-900 hover:bg-blue-50 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-blue-500","aria-label":"Editar paciente",children:e.jsx(ka,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>k(x._id),className:"inline-flex items-center p-1.5 rounded-lg text-red-600 hover:text-red-900 hover:bg-red-50 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-red-500","aria-label":"Excluir paciente",children:e.jsx(Ye,{className:"w-4 h-4"})})]})})]},x._id)})})]})})}),i&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",role:"dialog","aria-modal":"true","aria-labelledby":"cadastro-secretaria-title",children:e.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{id:"cadastro-secretaria-title",className:"text-lg font-semibold mb-6",children:b?"Editar Paciente":"Novo Paciente"}),e.jsxs("form",{onSubmit:C,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome Completo"}),e.jsx("input",{type:"text",value:d.nome,onChange:x=>g({...d,nome:x.target.value}),className:"form-input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"CPF"}),e.jsx("input",{type:"text",value:d.cpf,onChange:x=>{let v=x.target.value.replace(/\D/g,"");v.length>11&&(v=v.slice(0,11)),v=v.replace(/(\d{3})(\d)/,"$1.$2"),v=v.replace(/(\d{3})(\d)/,"$1.$2"),v=v.replace(/(\d{3})(\d{1,2})$/,"$1-$2"),g({...d,cpf:v})},className:"form-input",placeholder:"000.000.000-00",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Telefone"}),e.jsx("input",{type:"tel",value:d.telefone,onChange:x=>{let v=x.target.value.replace(/\D/g,"");v.length>13&&(v=v.slice(0,13)),v.length>=2&&(v="+55 "+v),v.length>=4&&(v=v.replace(/(\+55 )(\d{2})(\d)/,"$1$2 $3")),v.length>=9&&(v=v.replace(/(\+55 \d{2} )(\d{5})(\d{4})/,"$1$2-$3")),g({...d,telefone:v})},className:"form-input",placeholder:"+55 XX XXXXX-XXXX",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),e.jsx("input",{type:"email",value:d.email,onChange:x=>g({...d,email:x.target.value}),className:"form-input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data de Nascimento"}),e.jsx("input",{type:"date",value:d.dataNascimento,onChange:x=>g({...d,dataNascimento:x.target.value}),className:"form-input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Altura (cm)"}),e.jsx("input",{type:"number",min:"50",max:"250",step:"0.1",value:d.altura,onChange:x=>g({...d,altura:x.target.value}),className:"form-input",placeholder:"Ex: 170"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Peso (kg)"}),e.jsx("input",{type:"number",min:"10",max:"300",step:"0.1",value:d.peso,onChange:x=>g({...d,peso:x.target.value}),className:"form-input",placeholder:"Ex: 70.5"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"CEP"}),e.jsx("input",{type:"text",value:d.endereco.cep,onChange:x=>g({...d,endereco:{...d.endereco,cep:x.target.value}}),className:"form-input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rua"}),e.jsx("input",{type:"text",value:d.endereco.rua,onChange:x=>g({...d,endereco:{...d.endereco,rua:x.target.value}}),className:"form-input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Número"}),e.jsx("input",{type:"text",value:d.endereco.numero,onChange:x=>g({...d,endereco:{...d.endereco,numero:x.target.value}}),className:"form-input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bairro"}),e.jsx("input",{type:"text",value:d.endereco.bairro,onChange:x=>g({...d,endereco:{...d.endereco,bairro:x.target.value}}),className:"form-input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cidade"}),e.jsx("input",{type:"text",value:d.endereco.cidade,onChange:x=>g({...d,endereco:{...d.endereco,cidade:x.target.value}}),className:"form-input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Convênio"}),e.jsxs("select",{value:d.convenio,onChange:x=>g({...d,convenio:x.target.value}),className:"form-input",children:[e.jsx("option",{value:"",children:"Selecione"}),e.jsx("option",{value:"Particular",children:"Particular"}),e.jsx("option",{value:"Unimed",children:"Unimed"}),e.jsx("option",{value:"SulAmérica",children:"SulAmérica"}),e.jsx("option",{value:"Bradesco Saúde",children:"Bradesco Saúde"}),e.jsx("option",{value:"Amil",children:"Amil"}),e.jsx("option",{value:"NotreDame",children:"NotreDame"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Número da Carteirinha"}),e.jsx("input",{type:"text",value:d.numeroCarteirinha,onChange:x=>g({...d,numeroCarteirinha:x.target.value}),className:"form-input"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Observações"}),e.jsx("textarea",{value:d.observacoes,onChange:x=>g({...d,observacoes:x.target.value}),className:"form-input",rows:3})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",className:"btn-secondary focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-gray-300",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:a,className:"btn-primary disabled:opacity-50 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-blue-500",children:a?"Salvando...":b?"Atualizar":"Cadastrar"})]})]})]})})})]})},jo=()=>{const[s,r]=c.useState({nome:"",email:"",senha:"",confirmarSenha:"",especialidade:"",crm:"",telefone:""}),[a,t]=c.useState(!1),o=je(),n=async i=>{if(i.preventDefault(),!s.nome.trim()){h.error("Informe o nome completo");return}if(!s.crm.trim()||s.crm.trim().length<4){h.error("CRM inválido");return}if(!s.especialidade.trim()){h.error("Informe a especialidade");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s.email)){h.error("Email inválido");return}if(!s.telefone.trim()){h.error("Informe o telefone");return}if(s.senha!==s.confirmarSenha){h.error("As senhas não coincidem");return}if(s.senha.length<6){h.error("A senha deve ter pelo menos 6 caracteres");return}t(!0);try{const m=await ar.createMedico({nome:s.nome,email:s.email,password:s.senha,telefone:s.telefone});if(!m.success){h.error(m.error||"Erro ao cadastrar médico");return}h.success("Cadastro realizado com sucesso!"),o("/login-medico")}catch{h.error("Erro ao cadastrar médico. Tente novamente.")}finally{t(!1)}};return e.jsxs("div",{className:"relative min-h-screen flex items-center justify-center p-4",children:[e.jsx("div",{className:"fixed inset-0 bg-white dark:bg-black transition-colors pointer-events-none","aria-hidden":"true"}),e.jsxs("div",{className:"relative max-w-md w-full",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"bg-gradient-to-r from-indigo-600 to-indigo-400 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Ge,{className:"w-8 h-8 text-white"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Cadastro de Médico"}),e.jsx("p",{className:"text-gray-600",children:"Preencha os dados para cadastrar um novo médico"})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-lg p-8",children:e.jsxs("form",{onSubmit:n,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome Completo"}),e.jsx("input",{type:"text",value:s.nome,onChange:i=>r(m=>({...m,nome:i.target.value})),className:"form-input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Telefone"}),e.jsx("input",{type:"tel",value:s.telefone,onChange:i=>r(m=>({...m,telefone:i.target.value})),placeholder:"(11) 99999-9999",className:"form-input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"CRM"}),e.jsx("input",{type:"text",value:s.crm,onChange:i=>r(m=>({...m,crm:i.target.value})),className:"form-input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Especialidade"}),e.jsx("input",{type:"text",value:s.especialidade,onChange:i=>r(m=>({...m,especialidade:i.target.value})),className:"form-input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{type:"email",value:s.email,onChange:i=>r(m=>({...m,email:i.target.value})),className:"form-input",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Senha"}),e.jsx("input",{type:"password",value:s.senha,onChange:i=>r(m=>({...m,senha:i.target.value})),className:"form-input",minLength:6,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirmar Senha"}),e.jsx("input",{type:"password",value:s.confirmarSenha,onChange:i=>r(m=>({...m,confirmarSenha:i.target.value})),className:"form-input",required:!0})]})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("button",{type:"button",onClick:()=>o("/login-medico"),className:"flex-1 bg-gray-100 text-gray-700 py-3 px-4 rounded-lg font-medium hover:bg-gray-200 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-400 focus-visible:ring-offset-2",children:"Voltar"}),e.jsx("button",{type:"submit",disabled:a,className:"flex-1 bg-gradient-to-r from-indigo-600 to-indigo-400 text-white py-3 px-4 rounded-lg font-medium hover:from-indigo-700 hover:to-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500 focus-visible:ring-offset-2",children:a?"Cadastrando...":"Cadastrar"})]})]})})]})]})},No={nome:"",email:"",senha:"",confirmarSenha:"",cpf:"",telefone:"",dataNascimento:"",cep:"",rua:"",numero:"",complemento:"",bairro:"",cidade:"",estado:""},wo=()=>{const[s,r]=c.useState(No),[a,t]=c.useState(!1),[o,n]=c.useState(!1),i=je(),m=g=>r(p=>({...p,...g})),b=async()=>{const g=s.cep.replace(/\D/g,"");if(g.length!==8){h.error("CEP inválido");return}try{const p=await _a(g);if(!p){h.error("CEP não encontrado");return}m({rua:p.rua||"",bairro:p.bairro||"",cidade:p.cidade||"",estado:p.estado||""}),n(!0)}catch{h.error("Falha ao buscar CEP")}},y=()=>s.nome.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s.email)?!s.cpf.trim()||s.cpf.replace(/\D/g,"").length<11?(h.error("CPF inválido"),!1):s.telefone.trim()?!s.senha||s.senha.length<6?(h.error("Senha mínima 6 caracteres"),!1):s.senha!==s.confirmarSenha?(h.error("As senhas não coincidem"),!1):!0:(h.error("Telefone é obrigatório"),!1):(h.error("Email inválido"),!1):(h.error("Nome é obrigatório"),!1),d=async g=>{if(g.preventDefault(),!!y()){t(!0);try{console.log("[CadastroPaciente] Iniciando cadastro via API Supabase..."),console.log("[CadastroPaciente] Criando usuário de autenticação...");const p=await ar.signupPaciente({nome:s.nome,email:s.email,password:s.senha,telefone:s.telefone,cpf:s.cpf,dataNascimento:s.dataNascimento,endereco:{cep:s.cep,rua:s.rua,numero:s.numero,complemento:s.complemento,bairro:s.bairro,cidade:s.cidade,estado:s.estado}});if(!p.success){console.error("[CadastroPaciente] Erro no cadastro:",p.error),h.error(p.error||"Erro ao cadastrar paciente");return}const E=p.data?.id;console.log("[CadastroPaciente] Usuário criado com sucesso! ID:",E),console.log("[CadastroPaciente] Criando registro de paciente na API...");const{createPatient:j}=await fe(async()=>{const{createPatient:S}=await Promise.resolve().then(()=>Ya);return{createPatient:S}},void 0),C=await j({nome:s.nome,email:s.email,telefone:s.telefone,cpf:s.cpf,dataNascimento:s.dataNascimento,endereco:{rua:s.rua,numero:s.numero,complemento:s.complemento,bairro:s.bairro,cidade:s.cidade,estado:s.estado,cep:s.cep}});C.success?console.log("[CadastroPaciente] Paciente criado com sucesso!",C.data):(console.error("[CadastroPaciente] Erro ao criar paciente:",C.error),console.log("[CadastroPaciente] Usuário criado mas dados do paciente não foram salvos completamente")),h.success("Paciente cadastrado com sucesso! Faça login para acessar."),i("/paciente")}catch(p){console.error("[CadastroPaciente] Erro inesperado:",p),h.error("Erro inesperado ao cadastrar")}finally{t(!1)}}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-white flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-xl w-full",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-blue-400 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Sa,{className:"w-8 h-8 text-white"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Cadastro de Paciente"}),e.jsx("p",{className:"text-gray-600",children:"Crie sua conta para acessar o acompanhamento e agendamentos."})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-lg p-8",children:e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome Completo"}),e.jsx("input",{type:"text",value:s.nome,onChange:g=>m({nome:g.target.value}),className:"form-input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data de Nascimento"}),e.jsx("input",{type:"date",value:s.dataNascimento,onChange:g=>m({dataNascimento:g.target.value}),className:"form-input"})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"CPF"}),e.jsx("input",{type:"text",value:s.cpf,onChange:g=>m({cpf:g.target.value}),placeholder:"000.000.000-00",className:"form-input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Telefone"}),e.jsx("input",{type:"tel",value:s.telefone,onChange:g=>m({telefone:g.target.value}),placeholder:"(11) 99999-9999",className:"form-input",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{type:"email",value:s.email,onChange:g=>m({email:g.target.value}),className:"form-input",required:!0})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Senha"}),e.jsx("input",{type:"password",value:s.senha,onChange:g=>m({senha:g.target.value}),className:"form-input",minLength:6,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirmar Senha"}),e.jsx("input",{type:"password",value:s.confirmarSenha,onChange:g=>m({confirmarSenha:g.target.value}),className:"form-input",required:!0})]})]}),e.jsxs("div",{className:"pt-2 border-t",children:[e.jsx("h2",{className:"text-sm font-semibold text-gray-600 mb-2",children:"Endereço (opcional)"}),e.jsxs("div",{className:"grid md:grid-cols-6 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"CEP"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:s.cep,onChange:g=>{n(!1),m({cep:g.target.value})},className:"form-input",placeholder:"00000000"}),e.jsx("button",{type:"button",onClick:b,className:"px-3 py-2 text-xs rounded-md bg-blue-100 hover:bg-blue-200 text-blue-700 font-medium focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2",children:"Buscar"})]})]}),e.jsxs("div",{className:"md:col-span-3",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Rua"}),e.jsx("input",{type:"text",value:s.rua,onChange:g=>m({rua:g.target.value}),className:"form-input",disabled:o})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Número"}),e.jsx("input",{type:"text",value:s.numero,onChange:g=>m({numero:g.target.value}),className:"form-input"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Bairro"}),e.jsx("input",{type:"text",value:s.bairro,onChange:g=>m({bairro:g.target.value}),className:"form-input",disabled:o})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Cidade"}),e.jsx("input",{type:"text",value:s.cidade,onChange:g=>m({cidade:g.target.value}),className:"form-input",disabled:o})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Estado"}),e.jsx("input",{type:"text",value:s.estado,onChange:g=>m({estado:g.target.value}),className:"form-input",disabled:o})]}),e.jsxs("div",{className:"md:col-span-3",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Complemento"}),e.jsx("input",{type:"text",value:s.complemento,onChange:g=>m({complemento:g.target.value}),className:"form-input"})]})]})]}),e.jsxs("div",{className:"flex gap-4 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>i("/paciente"),className:"flex-1 bg-gray-100 text-gray-700 py-3 px-4 rounded-lg font-medium hover:bg-gray-200 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-400 focus-visible:ring-offset-2",children:"Voltar"}),e.jsx("button",{type:"submit",disabled:a,className:"flex-1 bg-gradient-to-r from-blue-600 to-blue-400 text-white py-3 px-4 rounded-lg font-medium hover:from-blue-700 hover:to-blue-500 disabled:opacity-50 transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2",children:a?"Cadastrando...":"Cadastrar"})]})]})})]})})};class ko{async listarRelatorios(r){try{const a={select:"*"};r?.patient_id&&(a.patient_id=`eq.${r.patient_id}`),r?.status&&(a.status=`eq.${r.status}`);const t=await Q.get(Y.REPORTS,{params:a});return t.success&&t.data?{success:!0,data:Array.isArray(t.data)?t.data:[t.data]}:{success:!1,error:t.error||"Erro ao listar relatórios"}}catch(a){return console.error("Erro ao listar relatórios:",a),{success:!1,error:a instanceof Error?a.message:"Erro desconhecido"}}}async criarRelatorio(r){try{const a=await Q.post(Y.REPORTS,r,{headers:{Prefer:"return=representation"}});return a.success&&a.data?{success:!0,data:Array.isArray(a.data)?a.data[0]:a.data,message:"Relatório criado com sucesso"}:{success:!1,error:a.error||"Erro ao criar relatório"}}catch(a){return console.error("Erro ao criar relatório:",a),{success:!1,error:a instanceof Error?a.message:"Erro desconhecido"}}}async buscarRelatorioPorId(r){try{const a=await Q.get(`${Y.REPORTS}?id=eq.${r}`,{params:{select:"*"}});if(a.success&&a.data){const t=Array.isArray(a.data)?a.data:[a.data];if(t.length>0)return{success:!0,data:t[0]}}return{success:!1,error:"Relatório não encontrado"}}catch(a){return console.error("Erro ao buscar relatório:",a),{success:!1,error:a instanceof Error?a.message:"Erro desconhecido"}}}async atualizarRelatorio(r,a){try{const t=await Q.patch(`${Y.REPORTS}?id=eq.${r}`,a,{headers:{Prefer:"return=representation"}});return t.success&&t.data?{success:!0,data:Array.isArray(t.data)?t.data[0]:t.data,message:"Relatório atualizado com sucesso"}:{success:!1,error:t.error||"Erro ao atualizar relatório"}}catch(t){return console.error("Erro ao atualizar relatório:",t),{success:!1,error:t instanceof Error?t.message:"Erro desconhecido"}}}}const Ua=new ko,Na=[{key:0,label:"Domingo",dbKey:"domingo"},{key:1,label:"Segunda-feira",dbKey:"segunda"},{key:2,label:"Terça-feira",dbKey:"terca"},{key:3,label:"Quarta-feira",dbKey:"quarta"},{key:4,label:"Quinta-feira",dbKey:"quinta"},{key:5,label:"Sexta-feira",dbKey:"sexta"},{key:6,label:"Sábado",dbKey:"sabado"}],Co=()=>{const{user:s}=ke(),r=s?.id||"",[a,t]=c.useState({}),[o,n]=c.useState(!0),[i,m]=c.useState(!1),[b,y]=c.useState("weekly"),[d,g]=c.useState(!1),[p,E]=c.useState(null),[j,C]=c.useState({inicio:"09:00",fim:"10:00"}),[S,k]=c.useState(new Date),[N,x]=c.useState([]),[v,$]=c.useState([]),[Z,_]=c.useState("60"),[O,H]=c.useState("0"),A=za.useCallback(async()=>{try{n(!0);const P=await qe.listAvailability({doctor_id:r});if(P&&P.success&&P.data&&P.data.length>0){const q={};Na.forEach(({key:D,label:I})=>{q[D]={day:I,dayOfWeek:D,enabled:!1,slots:[]}}),P.data.forEach(D=>{const I=Na.find(ee=>ee.dbKey===D.weekday);if(!I)return;const K=I.key;q[K].enabled||(q[K].enabled=!0),q[K].slots.push({id:`${K}-${D.id||Math.random().toString(36).slice(2)}`,dbId:D.id,inicio:D.start_time?.slice(0,5)||"09:00",fim:D.end_time?.slice(0,5)||"17:00",ativo:D.active??!0})}),t(q)}else{const q={};Na.forEach(({key:D,label:I})=>{q[D]={day:I,dayOfWeek:D,enabled:!1,slots:[]}}),t(q)}}catch(P){console.error("Erro ao carregar disponibilidade:",P),h.error("Erro ao carregar disponibilidade")}finally{n(!1)}},[r]),X=za.useCallback(async()=>{try{const P=await na.listExceptions({doctor_id:r});if(P.success&&P.data){$(P.data);const q=P.data.filter(D=>D.kind==="bloqueio"&&D.date).map(D=>new Date(D.date));x(q)}}catch(P){console.error("Erro ao carregar exceções:",P)}},[r]);c.useEffect(()=>{r&&(A(),X())},[r,A,X]);const ae=P=>{t(q=>({...q,[P]:{...q[P],enabled:!q[P].enabled}}))},se=()=>{if(p!==null){const P=`${p}-${Date.now()}`;t(q=>({...q,[p]:{...q[p],slots:[...q[p].slots,{id:P,inicio:j.inicio,fim:j.fim,ativo:!0}]}})),g(!1),C({inicio:"09:00",fim:"10:00"}),E(null)}},oe=async(P,q)=>{const D=a[P]?.slots.find(I=>I.id===q);if(D?.dbId)try{const I=await qe.deleteAvailability(D.dbId);if(I.success)h.success("Horário removido com sucesso");else{h.error(I.error||"Erro ao remover horário");return}}catch(I){console.error("Erro ao remover horário:",I),h.error("Erro ao remover horário");return}t(I=>({...I,[P]:{...I[P],slots:I[P].slots.filter(K=>K.id!==q)}}))},le=(P,q)=>{t(D=>({...D,[P]:{...D[P],slots:D[P].slots.map(I=>I.id===q?{...I,ativo:!I.ativo}:I)}}))},te=P=>{const q=a[P];if(!q.enabled||q.slots.length===0){h.error("Dia não tem horários configurados");return}const D={...a};Object.keys(D).forEach(I=>{const K=Number(I);K!==P&&D[K].enabled&&(D[K].slots=q.slots.map(ee=>({...ee,id:`${K}-${ee.id}`})))}),t(D),h.success("Horários copiados com sucesso!")},re=async()=>{try{if(m(!0),!r){h.error("Médico não autenticado");return}const P=[],q=ee=>{const[w,V]=ee.split(":"),G=Number(w||"0"),R=Number(V||"0");return G*60+R};if(Na.forEach(({key:ee,dbKey:w})=>{const V=a[ee];if(!V||!V.enabled){V?.slots.forEach(G=>{G.dbId&&P.push(qe.deleteAvailability(G.dbId))});return}V.slots.forEach(G=>{const R=G.inicio?G.inicio.length===5?`${G.inicio}:00`:G.inicio:"00:00:00",de=G.fim?G.fim.length===5?`${G.fim}:00`:G.fim:"00:00:00",we=Math.max(1,q(de.slice(0,5))-q(R.slice(0,5))),ie={weekday:w,start_time:R,end_time:de,slot_minutes:we,appointment_type:"presencial",active:!!G.ativo};G.dbId?P.push(qe.updateAvailability(G.dbId,ie)):P.push(qe.createAvailability({doctor_id:r,...ie}))})}),P.length===0){h.error("Nenhuma alteração para salvar");return}const D=await Promise.allSettled(P),I=[];let K=0;D.forEach((ee,w)=>{if(ee.status==="fulfilled"){const V=ee.value;V&&V.success?K++:I.push(`Item ${w}: ${V?.error||V?.message||"Erro"}`)}else I.push(`Item ${w}: ${ee.reason?.message||String(ee.reason)}`)}),I.length>0&&(console.error("Erros ao salvar disponibilidades:",I),h.error(`Algumas disponibilidades não foram salvas (${I.length})`)),K>0&&(h.success(`${K} alteração(ões) salvas com sucesso!`),await A())}catch(P){console.error("Erro ao salvar disponibilidade:",P);const q=P instanceof Error?P.message:"Erro ao salvar disponibilidade";h.error(q)}finally{m(!1)}},W=async()=>{if(!S)return;const P=ge(S,"yyyy-MM-dd"),q=N.some(D=>ge(D,"yyyy-MM-dd")===P);try{if(q){const D=v.find(I=>I.date&&ge(new Date(I.date),"yyyy-MM-dd")===P);D&&D.id&&(await na.deleteException(D.id),x(N.filter(I=>ge(I,"yyyy-MM-dd")!==P)),h.success("Data desbloqueada"))}else(await na.createException({doctor_id:r,date:P,kind:"bloqueio",reason:"Data bloqueada pelo médico"})).success&&(x([...N,S]),h.success("Data bloqueada"));X()}catch(D){console.error("Erro ao alternar bloqueio de data:",D),h.error("Erro ao bloquear/desbloquear data")}};return o?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Gerenciar Disponibilidade"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Configure seus horários de atendimento"})]}),e.jsxs("button",{onClick:re,disabled:i,className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors disabled:opacity-50",children:[e.jsx(nt,{className:"h-4 w-4"}),i?"Salvando...":"Salvar Alterações"]})]}),e.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsx("button",{onClick:()=>y("weekly"),className:`py-4 px-1 border-b-2 font-medium text-sm ${b==="weekly"?"border-indigo-500 text-indigo-600 dark:text-indigo-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Horário Semanal"}),e.jsxs("button",{onClick:()=>y("blocked"),className:`py-4 px-1 border-b-2 font-medium text-sm ${b==="blocked"?"border-indigo-500 text-indigo-600 dark:text-indigo-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:["Datas Bloqueadas (",N.length,")"]}),e.jsx("button",{onClick:()=>y("settings"),className:`py-4 px-1 border-b-2 font-medium text-sm ${b==="settings"?"border-indigo-500 text-indigo-600 dark:text-indigo-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Configurações"})]})}),b==="weekly"&&e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Horários por Dia da Semana"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Defina seus horários de atendimento para cada dia da semana"})]}),Na.map(({key:P,label:q})=>e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",checked:a[P]?.enabled||!1,onChange:()=>ae(P)}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 dark:peer-focus:ring-indigo-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-indigo-600"})]}),e.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:q}),a[P]?.enabled&&e.jsxs("span",{className:"px-2 py-1 bg-indigo-100 dark:bg-indigo-900 text-indigo-600 dark:text-indigo-400 text-xs rounded",children:[a[P]?.slots.length||0," horário(s)"]})]}),a[P]?.enabled&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>te(P),className:"flex items-center gap-1 px-3 py-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[e.jsx(it,{className:"h-4 w-4"}),"Copiar"]}),e.jsxs("button",{onClick:()=>{E(P),g(!0)},className:"flex items-center gap-1 px-3 py-1.5 text-sm bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors",children:[e.jsx(Se,{className:"h-4 w-4"}),"Adicionar Horário"]})]})]}),a[P]?.enabled&&e.jsx("div",{className:"ml-14 space-y-2",children:a[P]?.slots.length===0?e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Nenhum horário configurado"}):a[P]?.slots.map(D=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-700/50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",checked:D.ativo,onChange:()=>le(P,D.id)}),e.jsx("div",{className:"w-9 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 dark:peer-focus:ring-indigo-800 rounded-full peer dark:bg-gray-600 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all dark:border-gray-600 peer-checked:bg-indigo-600"})]}),e.jsx(Pe,{className:"h-4 w-4 text-gray-400"}),e.jsxs("span",{className:"text-gray-900 dark:text-white",children:[D.inicio," - ",D.fim]}),!D.ativo&&e.jsx("span",{className:"px-2 py-1 bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200 text-xs rounded",children:"Bloqueado"})]}),e.jsx("button",{onClick:()=>oe(P,D.id),className:"p-2 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",children:e.jsx(Ye,{className:"h-4 w-4 text-red-600 dark:text-red-400"})})]},D.id))})]},P))]})}),b==="blocked"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Selecionar Datas"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Clique em uma data no calendário e depois no botão para bloquear/desbloquear"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{type:"date",value:S?ge(S,"yyyy-MM-dd"):"",onChange:P=>k(new Date(P.target.value)),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-white"}),e.jsx("button",{onClick:W,disabled:!S,className:"w-full py-2 px-4 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors disabled:opacity-50",children:S&&N.some(P=>ge(P,"yyyy-MM-dd")===ge(S,"yyyy-MM-dd"))?"Desbloquear Data":"Bloquear Data"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Datas Bloqueadas"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:[N.length," data(s) bloqueada(s)"]}),N.length===0?e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center py-8",children:"Nenhuma data bloqueada"}):e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:N.map((P,q)=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsx("span",{className:"text-gray-900 dark:text-white",children:ge(P,"EEEE, dd 'de' MMMM 'de' yyyy",{locale:Ue})}),e.jsx("button",{onClick:()=>{k(P),W()},className:"p-2 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",children:e.jsx(Ye,{className:"h-4 w-4 text-red-600 dark:text-red-400"})})]},q))})]})]}),b==="settings"&&e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Configurações de Consulta"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Defina as configurações padrão para suas consultas"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-900 dark:text-white mb-2",children:"Duração Padrão da Consulta"}),e.jsxs("select",{value:Z,onChange:P=>_(P.target.value),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"30",children:"30 minutos"}),e.jsx("option",{value:"45",children:"45 minutos"}),e.jsx("option",{value:"60",children:"1 hora"}),e.jsx("option",{value:"90",children:"1 hora e 30 minutos"}),e.jsx("option",{value:"120",children:"2 horas"})]}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm mt-1",children:"Esta duração será usada para calcular os horários disponíveis"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-900 dark:text-white mb-2",children:"Intervalo entre Consultas"}),e.jsxs("select",{value:O,onChange:P=>H(P.target.value),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"0",children:"Sem intervalo"}),e.jsx("option",{value:"15",children:"15 minutos"}),e.jsx("option",{value:"30",children:"30 minutos"})]}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm mt-1",children:"Tempo de descanso entre consultas"})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-900 dark:text-white font-medium",children:"Aceitar consultas online"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"Permitir agendamento de teleconsultas"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",defaultChecked:!0}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 dark:peer-focus:ring-indigo-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-indigo-600"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-900 dark:text-white font-medium",children:"Confirmação automática"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"Aprovar agendamentos automaticamente"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 dark:peer-focus:ring-indigo-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-indigo-600"})]})]})]})]})}),d&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Adicionar Horário"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:["Defina o período de atendimento para"," ",p!==null?a[p]?.day:""]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-900 dark:text-white mb-2",children:"Horário de Início"}),e.jsx("input",{type:"time",value:j.inicio,onChange:P=>C({...j,inicio:P.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-900 dark:text-white mb-2",children:"Horário de Término"}),e.jsx("input",{type:"time",value:j.fim,onChange:P=>C({...j,fim:P.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-white"})]})]}),e.jsxs("div",{className:"flex gap-2 mt-6",children:[e.jsx("button",{onClick:()=>{g(!1),E(null)},className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"Cancelar"}),e.jsx("button",{onClick:se,className:"flex-1 px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors",children:"Adicionar"})]})]})})]})},So=["Primeira consulta","Retorno","Acompanhamento","Exame","Telemedicina"],Eo=({isOpen:s,onClose:r,onSaved:a,editing:t,defaultPacienteId:o,defaultMedicoId:n,lockPaciente:i=!1,lockMedico:m=!1})=>{const{user:b}=ke(),[y,d]=c.useState([]),[g,p]=c.useState([]),[E,j]=c.useState(!1),[C,S]=c.useState(""),[k,N]=c.useState(""),[x,v]=c.useState(""),[$,Z]=c.useState(""),[_,O]=c.useState(""),[H,A]=c.useState(""),[X,ae]=c.useState("agendada"),[se,oe]=c.useState(!1),[le,te]=c.useState(null);c.useEffect(()=>{if(!s)return;let D=!0;return(async()=>{try{j(!0);const[I,K]=await Promise.all([Xe().catch(()=>({data:[],total:0,page:1,per_page:0})),Ae.listarMedicos().catch(()=>({success:!1,data:void 0}))]);if(!D)return;d(I.data),K&&K.success&&K.data&&p(K.data.data)}finally{D&&j(!1)}})(),()=>{D=!1}},[s]),c.useEffect(()=>{if(s){if(t){S(t.pacienteId),N(t.medicoId);try{const D=new Date(t.dataHora),I=new Date(D.getTime()-D.getTimezoneOffset()*6e4).toISOString().slice(0,16);v(I)}catch{v("")}Z(t.tipo||""),O(t.motivo||""),A(t.observacoes||""),ae(t.status||"agendada")}else S(o||""),N(n||""),v(""),Z(""),O(""),A(""),ae("agendada");te(null),oe(!1)}},[s,t,o,n,b]);const re=c.useCallback(D=>{D.key==="Escape"&&r()},[r]);if(c.useEffect(()=>{if(s)return window.addEventListener("keydown",re),()=>window.removeEventListener("keydown",re)},[s,re]),!s)return null;const W=()=>C?k?x?!0:(te("Informe data e hora."),!1):(te("Selecione um médico."),!1):(te("Selecione um paciente."),!1),P=async D=>{if(D.preventDefault(),!!W()){oe(!0),te(null);try{const I=new Date(x).toISOString();if(t){const K={dataHora:I,tipo:$||void 0,motivo:_||void 0,observacoes:H||void 0,status:X},ee=await Aa.atualizar(t.id,K);if(!ee.success||!ee.data)throw new Error(ee.error||"Falha ao atualizar consulta");a(ee.data)}else{const K={pacienteId:C,medicoId:k,dataHora:I,tipo:$||void 0,motivo:_||void 0,observacoes:H||void 0},ee=await Aa.criar(K);if(!ee.success||!ee.data)throw new Error(ee.error||"Falha ao criar consulta");a(ee.data)}r()}catch(I){const K=I instanceof Error?I.message:"Erro ao salvar";te(K)}finally{oe(!1)}}},q=t?"Editar Consulta":"Nova Consulta";return e.jsx("div",{className:"fixed inset-0 z-50 flex items-start justify-center bg-black/40 p-4 overflow-y-auto",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-xl animate-fade-in mt-10",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",children:[e.jsx("h2",{className:"text-lg font-semibold",children:q}),e.jsx("button",{onClick:r,className:"text-gray-500 hover:text-gray-700",children:e.jsx(Fe,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:P,className:"p-4 space-y-4",children:[le&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-3 py-2 rounded text-sm",children:le}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Paciente"}),e.jsxs("select",{className:"w-full border rounded px-2 py-2 text-sm",value:C,onChange:D=>S(D.target.value),disabled:i||!!t,children:[e.jsx("option",{value:"",children:"Selecione..."}),y.map(D=>e.jsx("option",{value:D.id,children:D.nome},D.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Médico"}),e.jsxs("select",{className:"w-full border rounded px-2 py-2 text-sm",value:k,onChange:D=>N(D.target.value),disabled:m||!!t,children:[e.jsx("option",{value:"",children:"Selecione..."}),g.map(D=>e.jsxs("option",{value:D.id,children:[D.nome," - ",D.especialidade]},D.id))]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data / Hora"}),e.jsx("input",{type:"datetime-local",className:"w-full border rounded px-2 py-2 text-sm",value:x,onChange:D=>v(D.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo"}),e.jsx("input",{list:"tipos-consulta",className:"w-full border rounded px-2 py-2 text-sm",value:$,onChange:D=>Z(D.target.value),placeholder:"Ex: Retorno"}),e.jsx("datalist",{id:"tipos-consulta",children:So.map(D=>e.jsx("option",{value:D},D))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Motivo"}),e.jsx("input",{className:"w-full border rounded px-2 py-2 text-sm",value:_,onChange:D=>O(D.target.value),placeholder:"Motivo principal"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Observações"}),e.jsx("textarea",{className:"w-full border rounded px-2 py-2 text-sm resize-y min-h-[80px]",value:H,onChange:D=>A(D.target.value),placeholder:"Notas internas, preparação, etc"})]}),t&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{className:"w-full border rounded px-2 py-2 text-sm",value:X,onChange:D=>ae(D.target.value),children:[e.jsx("option",{value:"agendada",children:"Agendada"}),e.jsx("option",{value:"confirmada",children:"Confirmada"}),e.jsx("option",{value:"cancelada",children:"Cancelada"}),e.jsx("option",{value:"realizada",children:"Realizada"}),e.jsx("option",{value:"faltou",children:"Faltou"})]})]})]}),E&&e.jsxs("p",{className:"text-xs text-gray-500 flex items-center",children:[e.jsx(gr,{className:"w-4 h-4 mr-1 animate-spin"})," Carregando listas..."]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2 border-t",children:[e.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-sm rounded border border-gray-300 text-gray-700 hover:bg-gray-50",children:"Cancelar"}),e.jsxs("button",{type:"submit",disabled:se,className:"px-4 py-2 text-sm rounded bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-60 flex items-center",children:[se&&e.jsx(gr,{className:"w-4 h-4 mr-2 animate-spin"})," ",t?"Salvar alterações":"Criar consulta"]})]})]})]})})},_o=()=>{const{user:s,roles:r,logout:a}=ke(),t=je(),o=s&&(s.role==="medico"||r.includes("medico")||r.includes("admin")),n=o?s.id:"",i=s?.nome||"Médico",[m,b]=c.useState(s?.avatar_url||null),[y,d]=c.useState(!1),[g,p]=c.useState(null),E=c.useCallback(()=>{if(!s?.id)return;const M=`https://yuanqfswhberkoevtmfr.supabase.co/storage/v1/object/public/avatars/${s.id}/avatar`;(async()=>{for(const L of["jpg","png","webp"]){const z=`${M}.${L}`;try{if((await fetch(z,{method:"HEAD"})).ok){b(z);return}}catch{}}b(null)})()},[s?.id]);c.useEffect(()=>{E()},[E]);const j=async()=>{if(!g||!s?.id)return;const M=new FormData;M.append("file",g),await fetch(`https://yuanqfswhberkoevtmfr.supabase.co/storage/v1/object/avatars/${s.id}/avatar`,{method:"POST",body:M});const u=g.name.split(".").pop(),L=`https://yuanqfswhberkoevtmfr.supabase.co/storage/v1/object/public/avatars/${s.id}/avatar.${u}`;await fetch(`https://yuanqfswhberkoevtmfr.supabase.co/rest/v1/profiles?id=eq.${s.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({avatar_url:L})}),d(!1),p(null),b(L)},C=async()=>{s?.id&&(await fetch(`https://yuanqfswhberkoevtmfr.supabase.co/storage/v1/object/avatars/${s.id}/avatar`,{method:"DELETE"}),await fetch(`https://yuanqfswhberkoevtmfr.supabase.co/rest/v1/profiles?id=eq.${s.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({avatar_url:null})}),b(null))},[S,k]=c.useState("dashboard"),[N,x]=c.useState([]),[v,$]=c.useState("hoje"),[Z,_]=c.useState(!0),[O,H]=c.useState(!1),[A,X]=c.useState(null),[ae,se]=c.useState(!1),[oe,le]=c.useState(!1),[te,re]=c.useState([]),[W,P]=c.useState({patient_id:"",order_number:"",exam:"",diagnosis:"",conclusion:"",cid_code:"",content_html:"",status:"draft",requested_by:i,due_at:ge(new Date,"yyyy-MM-dd'T'HH:mm"),hide_date:!1,hide_signature:!1});c.useEffect(()=>{n||t("/login-medico")},[n,t]);const q=c.useCallback(async()=>{_(!0);try{let M;if(s?.role==="admin"||r.includes("admin"))M=await Aa.listarTodas();else{if(!n)return;M=await Aa.listarPorMedico(n)}if(M&&M.success&&M.data){const{getPatientById:u}=await fe(async()=>{const{getPatientById:z}=await Promise.resolve().then(()=>Ya);return{getPatientById:z}},void 0),L=await Promise.all(M.data.map(async z=>{let Me="Paciente Desconhecido";try{const Te=await u(z.pacienteId);Te.success&&Te.data&&(Me=Te.data.nome)}catch(Te){console.error("Erro ao buscar nome do paciente:",Te)}return{id:z.id,pacienteId:z.pacienteId,medicoId:z.medicoId,pacienteNome:Me,medicoNome:i,dataHora:z.dataHora,status:z.status,tipo:z.tipo,observacoes:z.observacoes}}));x(L)}else x([])}catch(M){console.error("Erro ao buscar consultas:",M),h.error("Erro ao carregar consultas"),x([])}finally{_(!1)}},[s,r,n,i]);c.useEffect(()=>{q()},[q]),c.useEffect(()=>{ae&&s?.id&&(async()=>{try{const u=await Xe({per_page:200});"data"in u&&re(u.data.map(L=>({id:L.id,nome:L.nome})))}catch(u){console.error("Erro ao carregar pacientes:",u),h.error("Erro ao carregar lista de pacientes")}})()},[ae,s]);const D=async M=>{if(M.preventDefault(),!W.patient_id){h.error("Selecione um paciente");return}if(!W.exam.trim()){h.error("Informe o tipo de exame");return}le(!0);try{const u={patient_id:W.patient_id,order_number:W.order_number||"",exam:W.exam,diagnosis:W.diagnosis||"",conclusion:W.conclusion||"",cid_code:W.cid_code||"",content_html:W.content_html||"",status:W.status,requested_by:W.requested_by||i,due_at:W.due_at||"",hide_date:W.hide_date,hide_signature:W.hide_signature},L=await Ua.criarRelatorio(u);L.success?(h.success("Relatório criado com sucesso!"),se(!1),P({patient_id:"",order_number:"",exam:"",diagnosis:"",conclusion:"",cid_code:"",content_html:"",status:"draft",requested_by:i,due_at:ge(new Date,"yyyy-MM-dd'T'HH:mm"),hide_date:!1,hide_signature:!1})):h.error(L.error||"Erro ao criar relatório")}catch(u){console.error("Erro ao criar relatório:",u),h.error("Erro ao criar relatório")}finally{le(!1)}},I=()=>{X(null),H(!0)},K=M=>{X(M),H(!0)},ee=async M=>{if(window.confirm("Deseja realmente excluir esta consulta?"))try{const u=localStorage.getItem("consultas_local");if(u){const z=JSON.parse(u).filter(Me=>Me.id!==M);localStorage.setItem("consultas_local",JSON.stringify(z)),h.success("Consulta excluída"),q()}}catch(u){console.error("Erro ao excluir consulta:",u),h.error("Erro ao excluir consulta")}},w=()=>{H(!1),X(null),q()},V=M=>{switch(M.toLowerCase()){case"confirmada":case"confirmed":return"bg-green-100 text-green-800 border-green-200 dark:bg-green-900/30 dark:text-green-300 dark:border-green-800";case"agendada":case"scheduled":return"bg-indigo-100 text-indigo-800 border-blue-200 dark:bg-indigo-900/30 dark:text-blue-300 dark:border-indigo-800";case"concluida":case"completed":return"bg-gray-100 text-gray-800 border-gray-200 dark:bg-gray-900/30 dark:text-gray-300 dark:border-gray-800";case"cancelada":case"cancelled":return"bg-red-100 text-red-800 border-red-200 dark:bg-red-900/30 dark:text-red-300 dark:border-red-800";default:return"bg-gray-100 text-gray-800 border-gray-200 dark:bg-gray-900/30 dark:text-gray-300 dark:border-gray-800"}},G=M=>{switch(M.toLowerCase()){case"confirmada":case"confirmed":return"Confirmada";case"agendada":case"scheduled":return"Agendada";case"concluida":case"completed":return"Concluída";case"cancelada":case"cancelled":return"Cancelada";default:return M}},R=M=>{switch(M.toLowerCase()){case"confirmada":case"confirmed":return e.jsx(Ba,{className:"h-4 w-4"});case"agendada":case"scheduled":return e.jsx(Pe,{className:"h-4 w-4"});case"cancelada":case"cancelled":return e.jsx(mr,{className:"h-4 w-4"});default:return e.jsx(Pa,{className:"h-4 w-4"})}},de=N,we=N.filter(M=>M.status.toLowerCase()==="confirmada"||M.status.toLowerCase()==="confirmed"),ie=N.filter(M=>M.status.toLowerCase()==="concluida"||M.status.toLowerCase()==="completed"),he=[{id:"dashboard",label:"Dashboard",icon:us},{id:"appointments",label:"Consultas",icon:Pe},{id:"availability",label:"Disponibilidade",icon:ve},{id:"reports",label:"Relatórios",icon:ua},{id:"help",label:"Ajuda",icon:ur},{id:"settings",label:"Configurações",icon:lt}],Be=()=>e.jsxs("div",{className:"w-64 h-screen bg-white dark:bg-slate-900 border-r border-gray-200 dark:border-slate-700 flex flex-col",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-slate-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative group",children:[m?e.jsx("img",{src:m,alt:"Avatar",className:"h-14 w-14 rounded-full object-cover border shadow"}):e.jsx("div",{className:"h-14 w-14 rounded-full bg-gradient-to-br from-indigo-500 to-indigo-600 flex items-center justify-center text-white font-semibold text-lg shadow",children:i.split(" ").map(M=>M[0]).join("").toUpperCase().slice(0,2)}),e.jsx("button",{type:"button",className:"absolute bottom-0 right-0 bg-white rounded-full p-1 border shadow group-hover:bg-indigo-100 transition",title:"Editar avatar",onClick:()=>d(!0),style:{lineHeight:0},children:e.jsx(gs,{size:16,className:"text-indigo-600"})}),y&&e.jsxs("form",{className:"absolute top-0 left-16 bg-white p-2 rounded shadow z-10 flex flex-col items-center",onSubmit:M=>{M.preventDefault(),j()},children:[e.jsx("input",{type:"file",accept:"image/png,image/jpeg,image/webp",onChange:M=>p(M.target.files?.[0]||null),className:"mb-2"}),e.jsx("button",{type:"submit",className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded",children:"Salvar"}),e.jsx("button",{type:"button",className:"text-xs ml-2",onClick:()=>d(!1),children:"Cancelar"}),m&&e.jsx("button",{type:"button",className:"text-xs text-red-600 underline mt-2",onClick:C,children:"Remover"})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:i}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Médico"})]})]})}),e.jsx("nav",{className:"flex-1 p-4",children:e.jsx("div",{className:"space-y-1",children:he.map(M=>{const u=M.icon,L=S===M.id;return e.jsxs("button",{onClick:()=>{M.id==="help"?t("/ajuda"):k(M.id)},className:`w-full flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500 focus-visible:ring-offset-2 ${L?"bg-indigo-50 dark:bg-indigo-900/20 text-indigo-600 dark:text-indigo-400":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-slate-800"}`,children:[e.jsx(u,{className:"h-5 w-5"}),M.label]},M.id)})})}),e.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-slate-700",children:e.jsxs("button",{onClick:()=>{a(),t("/login-medico")},className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-red-500 focus-visible:ring-offset-2",children:[e.jsx(Ca,{className:"h-5 w-5"}),"Sair"]})})]}),He=(M,u,L,z,Me)=>{const Te=L;return e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-lg border border-gray-200 dark:border-slate-700 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:M}),e.jsx(Te,{className:"h-5 w-5 text-gray-400 dark:text-gray-500"})]}),e.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-1",children:u}),z&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:z}),Me]})},Qe=M=>e.jsxs("div",{className:"flex items-start gap-4 p-4 rounded-lg border border-gray-200 dark:border-slate-700 hover:bg-gray-50 dark:hover:bg-slate-800/50 transition-colors",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-gradient-to-br from-purple-500 to-purple-600 flex items-center justify-center text-white font-semibold",children:M.pacienteNome.split(" ").map(u=>u[0]).join("").toUpperCase().slice(0,2)}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:M.pacienteNome}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:M.observacoes||"Consulta médica"})]}),e.jsxs("div",{className:`flex items-center gap-1 px-2 py-1 rounded-md text-xs font-medium border ${V(M.status)}`,children:[R(M.status),G(M.status)]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Pe,{className:"h-4 w-4"}),e.jsx("span",{children:ge(new Date(M.dataHora),"HH:mm",{locale:Ue})})]}),e.jsx("div",{className:"flex items-center gap-1",children:M.tipo==="online"||M.tipo==="telemedicina"?e.jsxs(e.Fragment,{children:[e.jsx(ca,{className:"h-4 w-4"}),e.jsx("span",{children:"Online"})]}):e.jsxs(e.Fragment,{children:[e.jsx(vr,{className:"h-4 w-4"}),e.jsx("span",{children:"Presencial"})]})})]}),e.jsxs("div",{className:"flex gap-2",children:[M.status.toLowerCase()==="confirmada"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"flex items-center gap-1 px-3 py-1 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-md hover:bg-gray-50 dark:hover:bg-slate-700 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",children:[e.jsx(Ka,{className:"h-4 w-4"}),"Ligar"]}),(M.tipo==="online"||M.tipo==="telemedicina")&&e.jsxs("button",{className:"flex items-center gap-1 px-3 py-1 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",children:[e.jsx(ca,{className:"h-4 w-4"}),"Iniciar Consulta"]})]}),e.jsxs("button",{onClick:()=>K(M),className:"flex items-center gap-1 px-3 py-1 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-slate-700 rounded-md transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",children:[e.jsx(ka,{className:"h-4 w-4"}),"Editar"]}),e.jsxs("button",{onClick:()=>ee(M.id),className:"flex items-center gap-1 px-3 py-1 text-sm font-medium text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-md transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-red-500",children:[e.jsx(Ye,{className:"h-4 w-4"}),"Excluir"]})]})]})]},M.id),ga=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[He("Consultas Hoje",de.length,Pe,`${we.length} confirmadas`),He("Total Consultas",N.length,ve,"Este período"),He("Concluídas",ie.length,Ba,"Este período"),He("Taxa Comparecimento",N.length>0?`${Math.round(ie.length/N.length*100)}%`:"0%",ct,"Baseado em consultas concluídas")]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-lg border border-gray-200 dark:border-slate-700",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-slate-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Consultas de Hoje"}),e.jsxs("button",{onClick:I,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",children:[e.jsx(Se,{className:"h-4 w-4"}),"Nova Consulta"]})]})}),e.jsx("div",{className:"p-6",children:Z?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-indigo-600 border-r-transparent"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:"Carregando consultas..."})]}):de.length===0?e.jsx("p",{className:"text-center py-8 text-gray-600 dark:text-gray-400",children:"Nenhuma consulta agendada para hoje"}):e.jsx("div",{className:"space-y-4",children:de.map(Qe)})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-lg border border-gray-200 dark:border-slate-700",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-slate-700",children:e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Próximos 7 Dias"})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Segunda-feira"}),e.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"0 consultas"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Terça-feira"}),e.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"0 consultas"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Quarta-feira"}),e.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"0 consultas"})]})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-lg border border-gray-200 dark:border-slate-700",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-slate-700",children:e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Tipos de Consulta"})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Presencial"}),e.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:N.filter(M=>M.tipo!=="online"&&M.tipo!=="telemedicina").length})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Online"}),e.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:N.filter(M=>M.tipo==="online"||M.tipo==="telemedicina").length})]})]})})]})]})]}),Ne=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Todas as Consultas"}),e.jsxs("button",{onClick:I,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",children:[e.jsx(Se,{className:"h-4 w-4"}),"Nova Consulta"]})]}),e.jsx("div",{className:"flex gap-2",children:["hoje","amanha","semana","todas"].map(M=>e.jsx("button",{onClick:()=>$(M),className:`px-4 py-2 text-sm font-medium rounded-md transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500 ${v===M?"bg-indigo-600 text-white":"bg-white dark:bg-slate-900 text-gray-700 dark:text-gray-300 border border-gray-200 dark:border-slate-700 hover:bg-gray-50 dark:hover:bg-slate-800"}`,children:M==="hoje"?"Hoje":M==="amanha"?"Amanhã":M==="semana"?"Esta Semana":"Todas"},M))}),e.jsx("div",{className:"bg-white dark:bg-slate-900 rounded-lg border border-gray-200 dark:border-slate-700",children:e.jsx("div",{className:"p-6",children:Z?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-indigo-600 border-r-transparent"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:"Carregando consultas..."})]}):N.length===0?e.jsx("p",{className:"text-center py-8 text-gray-600 dark:text-gray-400",children:"Nenhuma consulta encontrada"}):e.jsx("div",{className:"space-y-4",children:N.map(Qe)})})})]}),De=()=>e.jsx(Co,{}),$e=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Relatórios"}),e.jsxs("button",{onClick:()=>se(!0),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",children:[e.jsx(Se,{className:"h-4 w-4"}),"Novo Relatório"]})]}),e.jsx("div",{className:"bg-white dark:bg-slate-900 rounded-lg border border-gray-200 dark:border-slate-700",children:e.jsx("div",{className:"p-6",children:e.jsx("p",{className:"text-center py-8 text-gray-600 dark:text-gray-400",children:"Funcionalidade em desenvolvimento"})})})]}),Ve=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Configurações"}),e.jsx("div",{className:"bg-white dark:bg-slate-900 rounded-lg border border-gray-200 dark:border-slate-700",children:e.jsx("div",{className:"p-6",children:e.jsx("p",{className:"text-center py-8 text-gray-600 dark:text-gray-400",children:"Funcionalidade em desenvolvimento"})})})]}),Ze=()=>{switch(S){case"dashboard":return ga();case"appointments":return Ne();case"availability":return De();case"reports":return $e();case"settings":return Ve();default:return null}};return o?e.jsxs("div",{className:"flex h-screen bg-gray-50 dark:bg-slate-950",children:[Be(),e.jsx("main",{className:"flex-1 overflow-y-auto",children:e.jsx("div",{className:"container mx-auto p-8",children:Ze()})}),O&&e.jsx(Eo,{isOpen:O,onClose:()=>{H(!1),X(null)},onSaved:w,editing:A,defaultMedicoId:n,lockMedico:!1}),ae&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:()=>se(!1),children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",onClick:M=>M.stopPropagation(),children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-slate-700",children:e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Criar Novo Relatório"})}),e.jsxs("form",{onSubmit:D,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Paciente *"}),e.jsxs("select",{value:W.patient_id,onChange:M=>P(u=>({...u,patient_id:M.target.value})),required:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-slate-600 rounded-md bg-white dark:bg-slate-800 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[e.jsx("option",{value:"",children:"Selecione um paciente"}),te.map(M=>e.jsx("option",{value:M.id,children:M.nome},M.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Tipo de Exame *"}),e.jsx("input",{type:"text",value:W.exam,onChange:M=>P(u=>({...u,exam:M.target.value})),required:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-slate-600 rounded-md bg-white dark:bg-slate-800 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Diagnóstico"}),e.jsx("textarea",{value:W.diagnosis,onChange:M=>P(u=>({...u,diagnosis:M.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-slate-600 rounded-md bg-white dark:bg-slate-800 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Conclusão"}),e.jsx("textarea",{value:W.conclusion,onChange:M=>P(u=>({...u,conclusion:M.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-slate-600 rounded-md bg-white dark:bg-slate-800 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>se(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-md hover:bg-gray-50 dark:hover:bg-slate-700 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:oe,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",children:oe?"Criando...":"Criar Relatório"})]})]})]})})]}):e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Acesso Negado"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"Você não tem permissão para acessar esta página."}),e.jsx("button",{onClick:()=>t("/login-medico"),className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 transition-colors",children:"Fazer Login"})]})})},As=["bg-emerald-600","bg-green-600","bg-sky-600","bg-indigo-600","bg-fuchsia-600","bg-rose-600","bg-amber-600","bg-teal-600"];function Ao(s){let r=0;for(let a=0;a<s.length;a++)r=r*31+s.charCodeAt(a)>>>0;return r%As.length}const Po=({name:s,size:r=40,className:a=""})=>{const t=(s||"?").trim();let n=t.split(/\s+/).filter(Boolean).slice(0,2).map(y=>y[0]?.toUpperCase()).join("");n||(n="?");const i=As[Ao(t)],m={width:r,height:r,minWidth:r,minHeight:r,flexShrink:0},b=Math.max(14,Math.round(r*.42));return e.jsx("div",{className:`inline-flex items-center justify-center rounded-full text-white font-semibold select-none ${i} ${a}`,style:m,"aria-label":`Avatar de ${t}`,children:e.jsx("span",{style:{fontSize:b},children:n})})},Do=({pacientes:s,onEdit:r,onDelete:a,onView:t,onSchedule:o,emptyMessage:n="Nenhum paciente encontrado."})=>e.jsx("div",{className:"overflow-x-auto rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm",role:"region","aria-label":"Lista de pacientes",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",role:"table",children:[e.jsx("thead",{className:"bg-gray-50/90 dark:bg-gray-800/90 sticky top-0 backdrop-blur supports-[backdrop-filter]:backdrop-blur z-10",role:"rowgroup",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:"Paciente"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:"Contato"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:"Local"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:"Último Atendimento"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:"Próximo Atendimento"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:"Convênio"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:"Ações"})]})}),e.jsxs("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700",role:"rowgroup",children:[s.map(i=>e.jsxs("tr",{className:"bg-white dark:bg-gray-900 hover:bg-blue-50/50 dark:hover:bg-gray-800 transition-colors",role:"row",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[i.avatar_url?e.jsx("img",{src:i.avatar_url,alt:i.nome,className:"h-10 w-10 rounded-full object-cover border"}):e.jsx(Po,{name:i.nome,size:40}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 cursor-pointer hover:underline",onClick:()=>t?.(i),children:i.nome||"Sem nome"}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:i.cpf||"CPF não informado"}),i.vip&&e.jsxs("div",{className:"mt-2 inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-semibold bg-yellow-100 text-yellow-800 ring-1 ring-yellow-700/20 dark:bg-yellow-200 dark:text-yellow-900","aria-label":"Paciente VIP",children:[e.jsx("span",{"aria-hidden":!0,children:"★"})," VIP"]})]})]})}),e.jsxs("td",{className:"px-6 py-4 text-sm",children:[e.jsx("div",{className:"text-gray-900 dark:text-gray-100",children:i.email||"Não informado"}),e.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:i.telefoneFormatado||"Telefone não informado"})]}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 dark:text-gray-400",children:i.cidade||i.estado?`${i.cidade||""}${i.cidade&&i.estado?"/":""}${i.estado||""}`:"—"}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 dark:text-gray-400",children:i.ultimoAtendimento||"—"}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 dark:text-gray-400",children:i.proximoAtendimento||"—"}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 dark:text-gray-400",children:i.convenio||"Particular"}),e.jsx("td",{className:"px-6 py-4 text-right text-sm font-medium",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[t&&e.jsxs("button",{onClick:()=>t(i),title:`Ver ${i.nome}`,"aria-label":`Ver ${i.nome}`,className:"inline-flex items-center gap-1 rounded-md px-2.5 py-1.5 text-gray-700 hover:text-gray-900 hover:bg-gray-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500",children:[e.jsx(dt,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Ver"})]}),o&&e.jsxs("button",{onClick:()=>o(i),title:`Agendar para ${i.nome}`,"aria-label":`Agendar para ${i.nome}`,className:"inline-flex items-center gap-1 rounded-md px-2.5 py-1.5 text-blue-700 bg-blue-50 hover:bg-blue-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500",children:[e.jsx(ve,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Agendar"})]}),e.jsxs("button",{onClick:()=>r(i),title:`Editar ${i.nome}`,"aria-label":`Editar ${i.nome}`,className:"inline-flex items-center gap-1 rounded-md px-2.5 py-1.5 text-green-700 bg-green-50 hover:bg-green-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500",children:[e.jsx(gs,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Editar"})]}),e.jsxs("button",{onClick:()=>a(i),title:`Excluir ${i.nome}`,"aria-label":`Excluir ${i.nome}`,className:"inline-flex items-center gap-1 rounded-md px-2.5 py-1.5 text-red-700 bg-red-50 hover:bg-red-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500",children:[e.jsx(Ye,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Excluir"})]})]})})]},i.id)),s.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-6 py-10 text-center text-sm text-gray-500 dark:text-gray-400",children:e.jsx("span",{role:"status","aria-live":"polite",children:n})})})]})]})}),Mo=["segunda","terca","quarta","quinta","sexta","sabado","domingo"],To=({doctorId:s})=>{const[r,a]=c.useState([]),[t,o]=c.useState(!1),[n,i]=c.useState({weekday:"segunda",start_time:"09:00:00",end_time:"17:00:00",slot_minutes:30,appointment_type:"presencial",active:!0}),[m,b]=c.useState(!1),y=c.useMemo(()=>!!s&&!!n.weekday&&!!n.start_time&&!!n.end_time&&Number(n.slot_minutes)>0,[s,n]);async function d(){if(!s)return;o(!0);const j=await qe.listDoctorActiveAvailability(s);j.success&&j.data?a(j.data):h.error(j.error||"Erro ao carregar disponibilidades"),o(!1)}c.useEffect(()=>{d()},[s]);async function g(j){if(j.preventDefault(),!y){h.error("Preencha todos os campos obrigatórios");return}const C=/^\d{2}:\d{2}:\d{2}$/;if(!C.test(n.start_time)||!C.test(n.end_time)){h.error("Formato de horário inválido. Use HH:MM:SS");return}if(n.start_time>=n.end_time){h.error("Horário de fim deve ser posterior ao horário de início");return}const S={doctor_id:s,weekday:n.weekday,start_time:n.start_time,end_time:n.end_time,slot_minutes:Number(n.slot_minutes)||30,appointment_type:n.appointment_type,active:n.active};console.log("[AvailabilityManager] Enviando payload:",S),b(!0);const k=await qe.createAvailability(S);b(!1),k.success?(h.success("Disponibilidade criada com sucesso!"),i(N=>({...N,start_time:"09:00:00",end_time:"17:00:00"})),d()):(console.error("[AvailabilityManager] Erro ao criar:",k.error),h.error(k.error||"Falha ao criar disponibilidade"))}async function p(j){if(!j.id)return;const C=await qe.updateAvailability(j.id,{active:!j.active});C.success?(h.success("Atualizado"),d()):h.error(C.error||"Falha ao atualizar")}async function E(j){if(!j.id||!confirm("Remover disponibilidade?"))return;const S=await qe.deleteAvailability(j.id);S.success?(h.success("Removido"),d()):h.error(S.error||"Falha ao remover")}return e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Disponibilidade Semanal"}),e.jsx("form",{onSubmit:g,className:"mb-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-4 mb-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1",children:"Dia da Semana"}),e.jsx("select",{value:n.weekday,onChange:j=>i(C=>({...C,weekday:j.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-blue-600/40 transition-colors",children:Mo.map(j=>e.jsx("option",{value:j,children:j.charAt(0).toUpperCase()+j.slice(1)},j))})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1",children:"Horário Início"}),e.jsx("input",{type:"time",step:60,value:n.start_time?.slice(0,5),onChange:j=>i(C=>({...C,start_time:`${j.target.value}:00`})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-blue-600/40 transition-colors"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1",children:"Horário Fim"}),e.jsx("input",{type:"time",step:60,value:n.end_time?.slice(0,5),onChange:j=>i(C=>({...C,end_time:`${j.target.value}:00`})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-blue-600/40 transition-colors"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1",children:"Duração (min)"}),e.jsx("input",{type:"number",min:5,step:5,value:n.slot_minutes,onChange:j=>i(C=>({...C,slot_minutes:Number(j.target.value)})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-blue-600/40 transition-colors"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1",children:"Tipo Atendimento"}),e.jsxs("select",{value:n.appointment_type,onChange:j=>i(C=>({...C,appointment_type:j.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-blue-600/40 transition-colors",children:[e.jsx("option",{value:"presencial",children:"Presencial"}),e.jsx("option",{value:"telemedicina",children:"Telemedicina"})]})]}),e.jsx("div",{className:"flex flex-col justify-end",children:e.jsx("button",{type:"submit",disabled:!y||m,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500",children:m?"Salvando...":"Adicionar"})})]})}),t?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):r.length===0?e.jsx("div",{className:"text-center py-8 text-sm text-gray-500",children:"Nenhuma disponibilidade cadastrada. Use o formulário acima para adicionar horários."}):e.jsx("div",{className:"overflow-x-auto rounded-lg border border-gray-200",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Dia da Semana"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Horário Início"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Horário Fim"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Duração"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tipo"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.map(j=>e.jsxs("tr",{className:"odd:bg-white even:bg-gray-50 hover:bg-blue-50/40 transition-colors",children:[e.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:j.weekday?j.weekday.charAt(0).toUpperCase()+j.weekday.slice(1):"-"}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:j.start_time?.slice(0,5)}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:j.end_time?.slice(0,5)}),e.jsxs("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:[j.slot_minutes||30," min"]}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:j.appointment_type==="presencial"?"Presencial":"Telemedicina"}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:e.jsx("button",{className:`px-3 py-1 rounded-full text-xs font-medium ${j.active?"bg-green-100 text-green-800 ring-1 ring-green-600/20 hover:bg-green-200":"bg-gray-100 text-gray-800 ring-1 ring-gray-600/20 hover:bg-gray-200"}`,onClick:()=>void p(j),children:j.active?"Ativo":"Inativo"})}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm font-medium",children:e.jsx("button",{className:"inline-flex items-center gap-1 rounded-md px-2.5 py-1.5 text-red-700 bg-red-50 hover:bg-red-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500",onClick:()=>void E(j),children:"Remover"})})]},j.id))})]})})]})},Io=({doctorId:s})=>{const[r,a]=c.useState([]),[t,o]=c.useState(!1),[n,i]=c.useState({date:"",start_time:"",end_time:"",kind:"bloqueio",reason:""}),[m,b]=c.useState(!1);async function y(){if(!s)return;o(!0);const p=await na.listExceptions({doctor_id:s});p.success&&p.data?a(p.data):h.error(p.error||"Erro ao carregar exceções"),o(!1)}c.useEffect(()=>{y()},[s]);async function d(p){if(p.preventDefault(),!s||!n.date||!n.kind){h.error("Preencha data e tipo");return}b(!0);const E=await na.createException({doctor_id:s,date:n.date,start_time:n.start_time||void 0,end_time:n.end_time||void 0,kind:n.kind,reason:n.reason||void 0});b(!1),E.success?(h.success("Exceção criada"),i({date:"",start_time:"",end_time:"",kind:"bloqueio",reason:""}),y()):h.error(E.error||"Falha ao criar")}async function g(p){if(!p.id||!confirm("Remover exceção?"))return;const j=await na.deleteException(p.id);j.success?(h.success("Removida"),y()):h.error(j.error||"Falha ao remover")}return e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Exceções (Bloqueios/Liberações)"}),e.jsx("form",{onSubmit:d,className:"mb-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-4 mb-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1",children:"Data"}),e.jsx("input",{type:"date",value:n.date,onChange:p=>i(E=>({...E,date:p.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-blue-600/40 transition-colors",required:!0})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700 mb-1",children:["Início"," ",e.jsx("span",{className:"text-gray-400 font-normal",children:"(opcional)"})]}),e.jsx("input",{type:"time",value:n.start_time,onChange:p=>i(E=>({...E,start_time:p.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-blue-600/40 transition-colors",placeholder:"Dia todo"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700 mb-1",children:["Fim ",e.jsx("span",{className:"text-gray-400 font-normal",children:"(opcional)"})]}),e.jsx("input",{type:"time",value:n.end_time,onChange:p=>i(E=>({...E,end_time:p.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-blue-600/40 transition-colors",placeholder:"Dia todo"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1",children:"Tipo"}),e.jsxs("select",{value:n.kind,onChange:p=>i(E=>({...E,kind:p.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-blue-600/40 transition-colors",children:[e.jsx("option",{value:"bloqueio",children:"Bloqueio"}),e.jsx("option",{value:"liberacao",children:"Liberação"})]})]}),e.jsxs("div",{className:"flex flex-col md:col-span-2",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700 mb-1",children:["Motivo"," ",e.jsx("span",{className:"text-gray-400 font-normal",children:"(opcional)"})]}),e.jsx("input",{type:"text",value:n.reason,onChange:p=>i(E=>({...E,reason:p.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-blue-600/40 transition-colors",placeholder:"Ex.: Férias, Reunião, etc."})]}),e.jsx("div",{className:"flex flex-col justify-end",children:e.jsx("button",{type:"submit",disabled:m,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500",children:m?"Salvando...":"Adicionar"})})]})}),t?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):r.length===0?e.jsx("div",{className:"text-center py-8 text-sm text-gray-500",children:"Nenhuma exceção cadastrada. Use o formulário acima para bloquear/liberar horários."}):e.jsx("div",{className:"overflow-x-auto rounded-lg border border-gray-200",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Horário Início"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Horário Fim"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tipo"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Motivo"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.map(p=>e.jsxs("tr",{className:"odd:bg-white even:bg-gray-50 hover:bg-blue-50/40 transition-colors",children:[e.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:p.date?new Date(p.date+"T00:00:00").toLocaleDateString("pt-BR"):"—"}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:p.start_time?p.start_time.slice(0,5):e.jsx("span",{className:"text-gray-400",children:"Dia todo"})}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:p.end_time?p.end_time.slice(0,5):e.jsx("span",{className:"text-gray-400",children:"Dia todo"})}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ring-1 ${p.kind==="bloqueio"?"bg-red-50 text-red-700 ring-red-600/20":"bg-green-50 text-green-700 ring-green-600/20"}`,children:p.kind==="bloqueio"?"Bloqueio":"Liberação"})}),e.jsx("td",{className:"px-4 py-4 text-sm text-gray-900",children:p.reason||e.jsx("span",{className:"text-gray-400",children:"—"})}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm font-medium",children:e.jsx("button",{className:"inline-flex items-center gap-1 rounded-md px-2.5 py-1.5 text-red-700 bg-red-50 hover:bg-red-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500",onClick:()=>void g(p),children:"Remover"})})]},p.id))})]})})]})},Ro=["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"],Lo=["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],$o=({doctorId:s})=>{const[r,a]=c.useState(new Date),[t,o]=c.useState([]),[n,i]=c.useState(!1),[m,b]=c.useState(null),[y,d]=c.useState({});c.useEffect(()=>{s&&(g(),p())},[s,r]);async function g(){i(!0);try{const _=await sa.listAppointments();if(_.success&&_.data){const O=_.data.filter(H=>H.doctor_id===s);o(O)}else h.error(_.error||"Erro ao carregar agendamentos")}catch(_){console.error("Erro ao carregar agendamentos:",_),h.error("Erro ao carregar agendamentos")}finally{i(!1)}}async function p(){try{const _=await Cr.listPatients();if(_&&Array.isArray(_.data)){const O={};for(const H of _.data)H?.id&&(O[H.id]=H.nome||H.email||H.cpf||H.id);d(O)}else if(_&&typeof _=="object"&&_.data?.data){const O=_.data?.data||[],H={};for(const A of O)A?.id&&(H[A.id]=A.nome||A.email||A.cpf||A.id);d(H)}}catch{}finally{}}function E(_){return _?y[_]||_:""}function j(){const _=r.getFullYear(),O=r.getMonth(),H=new Date(_,O,1),A=new Date(_,O+1,0),X=H.getDay(),ae=[],se=new Date;se.setHours(0,0,0,0);const oe=new Date(_,O,0);for(let te=X-1;te>=0;te--){const re=new Date(_,O-1,oe.getDate()-te),W=C(re);ae.push({date:re,dateStr:W,isCurrentMonth:!1,isToday:!1,appointments:S(W)})}for(let te=1;te<=A.getDate();te++){const re=new Date(_,O,te),W=C(re),P=re.getTime()===se.getTime();ae.push({date:re,dateStr:W,isCurrentMonth:!0,isToday:P,appointments:S(W)})}const le=42-ae.length;for(let te=1;te<=le;te++){const re=new Date(_,O+1,te),W=C(re);ae.push({date:re,dateStr:W,isCurrentMonth:!1,isToday:!1,appointments:S(W)})}return ae}function C(_){return _.toISOString().split("T")[0]}function S(_){return t.filter(O=>O.scheduled_at?O.scheduled_at.split("T")[0]===_:!1)}function k(){a(new Date(r.getFullYear(),r.getMonth()-1,1))}function N(){a(new Date(r.getFullYear(),r.getMonth()+1,1))}function x(){a(new Date)}function v(_){switch(_){case"confirmed":return"bg-blue-500";case"completed":return"bg-green-500";case"cancelled":return"bg-red-500";case"no_show":return"bg-gray-500";case"checked_in":return"bg-purple-500";case"in_progress":return"bg-yellow-500";default:return"bg-orange-500"}}function $(_){return{requested:"Solicitado",confirmed:"Confirmado",checked_in:"Check-in",in_progress:"Em andamento",completed:"Concluído",cancelled:"Cancelado",no_show:"Faltou"}[_||"requested"]||_||"Solicitado"}const Z=j();return e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-200",children:[e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Calendário de Consultas"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:x,className:"px-3 py-1.5 text-sm font-medium text-blue-700 bg-blue-50 hover:bg-blue-100 rounded-lg focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500",children:"Hoje"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:k,className:"p-2 hover:bg-gray-100 rounded-lg focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500","aria-label":"Mês anterior",children:e.jsx(ut,{className:"w-5 h-5"})}),e.jsxs("span",{className:"text-lg font-medium min-w-[200px] text-center",children:[Lo[r.getMonth()]," ",r.getFullYear()]}),e.jsx("button",{onClick:N,className:"p-2 hover:bg-gray-100 rounded-lg focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500","aria-label":"Próximo mês",children:e.jsx(mt,{className:"w-5 h-5"})})]})]})]}),n?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-blue-600"})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:Ro.map(_=>e.jsx("div",{className:"text-center text-sm font-semibold text-gray-600 py-2",children:_},_))}),e.jsx("div",{className:"grid grid-cols-7 gap-1",children:Z.map((_,O)=>e.jsxs("div",{className:`group min-h-[110px] border rounded-lg p-2 transition-colors ${_.isCurrentMonth?"bg-white border-gray-200":"bg-gray-50 border-gray-100"} ${_.isToday?"ring-2 ring-blue-500":""} ${_.appointments.length>0?"cursor-pointer hover:bg-blue-50":""}`,onClick:()=>_.appointments.length>0&&b(_),children:[e.jsx("div",{className:`text-sm font-medium mb-2 ${_.isCurrentMonth?"text-gray-900":"text-gray-400"} ${_.isToday?"text-blue-600 font-bold":""}`,children:_.date.getDate()}),e.jsxs("div",{className:"space-y-1",children:[_.appointments.slice(0,3).map((H,A)=>e.jsx("div",{className:`text-xs px-1 py-0.5 rounded text-white ${v(H.status)} truncate`,title:`${H.scheduled_at?.slice(11,16)} - ${$(H.status)}`,children:H.scheduled_at?.slice(11,16)},H.id||A)),_.appointments.length>3&&e.jsxs("div",{className:"text-xs text-gray-500 font-medium",children:["+",_.appointments.length-3," mais"]})]})]},O))})]}),m&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-[2px] flex items-center justify-center z-50",onClick:()=>b(null),role:"dialog","aria-modal":"true","aria-label":"Consultas do dia selecionado",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full mx-4 max-h-[80vh] overflow-auto ring-1 ring-black/5",onClick:_=>_.stopPropagation(),children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between",children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-900",children:["Consultas de"," ",m.date.toLocaleDateString("pt-BR",{weekday:"long",day:"numeric",month:"long",year:"numeric"})]}),e.jsx("button",{onClick:()=>b(null),"aria-label":"Fechar",className:"p-2 rounded-md text-gray-500 hover:text-gray-700 hover:bg-gray-100 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500",children:e.jsx(Fe,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"p-6 space-y-3",children:m.appointments.length===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"Nenhuma consulta agendada para este dia."}):m.appointments.map(_=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"font-medium text-gray-900",children:_.scheduled_at?.slice(11,16)}),e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium text-white ${v(_.status)}`,children:$(_.status)})]}),e.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Paciente:"})," ",E(_.patient_id)]}),_.appointment_type&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Tipo:"})," ",_.appointment_type==="presencial"?"Presencial":"Telemedicina"]}),_.chief_complaint&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Queixa:"})," ",_.chief_complaint]})]})]})})},_.id))}),e.jsx("div",{className:"p-6 border-t border-gray-200 flex justify-end",children:e.jsx("button",{onClick:()=>b(null),className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500",children:"Fechar"})})]})})]})},Oo=({isOpen:s,onClose:r,patientId:a,patientName:t,onSuccess:o})=>{const[n,i]=c.useState([]),[m,b]=c.useState(!1),[y,d]=c.useState([]),[g,p]=c.useState(!1),[E,j]=c.useState(""),[C,S]=c.useState(""),[k,N]=c.useState(""),[x,v]=c.useState("presencial"),[$,Z]=c.useState(""),[_,O]=c.useState(!1),[H,A]=c.useState(""),[X,ae]=c.useState(""),se=c.useRef(null),oe=c.useRef(null),le=c.useRef(null),te=c.useRef(null),re=c.useMemo(()=>`schedule-modal-title-${a??"novo"}`,[a]),W=c.useMemo(()=>`schedule-modal-desc-${a??"novo"}`,[a]);c.useEffect(()=>{s&&(P(),a?(A(a),ae(t||"")):q(),setTimeout(()=>le.current?.focus(),0))},[s]);async function P(){b(!0);const R=await Ae.listarMedicos();b(!1),R.success&&R.data?i(R.data.data):h.error("Erro ao carregar médicos")}async function q(){p(!0);try{const R=await Cr.listPatients();p(!1),R&&Array.isArray(R.data)?d(R.data):R&&typeof R=="object"&&R.data?.data?d(R.data?.data||[]):h.error("Erro ao carregar pacientes")}catch{p(!1),h.error("Erro ao carregar pacientes")}}async function D(R){R.preventDefault();const de=a||H;if(!E||!C||!k||!de){h.error("Preencha médico, data e horário");return}O(!0);const we=`${C}T${k}:00`,ie=await sa.createAppointment({patient_id:de,doctor_id:E,scheduled_at:we,appointment_type:x,chief_complaint:$||void 0});O(!1),ie.success?(h.success("Agendamento criado com sucesso!"),o?.(),I()):h.error(ie.error||"Erro ao criar agendamento")}function I(){j(""),S(""),N(""),v("presencial"),Z(""),A(""),ae(""),r()}if(!s)return null;const K=n.find(R=>R.id===E),ee=!!a,w=ee?t:X||(y.find(R=>R.id===H)?.nome??"");function V(R){R.key==="Escape"&&(R.stopPropagation(),I())}function G(R){R.target===se.current&&I()}return e.jsx("div",{ref:se,className:"fixed inset-0 bg-black/50 backdrop-blur-[2px] flex items-center justify-center z-50 p-4",onClick:G,onKeyDown:V,role:"dialog","aria-modal":"true","aria-labelledby":re,"aria-describedby":W,children:e.jsxs("div",{ref:oe,className:"bg-white rounded-xl shadow-2xl max-w-3xl w-full max-h-[90vh] overflow-y-auto ring-1 ring-black/5 animate-in fade-in zoom-in duration-150",onClick:R=>R.stopPropagation(),children:[e.jsxs("div",{className:"sticky top-0 bg-gradient-to-r from-blue-50 to-white border-b px-6 py-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ge,{className:"w-5 h-5 text-blue-600","aria-hidden":"true"}),e.jsxs("h2",{id:re,className:"text-lg md:text-xl font-semibold text-gray-900",children:["Agendar consulta •"," ",e.jsx("span",{className:"font-normal text-gray-700",children:w})]})]}),e.jsx("button",{ref:te,onClick:I,"aria-label":"Fechar modal de agendamento",className:"inline-flex items-center justify-center rounded-md p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500",children:e.jsx(Fe,{className:"w-5 h-5"})})]}),e.jsx("p",{id:W,className:"sr-only",children:"Selecione o médico, a data, o tipo de consulta e um horário disponível para criar um novo agendamento."}),e.jsxs("form",{onSubmit:D,className:"p-6 space-y-6","aria-busy":_,children:[!ee&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Paciente *"}),g?e.jsx("div",{className:"h-10 w-full rounded-lg bg-gray-100 animate-pulse","aria-live":"polite","aria-label":"Carregando pacientes"}):e.jsxs("select",{value:H,onChange:R=>{A(R.target.value);const de=y.find(we=>we.id===R.target.value);ae(de?.nome||"")},className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-blue-600/40 transition-colors",required:!0,children:[e.jsx("option",{value:"",children:"-- Selecione um paciente --"}),y.map(R=>e.jsxs("option",{value:R.id,children:[R.nome," ",R.cpf?`- ${R.cpf}`:""]},R.id))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Médico"," ",e.jsx("span",{className:"text-red-500","aria-hidden":"true",children:"*"})]}),m?e.jsx("div",{className:"h-10 w-full rounded-lg bg-gray-100 animate-pulse","aria-live":"polite","aria-label":"Carregando médicos"}):e.jsxs("select",{value:E,onChange:R=>j(R.target.value),ref:le,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-blue-600/40 transition-colors",required:!0,children:[e.jsx("option",{value:"",children:"-- Selecione um médico --"}),n.map(R=>e.jsxs("option",{value:R.id,children:[R.nome," - ",R.especialidade]},R.id))]}),K&&e.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:["CRM: ",K.crm]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Data"," ",e.jsx("span",{className:"text-red-500","aria-hidden":"true",children:"*"})]}),e.jsx("input",{type:"date",value:C,onChange:R=>{S(R.target.value),N("")},min:new Date().toISOString().split("T")[0],className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-blue-600/40 transition-colors",required:!0}),e.jsxs("p",{className:"mt-1 text-xs text-gray-500 flex items-center gap-1",children:[e.jsx(ve,{className:"w-3.5 h-3.5"})," Selecione uma data para ver os horários disponíveis."]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Tipo de Consulta"," ",e.jsx("span",{className:"text-red-500","aria-hidden":"true",children:"*"})]}),e.jsxs("select",{value:x,onChange:R=>v(R.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-blue-600/40 transition-colors",required:!0,children:[e.jsx("option",{value:"presencial",children:"Presencial"}),e.jsx("option",{value:"telemedicina",children:"Telemedicina"})]}),e.jsxs("p",{className:"mt-1 text-xs text-gray-500 flex items-center gap-1",children:[e.jsx(Pe,{className:"w-3.5 h-3.5"})," O tipo de consulta pode alterar a disponibilidade de horários."]})]}),E&&C&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Horários Disponíveis *"}),e.jsx(_s,{doctorId:E,date:C,appointment_type:x,onSelect:R=>N(R)}),k&&e.jsxs("div",{className:"mt-2 inline-flex items-center gap-2 rounded-md bg-green-50 px-3 py-1.5 text-sm text-green-700 ring-1 ring-green-600/20",children:[e.jsx("span",{"aria-hidden":!0,children:"✓"})," Horário selecionado:"," ",e.jsx("span",{className:"font-semibold",children:k})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Motivo da Consulta (opcional)"}),e.jsx("textarea",{value:$,onChange:R=>Z(R.target.value),rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-blue-600/40 transition-colors",placeholder:"Ex: Consulta de rotina, dor de cabeça..."})]}),e.jsxs("div",{className:"flex flex-col-reverse sm:flex-row gap-3 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:I,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500",disabled:_,children:"Cancelar"}),e.jsx("button",{type:"submit",className:"flex-1 inline-flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500",disabled:_||!E||!C||!k||!ee&&!H,children:_?e.jsxs(e.Fragment,{children:[e.jsx(gr,{className:"w-4 h-4 animate-spin","aria-hidden":!0})," ","Agendando..."]}):"Confirmar Agendamento"})]})]})]})})},qo=["A+","A-","B+","B-","AB+","AB-","O+","O-"],Fo=[{value:"55",label:"+55 🇧🇷 Brasil"},{value:"1",label:"+1 🇺🇸 EUA/Canadá"},{value:"93",label:"+93 🇦🇫 Afeganistão"},{value:"355",label:"+355 🇦🇱 Albânia"},{value:"49",label:"+49 🇩🇪 Alemanha"},{value:"376",label:"+376 🇦🇩 Andorra"},{value:"244",label:"+244 🇦🇴 Angola"},{value:"54",label:"+54 🇦🇷 Argentina"},{value:"374",label:"+374 🇦🇲 Armênia"},{value:"61",label:"+61 🇦🇺 Austrália"},{value:"43",label:"+43 🇦🇹 Áustria"},{value:"994",label:"+994 🇦🇿 Azerbaijão"},{value:"973",label:"+973 🇧🇭 Bahrein"},{value:"880",label:"+880 🇧🇩 Bangladesh"},{value:"375",label:"+375 🇧🇾 Bielorrússia"},{value:"32",label:"+32 🇧🇪 Bélgica"},{value:"501",label:"+501 🇧🇿 Belize"},{value:"591",label:"+591 🇧🇴 Bolívia"},{value:"387",label:"+387 🇧🇦 Bósnia"},{value:"267",label:"+267 🇧🇼 Botsuana"},{value:"359",label:"+359 🇧🇬 Bulgária"},{value:"226",label:"+226 🇧🇫 Burkina Faso"},{value:"257",label:"+257 🇧🇮 Burundi"},{value:"238",label:"+238 🇨🇻 Cabo Verde"},{value:"855",label:"+855 🇰🇭 Camboja"},{value:"237",label:"+237 🇨🇲 Camarões"},{value:"56",label:"+56 🇨🇱 Chile"},{value:"86",label:"+86 🇨🇳 China"},{value:"57",label:"+57 🇨🇴 Colômbia"},{value:"242",label:"+242 🇨🇬 Congo"},{value:"82",label:"+82 🇰🇷 Coreia do Sul"},{value:"850",label:"+850 🇰🇵 Coreia do Norte"},{value:"506",label:"+506 🇨🇷 Costa Rica"},{value:"225",label:"+225 🇨🇮 Costa do Marfim"},{value:"385",label:"+385 🇭🇷 Croácia"},{value:"53",label:"+53 🇨🇺 Cuba"},{value:"45",label:"+45 🇩🇰 Dinamarca"},{value:"593",label:"+593 🇪🇨 Equador"},{value:"20",label:"+20 🇪🇬 Egito"},{value:"503",label:"+503 🇸🇻 El Salvador"},{value:"971",label:"+971 🇦🇪 Emirados Árabes"},{value:"593",label:"+593 🇪🇨 Equador"},{value:"291",label:"+291 🇪🇷 Eritreia"},{value:"421",label:"+421 🇸🇰 Eslováquia"},{value:"386",label:"+386 🇸🇮 Eslovênia"},{value:"34",label:"+34 🇪🇸 Espanha"},{value:"251",label:"+251 🇪🇹 Etiópia"},{value:"679",label:"+679 🇫🇯 Fiji"},{value:"63",label:"+63 🇵🇭 Filipinas"},{value:"358",label:"+358 🇫🇮 Finlândia"},{value:"33",label:"+33 🇫🇷 França"},{value:"241",label:"+241 🇬🇦 Gabão"},{value:"220",label:"+220 🇬🇲 Gâmbia"},{value:"233",label:"+233 🇬🇭 Gana"},{value:"995",label:"+995 🇬🇪 Geórgia"},{value:"350",label:"+350 🇬🇮 Gibraltar"},{value:"30",label:"+30 🇬🇷 Grécia"},{value:"502",label:"+502 🇬🇹 Guatemala"},{value:"224",label:"+224 🇬🇳 Guiné"},{value:"245",label:"+245 🇬🇼 Guiné-Bissau"},{value:"509",label:"+509 🇭🇹 Haiti"},{value:"504",label:"+504 🇭🇳 Honduras"},{value:"852",label:"+852 🇭🇰 Hong Kong"},{value:"36",label:"+36 🇭🇺 Hungria"},{value:"967",label:"+967 🇾🇪 Iêmen"},{value:"91",label:"+91 🇮🇳 Índia"},{value:"62",label:"+62 🇮🇩 Indonésia"},{value:"98",label:"+98 🇮🇷 Irã"},{value:"964",label:"+964 🇮🇶 Iraque"},{value:"353",label:"+353 🇮🇪 Irlanda"},{value:"354",label:"+354 🇮🇸 Islândia"},{value:"972",label:"+972 🇮🇱 Israel"},{value:"39",label:"+39 🇮🇹 Itália"},{value:"81",label:"+81 🇯🇵 Japão"},{value:"962",label:"+962 🇯🇴 Jordânia"},{value:"254",label:"+254 🇰🇪 Quênia"},{value:"996",label:"+996 🇰🇬 Quirguistão"},{value:"383",label:"+383 🇽🇰 Kosovo"},{value:"965",label:"+965 🇰🇼 Kuwait"},{value:"856",label:"+856 🇱🇦 Laos"},{value:"371",label:"+371 🇱🇻 Letônia"},{value:"961",label:"+961 🇱🇧 Líbano"},{value:"266",label:"+266 🇱🇸 Lesoto"},{value:"231",label:"+231 🇱🇷 Libéria"},{value:"218",label:"+218 🇱🇾 Líbia"},{value:"423",label:"+423 🇱🇮 Liechtenstein"},{value:"370",label:"+370 🇱🇹 Lituânia"},{value:"352",label:"+352 🇱🇺 Luxemburgo"},{value:"853",label:"+853 🇲🇴 Macau"},{value:"389",label:"+389 🇲🇰 Macedônia"},{value:"261",label:"+261 🇲🇬 Madagascar"},{value:"60",label:"+60 🇲🇾 Malásia"},{value:"265",label:"+265 🇲🇼 Malawi"},{value:"960",label:"+960 🇲🇻 Maldivas"},{value:"223",label:"+223 🇲🇱 Mali"},{value:"356",label:"+356 🇲🇹 Malta"},{value:"212",label:"+212 🇲🇦 Marrocos"},{value:"230",label:"+230 🇲🇺 Maurício"},{value:"222",label:"+222 🇲🇷 Mauritânia"},{value:"52",label:"+52 🇲🇽 México"},{value:"95",label:"+95 🇲🇲 Mianmar"},{value:"258",label:"+258 🇲🇿 Moçambique"},{value:"373",label:"+373 🇲🇩 Moldávia"},{value:"377",label:"+377 🇲🇨 Mônaco"},{value:"976",label:"+976 🇲🇳 Mongólia"},{value:"382",label:"+382 🇲🇪 Montenegro"},{value:"264",label:"+264 🇳🇦 Namíbia"},{value:"977",label:"+977 🇳🇵 Nepal"},{value:"505",label:"+505 🇳🇮 Nicarágua"},{value:"227",label:"+227 🇳🇪 Níger"},{value:"234",label:"+234 🇳🇬 Nigéria"},{value:"47",label:"+47 🇳🇴 Noruega"},{value:"64",label:"+64 🇳🇿 Nova Zelândia"},{value:"968",label:"+968 🇴🇲 Omã"},{value:"31",label:"+31 🇳🇱 Países Baixos"},{value:"92",label:"+92 🇵🇰 Paquistão"},{value:"507",label:"+507 🇵🇦 Panamá"},{value:"675",label:"+675 🇵🇬 Papua Nova Guiné"},{value:"595",label:"+595 🇵🇾 Paraguai"},{value:"51",label:"+51 🇵🇪 Peru"},{value:"48",label:"+48 🇵🇱 Polônia"},{value:"351",label:"+351 🇵🇹 Portugal"},{value:"974",label:"+974 🇶🇦 Qatar"},{value:"44",label:"+44 🇬🇧 Reino Unido"},{value:"236",label:"+236 🇨🇫 Rep. Centro-Africana"},{value:"243",label:"+243 🇨🇩 Rep. Dem. do Congo"},{value:"420",label:"+420 🇨🇿 República Tcheca"},{value:"40",label:"+40 🇷🇴 Romênia"},{value:"250",label:"+250 🇷🇼 Ruanda"},{value:"7",label:"+7 🇷🇺 Rússia"},{value:"966",label:"+966 🇸🇦 Arábia Saudita"},{value:"221",label:"+221 🇸🇳 Senegal"},{value:"381",label:"+381 🇷🇸 Sérvia"},{value:"65",label:"+65 🇸🇬 Singapura"},{value:"963",label:"+963 🇸🇾 Síria"},{value:"252",label:"+252 🇸🇴 Somália"},{value:"94",label:"+94 🇱🇰 Sri Lanka"},{value:"268",label:"+268 🇸🇿 Suazilândia"},{value:"249",label:"+249 🇸🇩 Sudão"},{value:"211",label:"+211 🇸🇸 Sudão do Sul"},{value:"46",label:"+46 🇸🇪 Suécia"},{value:"41",label:"+41 🇨🇭 Suíça"},{value:"597",label:"+597 🇸🇷 Suriname"},{value:"66",label:"+66 🇹🇭 Tailândia"},{value:"886",label:"+886 🇹🇼 Taiwan"},{value:"992",label:"+992 🇹🇯 Tajiquistão"},{value:"255",label:"+255 🇹🇿 Tanzânia"},{value:"670",label:"+670 🇹🇱 Timor-Leste"},{value:"228",label:"+228 🇹🇬 Togo"},{value:"676",label:"+676 🇹🇴 Tonga"},{value:"216",label:"+216 🇹🇳 Tunísia"},{value:"993",label:"+993 🇹🇲 Turcomenistão"},{value:"90",label:"+90 🇹🇷 Turquia"},{value:"380",label:"+380 🇺🇦 Ucrânia"},{value:"256",label:"+256 🇺🇬 Uganda"},{value:"598",label:"+598 🇺🇾 Uruguai"},{value:"998",label:"+998 🇺🇿 Uzbequistão"},{value:"678",label:"+678 🇻🇺 Vanuatu"},{value:"58",label:"+58 🇻🇪 Venezuela"},{value:"84",label:"+84 🇻🇳 Vietnã"},{value:"260",label:"+260 🇿🇲 Zâmbia"},{value:"263",label:"+263 🇿🇼 Zimbábue"}],as=["Particular","Unimed","SulAmérica","Bradesco Saúde","Amil","NotreDame"],Uo=()=>typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():Math.random().toString(36).slice(2,11),rs=()=>({nome:"",social_name:"",cpf:"",sexo:"",dataNascimento:"",email:"",codigoPais:"55",ddd:"",numeroTelefone:"",telefone:void 0,tipo_sanguineo:"",altura:"",peso:"",convenio:"",numeroCarteirinha:"",observacoes:"",endereco:{rua:"",numero:"",complemento:"",bairro:"",cidade:"",estado:"",cep:""},rg:"",estado_civil:"",profissao:"",telefoneSecundario:"",telefoneReferencia:"",codigo_legado:"",responsavel_nome:"",responsavel_cpf:"",documentos:[]}),ss=()=>({nome:"",email:"",crm:"",crmUf:"SP",cpf:"",telefone:"",telefone2:"",especialidade:"",dataNascimento:"",rg:"",cep:"",rua:"",numero:"",complemento:"",bairro:"",cidade:"",estado:"",senha:""}),wa=s=>{const r=s.replace(/\D/g,"").slice(0,11);let a=r;return r.length>3&&(a=a.replace(/(\d{3})(\d)/,"$1.$2")),r.length>6&&(a=a.replace(/(\d{3})\.(\d{3})(\d)/,"$1.$2.$3")),r.length>9&&(a=a.replace(/(\d{3})\.(\d{3})\.(\d{3})(\d{1,2})/,"$1.$2.$3-$4")),{formatted:a,digits:r}},ts=s=>{const r=s.replace(/\D/g,"").slice(0,8);return r.length>5?r.replace(/(\d{5})(\d{1,3})/,"$1-$2"):r},zo=s=>{if(!s)return{codigoPais:"55",ddd:"",numeroTelefone:""};const r=s.replace(/\D/g,"");if(r.length<=9)return{codigoPais:"55",ddd:"",numeroTelefone:r};const a=r.slice(-9),t=r.length>=11?r.slice(-11,-9):"";return{codigoPais:r.slice(0,r.length-9-(t?2:0))||"55",ddd:t,numeroTelefone:a}},Ps=(s,r,a)=>{const t=s.replace(/\D/g,""),o=r.replace(/\D/g,""),n=a.replace(/\D/g,"");if(!t&&!o&&!n)return;let i=n;return n.length>5&&(i=n.replace(/(\d{5})(\d{1,4})?/,"$1-$2")),o&&(i=`(${o}) ${i}`),t&&(i=`+${t} ${i}`),i},Oa=s=>{const r=s.id||Uo(),a=zo(s.telefone);return{id:r,nome:s.nome??"",email:s.email??"",telefone:s.telefone??void 0,codigoPais:a.codigoPais||"55",ddd:a.ddd,numeroTelefone:a.numeroTelefone,cpf:s.cpf??"",sexo:s.sexo??"",dataNascimento:s.dataNascimento??"",tipo_sanguineo:s.tipo_sanguineo||s.tipoSanguineo||"",altura:s.altura??s.alturaM??null,peso:s.peso??s.pesoKg??null,convenio:s.convenio??null,numeroCarteirinha:s.numeroCarteirinha??null,observacoes:s.observacoes??null,vip:!!s.vip,endereco:{rua:s.endereco?.rua??"",numero:s.endereco?.numero??"",complemento:s.endereco?.complemento??"",bairro:s.endereco?.bairro??"",cidade:s.endereco?.cidade??"",estado:s.endereco?.estado??"",cep:s.endereco?.cep??""}}},Bo=s=>{const{formatted:r}=wa(s.cpf??"");return{id:s.id,nome:s.nome,social_name:"",cpf:r,sexo:s.sexo??"",dataNascimento:s.dataNascimento??"",email:s.email??"",codigoPais:s.codigoPais||"55",ddd:s.ddd,numeroTelefone:s.numeroTelefone,telefone:s.telefone,tipo_sanguineo:s.tipo_sanguineo??"",altura:s.altura!==null&&s.altura!==void 0?String(s.altura):"",peso:s.peso!==null&&s.peso!==void 0?String(s.peso):"",convenio:s.convenio??"",numeroCarteirinha:s.numeroCarteirinha??"",observacoes:s.observacoes??"",endereco:{rua:s.endereco.rua??"",numero:s.endereco.numero??"",complemento:s.endereco.complemento??"",bairro:s.endereco.bairro??"",cidade:s.endereco.cidade??"",estado:s.endereco.estado??"",cep:s.endereco.cep??""}}},Ho=s=>Ps(s.codigoPais,s.ddd,s.numeroTelefone)??s.telefone??"Telefone não informado",os=s=>s?s.trim().toLowerCase():"Não informado",Vo=s=>{if(!s)return"";const[r,a]=s.split("T");if(!r)return s;const[t,o,n]=r.split("-"),i=(a||"").slice(0,8);return t&&o&&n&&i?`${n}/${o}/${t}, ${i}`:t&&o&&n?`${n}/${o}/${t}`:s},Jo=s=>{const r=s.replace(/\D/g,"").slice(0,13);return r?r.length<=2?`(${r}`:r.length<=10?r.replace(/(\d{2})(\d{4})(\d{0,4})?/,(a,t,o,n)=>n?`(${t}) ${o}-${n}`:`(${t}) ${o}`):r.replace(/(\d{2})(\d{2})(\d{5})(\d{0,4})?/,(a,t,o,n,i)=>{const m=`+${t} (${o}) ${n}`;return i?`${m}-${i}`:m}):""},Go=s=>({requested:"agendada",confirmed:"confirmada",cancelled:"cancelada",completed:"realizada",no_show:"faltou",checked_in:"confirmada",in_progress:"confirmada"})[s]||"agendada",Yo=(s,r,a)=>{const t=r.find(n=>n.id===s.patient_id),o=a.find(n=>n.id===s.doctor_id);return{id:s.id||"",pacienteId:s.patient_id||"",medicoId:s.doctor_id||"",pacienteNome:t?.nome||"Paciente não encontrado",medicoNome:o?.nome||"Médico não encontrado",dataHora:s.scheduled_at||"",tipo:s.appointment_type||"consulta",status:Go(s.status||"requested")}},Ko=()=>{const s=je(),{logout:r}=ke(),[a,t]=c.useState(!1),[o,n]=c.useState("pacientes"),[i,m]=c.useState([]),[b,y]=c.useState(!1),[d,g]=c.useState(!1),[p,E]=c.useState(!1),[j,C]=c.useState({patientId:"",orderNumber:"",exam:"",diagnosis:"",conclusion:"",dueAt:"",status:"draft"}),[S,k]=c.useState("create"),[N,x]=c.useState(null),v=()=>{const l=new Date,f=l.getFullYear(),T=String(l.getMonth()+1).padStart(2,"0"),F="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let be="";for(let pe=0;pe<6;pe++)be+=F[Math.floor(Math.random()*F.length)];return`REL-${f}-${T}-${be}`},$=/^REL-\d{4}-\d{2}-[A-Z0-9]{6}$/,[Z,_]=c.useState(!1),[O,H]=c.useState(!1),[A,X]=c.useState(null),ae=async l=>{if(l){H(!0),X(null);try{const f=await Ua.buscarRelatorioPorId(l);f.success&&f.data?(X(f.data),_(!0)):h.error(f.error||"Erro ao carregar relatório")}catch{h.error("Erro ao carregar relatório")}finally{H(!1)}}},[se,oe]=c.useState(""),[le,te]=c.useState([]),[re,W]=c.useState([]),[P,q]=c.useState([]),[D,I]=c.useState([]),[K,ee]=c.useState(!1),[w,V]=c.useState(""),[G,R]=c.useState(""),[de,we]=c.useState(""),[ie,he]=c.useState(""),[Be,He]=c.useState(""),[Qe,ga]=c.useState({}),[Ne,De]=c.useState(""),[$e,Ve]=c.useState(""),[Ze,M]=c.useState(""),[u,L]=c.useState(!1),[z,Me]=c.useState(!1),[Te,Ia]=c.useState(!1),[xa,Sr]=c.useState("create"),[B,ce]=c.useState(rs()),[Er,Ra]=c.useState(!1),[We,_r]=c.useState("create"),[U,xe]=c.useState(ss()),[Ds,rr]=c.useState(!1),[Ms,Ar]=c.useState(""),[Ts,Pr]=c.useState(""),sr=c.useCallback(async()=>{try{console.log("[PainelSecretaria] Carregando pacientes...");const l=await Xe();console.log("[PainelSecretaria] Resposta pacientes:",l);const f=l.data||[];console.log("[PainelSecretaria] Pacientes recebidos:",f.length),W(f.map(Oa))}catch(l){console.error("Erro ao carregar pacientes:",l),h.error("Erro ao carregar pacientes")}},[]),Dr=c.useCallback(async()=>{try{console.log("[PainelSecretaria] Carregando médicos...");const l=await Ae.listarMedicos();console.log("[PainelSecretaria] Resposta médicos:",l),l.success&&l.data?(console.log("[PainelSecretaria] Médicos recebidos:",l.data.data.length),q(l.data.data)):l.error&&(console.error("[PainelSecretaria] Erro na resposta:",l.error),h.error(l.error))}catch(l){console.error("Erro ao carregar médicos:",l),h.error("Erro ao carregar médicos")}},[]),ha=c.useCallback(async()=>{y(!0);try{const l=await Ua.listarRelatorios();l.success&&l.data?m(l.data):h.error("Erro ao carregar relatórios")}catch(l){console.error("Erro ao carregar relatórios:",l),h.error("Erro ao carregar relatórios")}finally{y(!1)}},[]),ta=c.useCallback(async()=>{ee(!0);try{console.log("[PainelSecretaria] Carregando agendamentos...");const l=await sa.listAppointments();console.log("[PainelSecretaria] Resposta agendamentos:",l),l.success&&l.data?(console.log("[PainelSecretaria] Agendamentos recebidos:",l.data.length),I(l.data)):l.error&&(console.error("[PainelSecretaria] Erro na resposta:",l.error),h.error(l.error))}catch(l){console.error("Erro ao carregar agendamentos:",l),h.error("Erro ao carregar agendamentos")}finally{ee(!1)}},[]),Mr=c.useCallback(async()=>{t(!0);try{await Promise.all([sr(),Dr(),ha(),ta()])}finally{t(!1)}},[sr,Dr,ha,ta]);c.useEffect(()=>{Mr()},[Mr]),c.useEffect(()=>{o==="relatorios"&&ha()},[o,ha]),c.useEffect(()=>{(async()=>{const l=await Ae.listarMedicos({status:"ativo"});l.success&&l.data&&(te(l.data.data),!se&&l.data.data.length&&oe(l.data.data[0].id))})()},[]);const pa=c.useCallback(()=>{ce(rs())},[]),fa=c.useCallback(()=>{xe(ss())},[]),Is=c.useCallback(()=>{console.log("[PainelSecretaria] Fazendo logout..."),r(),h.success("Sessão encerrada"),s("/login-secretaria")},[r,s]),Rs=c.useCallback(()=>{pa(),Sr("create"),Ia(!0)},[pa]),Ls=c.useCallback(l=>{ce(Bo(l)),Sr("edit"),Ia(!0)},[]),Tr=c.useCallback(()=>{Ia(!1)},[]),$s=c.useCallback(()=>{fa(),_r("create"),Ra(!0)},[fa]),Os=c.useCallback(l=>{const f=l;xe({id:l.id,nome:l.nome||"",email:l.email||"",crm:l.crm||"",crmUf:f.crmUf||"",cpf:f.cpf||"",telefone:l.telefone||"",telefone2:f.telefone2||"",especialidade:l.especialidade||"",dataNascimento:f.dataNascimento||"",rg:f.rg||"",cep:f.cep||"",rua:f.rua||"",numero:f.numero||"",complemento:f.complemento||"",bairro:f.bairro||"",cidade:f.cidade||"",estado:f.estado||"",senha:""}),_r("edit"),Ra(!0)},[]),Ir=c.useCallback(()=>{Ra(!1)},[]),qs=c.useCallback(async()=>{if(!$e){h.error("Informe o ID do paciente");return}t(!0);try{const l=await Wa($e);l.success&&l.data?W([Oa(l.data)]):h.error(l.error||"Paciente não encontrado")}catch(l){console.error("Erro ao buscar paciente:",l),h.error("Paciente não encontrado")}finally{t(!1)}},[$e]),Fs=c.useCallback(async l=>{if(window.confirm(`Deseja remover o paciente ${l.nome}?`))try{console.log("[PainelSecretaria] Deletando paciente:",{id:l.id,nome:l.nome});const f=await Ta(l.id);console.log("[PainelSecretaria] Resultado da deleção:",f),f.success?(W(T=>T.filter(F=>F.id!==l.id)),h.success("Paciente removido com sucesso")):(console.error("[PainelSecretaria] Falha ao deletar:",f.error),h.error(f.error||"Erro ao remover paciente"))}catch(f){console.error("[PainelSecretaria] Erro ao remover paciente:",f),h.error("Erro ao remover paciente")}},[]),Us=c.useCallback(async l=>{if(window.confirm(`Deseja remover o médico ${l.nome}?`))try{const f=await Ae.deletarMedico(l.id);f.success?(q(T=>T.filter(F=>F.id!==l.id)),h.success("Médico removido")):f.error&&h.error(f.error)}catch(f){console.error("Erro ao remover médico:",f),h.error("Erro ao remover médico")}},[]),zs=c.useCallback(l=>{const{formatted:f}=wa(l.target.value);ce(T=>({...T,cpf:f}))},[]),Rr=c.useCallback(async l=>{const f=l.replace(/\D/g,"");if(f.length===8)try{const T=await _a(f);if(!T){h.error("CEP não encontrado");return}ce(F=>({...F,endereco:{...F.endereco,rua:T.rua??F.endereco.rua,bairro:T.bairro??F.endereco.bairro,cidade:T.cidade??F.endereco.cidade,estado:T.estado??F.endereco.estado,cep:T.cep??l}}))}catch(T){console.warn("Erro ao buscar CEP:",T),h.error("Erro ao buscar CEP")}},[]),Lr=c.useCallback(async l=>{const f=l.replace(/\D/g,"");if(f.length===8)try{const T=await _a(f);if(!T){h.error("CEP não encontrado");return}xe(F=>({...F,rua:T.rua??F.rua,bairro:T.bairro??F.bairro,cidade:T.cidade??F.cidade,estado:T.estado??F.estado,cep:T.cep??l})),h.success("Endereço preenchido automaticamente!")}catch(T){console.warn("Erro ao buscar CEP:",T),h.error("Erro ao buscar CEP")}},[]),Bs=c.useCallback(async l=>{l.preventDefault();const{digits:f}=wa(B.cpf);t(!0);try{const T=Ps(B.codigoPais,B.ddd,B.numeroTelefone)??B.telefone,F={nome:B.nome,cpf:f,email:B.email,telefone:T,sexo:B.sexo,dataNascimento:B.dataNascimento,tipoSanguineo:B.tipo_sanguineo,convenio:B.convenio,numeroCarteirinha:B.numeroCarteirinha,observacoes:B.observacoes,endereco:B.endereco},be={rg:B.rg,estado_civil:B.estado_civil,profissao:B.profissao,telefoneSecundario:B.telefoneSecundario,telefoneReferencia:B.telefoneReferencia,codigo_legado:B.codigo_legado,responsavel_nome:B.responsavel_nome,responsavel_cpf:B.responsavel_cpf,documentos:B.documentos||[]};try{const pe=localStorage.getItem("pacientes_meta")||"{}",_e=JSON.parse(pe);_e[B.id||f]={..._e[B.id||f]||{},...be,updatedAt:new Date().toISOString()},localStorage.setItem("pacientes_meta",JSON.stringify(_e))}catch{}if(B.altura.trim()&&(F.alturaM=Number(B.altura)),B.peso.trim()&&(F.pesoKg=Number(B.peso)),xa==="create"){const pe=await Da({nome:F.nome||"",cpf:F.cpf||"",email:F.email||"",telefone:F.telefone||"",dataNascimento:F.dataNascimento,socialName:void 0,sexo:F.sexo,tipoSanguineo:F.tipoSanguineo,pesoKg:F.pesoKg,alturaM:F.alturaM,endereco:F.endereco});if(pe.success&&pe.data)W(_e=>[..._e,Oa(pe.data)]),h.success("Paciente cadastrado com sucesso!");else{h.error(pe.error||"Falha ao cadastrar paciente");return}}else if(xa==="edit"&&B.id){const pe=await Ma(B.id,{nome:F.nome||"",cpf:F.cpf||"",email:F.email||"",telefone:F.telefone||"",dataNascimento:F.dataNascimento,socialName:void 0,sexo:F.sexo,tipoSanguineo:F.tipoSanguineo,pesoKg:F.pesoKg,alturaM:F.alturaM,endereco:F.endereco});if(pe.success&&pe.data){const _e=Oa(pe.data);W(Ce=>Ce.map(Oe=>Oe.id===B.id?_e:Oe)),h.success("Paciente atualizado com sucesso!")}else{h.error(pe.error||"Falha ao atualizar paciente");return}}pa(),Ia(!1)}catch(T){console.error("Erro ao salvar paciente:",T),h.error("Erro ao salvar paciente")}finally{t(!1)}},[B,xa,pa]),Hs=c.useCallback(async l=>{l.preventDefault(),t(!0);try{if(We==="create"){const f={nome:U.nome,email:U.email,crm:U.crm,crmUf:U.crmUf,cpf:U.cpf,telefone:U.telefone,telefone2:U.telefone2,especialidade:U.especialidade,dataNascimento:U.dataNascimento,rg:U.rg,cep:U.cep,rua:U.rua,numero:U.numero,complemento:U.complemento,bairro:U.bairro,cidade:U.cidade,estado:U.estado,status:"ativo"},T=await Ae.criarMedico(f);if(T.success&&T.data)q(F=>[...F,T.data]),h.success("Médico cadastrado com sucesso!");else if(T.error){h.error(T.error);return}}else if(We==="edit"&&U.id){const f={nome:U.nome,email:U.email,crm:U.crm,crmUf:U.crmUf,cpf:U.cpf,telefone:U.telefone,telefone2:U.telefone2,especialidade:U.especialidade,dataNascimento:U.dataNascimento,rg:U.rg,cep:U.cep,rua:U.rua,numero:U.numero,complemento:U.complemento,bairro:U.bairro,cidade:U.cidade,estado:U.estado},T=await Ae.atualizarMedico(U.id,f);if(T.success&&T.data)q(F=>F.map(be=>be.id===U.id?T.data:be)),h.success("Médico atualizado com sucesso!");else if(T.error){h.error(T.error);return}}fa(),Ra(!1)}catch(f){console.error("Erro ao salvar médico:",f),h.error("Erro ao salvar médico")}finally{t(!1)}},[We,U,fa]),Vs=c.useMemo(()=>{const l=new Set;return as.forEach(f=>l.add(f)),re.forEach(f=>{const T=f.convenio?.trim();T&&l.add(T)}),Array.from(l).sort((f,T)=>f.localeCompare(T,"pt-BR",{sensitivity:"base"}))},[re]),ba=c.useMemo(()=>{const l=Ne.trim().toLowerCase(),f=Ze.trim().toLowerCase(),T=new Date().getMonth();return re.filter(F=>{const be=F.nome?.toLowerCase()??"",pe=(F.email??"").toLowerCase();if(!(!l||be.includes(l)||pe.includes(l))||!(!f||(F.convenio??"").trim().toLowerCase()===f)||z&&!F.vip)return!1;if(u){if(!F.dataNascimento)return!1;const Oe=new Date(F.dataNascimento);if(Number.isNaN(Oe.getTime())||Oe.getMonth()!==T)return!1}return!0})},[re,Ne,Ze,z,u]),ya=c.useMemo(()=>D.map(l=>Yo(l,re,P)),[D,re,P]);c.useEffect(()=>{const l=new Set(ba.map(T=>T.id)),f={};l.forEach(T=>{const F=ya.filter(Ce=>Ce.pacienteId===T);if(F.length===0){f[T]={ultimo:null,proximo:null};return}const be=new Date,pe=F.filter(Ce=>new Date(Ce.dataHora)<be).sort((Ce,Oe)=>new Date(Oe.dataHora).getTime()-new Date(Ce.dataHora).getTime()),_e=F.filter(Ce=>new Date(Ce.dataHora)>=be).sort((Ce,Oe)=>new Date(Ce.dataHora).getTime()-new Date(Oe.dataHora).getTime());f[T]={ultimo:pe[0]?new Date(pe[0].dataHora).toLocaleDateString("pt-BR",{dateStyle:"short"}):null,proximo:_e[0]?new Date(_e[0].dataHora).toLocaleDateString("pt-BR",{dateStyle:"short"}):null}}),ga(f)},[ba,ya]);const $r=c.useMemo(()=>{const l=Ne.toLowerCase();return P.filter(f=>f.nome.toLowerCase().includes(l)||(f.especialidade??"").toLowerCase().includes(l))},[P,Ne]),Or=c.useMemo(()=>ya.filter(l=>{if(Ne){const f=Ne.toLowerCase();if(!(l.pacienteNome.toLowerCase().includes(f)||l.medicoNome.toLowerCase().includes(f)||l.tipo.toLowerCase().includes(f)))return!1}return w&&l.medicoNome!==w&&l.medicoNome,de&&l.status!==de||ie&&new Date(l.dataHora)<new Date(ie)||Be&&new Date(l.dataHora)>new Date(Be+"T23:59:59")?!1:(G&&l.pacienteNome!==G&&l.pacienteNome,!0)}),[ya,Ne,w,G,de,ie,Be]),Js=async(l,f)=>{try{const F={agendada:"requested",confirmada:"confirmed",cancelada:"cancelled",realizada:"completed",faltou:"no_show"}[f]||"requested",be=await sa.updateAppointment(l,{status:F});be.success?(await ta(),h.success("Status atualizado")):h.error(be.error||"Falha ao atualizar")}catch{h.error("Erro ao atualizar status")}},Gs=async l=>{if(window.confirm("Confirma excluir este agendamento?"))try{const T=await sa.deleteAppointment(l);T.success?(await ta(),h.success("Agendamento excluído")):h.error(T.error||"Falha ao excluir")}catch{h.error("Erro ao excluir")}};return a&&!Te&&!Er&&re.length===0&&P.length===0?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Carregando painel da secretária..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 high-contrast:bg-black",children:[e.jsx("header",{className:"bg-white/90 dark:bg-gray-800/90 high-contrast:bg-black shadow-sm border-b dark:border-gray-700 high-contrast:border-gray-700",children:e.jsxs("div",{className:"max-w-[1600px] mx-auto px-4 sm:px-6 lg:px-8 py-4 flex flex-col gap-4 md:flex-row md:items-center md:justify-between high-contrast:text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white high-contrast:text-black high-contrast:font-extrabold",children:"Painel da Secretária"}),e.jsx("p",{className:"text-gray-600 dark:text-white high-contrast:text-black high-contrast:font-bold",children:"Gerencie pacientes, médicos e consultas"})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("button",{onClick:Rs,className:"bg-green-600 text-white high-contrast:bg-black high-contrast:text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors flex items-center focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-green-500",children:[e.jsx(Se,{className:"w-5 h-5 mr-2"}),"Novo Paciente"]}),e.jsxs("button",{onClick:$s,className:"bg-blue-600 text-white high-contrast:bg-black high-contrast:text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-blue-500",children:[e.jsx(Sa,{className:"w-5 h-5 mr-2"}),"Novo Médico"]}),e.jsx("button",{onClick:Is,className:"bg-red-600 text-white high-contrast:bg-black high-contrast:text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-red-500",children:"Sair"})]})]})}),e.jsx("nav",{className:"bg-white/90 dark:bg-gray-800/90 high-contrast:bg-black border-b dark:border-gray-700 high-contrast:border-gray-700",children:e.jsx("div",{className:"max-w-[1600px] mx-auto px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"flex space-x-2 sm:space-x-4 overflow-x-auto",children:[{id:"dashboard",label:"Dashboard",icon:ms},{id:"pacientes",label:"Pacientes",icon:la},{id:"medicos",label:"Médicos",icon:la},{id:"consultas",label:"Consultas",icon:ve},{id:"agenda",label:"Agenda",icon:ve},{id:"relatorios",label:"Relatórios",icon:ua}].map(l=>{const f=l.icon,T=o===l.id;return e.jsxs("button",{onClick:()=>n(l.id),className:`flex items-center px-3 py-4 border-b-2 font-medium text-sm whitespace-nowrap focus:outline-none focus-visible:ring-2 focus-visible:ring-green-500/50 ${T?"border-green-500 text-green-600 high-contrast:text-white":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 high-contrast:text-white"}`,children:[e.jsx(f,{className:"w-5 h-5 mr-2"}),l.label]},l.id)})})})}),e.jsxs("main",{className:"max-w-[1600px] mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-8",children:[o==="dashboard"&&e.jsxs("section",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow border dark:border-gray-700",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pacientes cadastrados"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:re.length})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow border dark:border-gray-700",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Médicos ativos"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:P.length})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow border dark:border-gray-700",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Consultas programadas"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:ya.length})]})]}),o==="pacientes"&&e.jsx("section",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700 space-y-4",children:[e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(ra,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar pacientes por nome ou email...",value:Ne,onChange:l=>De(l.target.value),className:"pl-10 pr-4 py-2 w-full border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-green-600 focus:border-green-600/40 transition-colors"})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-2",children:[e.jsx("input",{type:"text",placeholder:"Buscar paciente por ID",value:$e,onChange:l=>Ve(l.target.value),className:"border px-3 py-2 rounded-lg w/full md:w-64 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 border-gray-300 dark:border-gray-700 focus:ring-2 focus:ring-green-600 focus:border-green-600/40 transition-colors"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:qs,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-blue-500",children:"Buscar"}),e.jsx("button",{onClick:()=>{De(""),Ve(""),M(""),L(!1),Me(!1),sr()},className:"px-4 py-2 border border-gray-300 dark:border-gray-700 rounded-lg text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-800 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-gray-300 dark:focus-visible:ring-gray-700",children:"Limpar"})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-center lg:justify-between",children:[e.jsxs("div",{className:"flex flex-wrap gap-3 text-sm text-gray-600",children:[e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:u,onChange:l=>L(l.target.checked),className:"rounded border-gray-300 text-green-600 focus:ring-green-500"}),"Aniversariantes do mês"]}),e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:z,onChange:l=>Me(l.target.checked),className:"rounded border-gray-300 text-green-600 focus:ring-green-500"}),"Somente VIP"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",htmlFor:"convenio-filter",children:"Convênio"}),e.jsxs("select",{id:"convenio-filter",value:Ze,onChange:l=>M(l.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-green-600 focus:border-green-600/40 transition-colors",children:[e.jsx("option",{value:"",children:"Todos"}),Vs.map(l=>e.jsx("option",{value:l,children:l},l))]})]})]})]}),e.jsx(Do,{pacientes:ba.map(l=>({id:l.id,nome:l.nome,cpf:l.cpf,email:os(l.email),telefoneFormatado:Ho(l),convenio:l.convenio,vip:l.vip,cidade:l.endereco?.cidade,estado:l.endereco?.estado,ultimoAtendimento:Qe[l.id]?.ultimo??null,proximoAtendimento:Qe[l.id]?.proximo??null})),onEdit:l=>{const f=ba.find(T=>T.id===l.id);f&&Ls(f)},onDelete:l=>{const f=ba.find(T=>T.id===l.id);f&&Fs(f)},onView:l=>{s(`/pacientes/${encodeURIComponent(l.id)}`)},onSchedule:l=>{Ar(l.id),Pr(l.nome),rr(!0)}})]})}),o==="medicos"&&e.jsx("section",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 high-contrast:bg-black rounded-lg shadow border dark:border-gray-700 high-contrast:border-gray-700",children:[e.jsx("div",{className:"p-6 border-b flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(ra,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar médicos por nome ou especialidade...",value:Ne,onChange:l=>De(l.target.value),className:"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700 high-contrast:divide-gray-700",children:[e.jsx("thead",{className:"sticky top-0 z-10 bg-gray-50 dark:bg-gray-900 high-contrast:bg-black",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Médico"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Especialidade"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contato"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),e.jsxs("tbody",{className:"bg-white dark:bg-gray-800 high-contrast:bg-black divide-y divide-gray-200 dark:divide-gray-700 high-contrast:divide-gray-700",children:[$r.map(l=>e.jsxs("tr",{className:"bg-white dark:bg-gray-800 high-contrast:bg-black hover:bg-gray-100 dark:hover:bg-gray-700 high-contrast:hover:bg-gray-900",children:[e.jsxs("td",{className:"px-6 py-4 high-contrast:text-white",children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 high-contrast:text-white",children:["Dr(a). ",l.nome||"Sem nome"]}),e.jsxs("div",{className:"text-sm text-gray-400 dark:text-gray-300 high-contrast:text-white",children:["CRM: ",l.crm||"Não informado"]})]}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-400 dark:text-gray-300 high-contrast:text-white",children:l.especialidade||"Não informado"}),e.jsxs("td",{className:"px-6 py-4 high-contrast:text-white",children:[e.jsx("div",{className:"text-sm text-gray-900 dark:text-gray-100 high-contrast:text-white",children:os(l.email)}),e.jsx("div",{className:"text-sm text-gray-400 dark:text-gray-300 high-contrast:text-white",children:l.telefone||"Telefone não informado"})]}),e.jsxs("td",{className:"px-6 py-4 text-right text-sm font-medium space-x-3",children:[e.jsx("button",{onClick:()=>Os(l),className:"inline-flex items-center px-3 py-1.5 rounded-lg text-indigo-600 hover:text-indigo-900 hover:bg-indigo-50 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-indigo-500",children:"Editar"}),e.jsx("button",{onClick:()=>void Us(l),className:"inline-flex items-center px-3 py-1.5 rounded-lg text-red-600 hover:text-red-900 hover:bg-red-50 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-red-500",children:"Excluir"})]})]},l.id)),$r.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"px-6 py-10 text-center text-sm text-gray-500",children:"Nenhum médico encontrado."})})]})]})})]})}),o==="consultas"&&e.jsxs("section",{className:"bg-white dark:bg-gray-800 high-contrast:bg-black rounded-lg shadow border border-gray-200 dark:border-gray-700 high-contrast:border-gray-700",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700 flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Agendamentos"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>ta(),className:"inline-flex items-center gap-2 bg-gray-100 hover:bg-gray-200 text-gray-800 text-sm font-medium px-4 py-2 rounded focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-gray-300",children:"Atualizar"}),e.jsxs("button",{onClick:()=>{Ar(""),Pr(""),rr(!0)},className:"inline-flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white text-sm font-medium px-4 py-2 rounded focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-green-500","aria-label":"Nova consulta",children:[e.jsx(Se,{className:"w-4 h-4"}),"Nova Consulta"]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ra,{className:"w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Busca rápida (paciente, médico ou tipo)",value:Ne,onChange:l=>De(l.target.value),className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Data de"}),e.jsx("input",{type:"date",value:ie,onChange:l=>he(l.target.value),className:"w-full border border-gray-300 dark:border-gray-700 rounded px-2 py-1 text-sm bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Data até"}),e.jsx("input",{type:"date",value:Be,onChange:l=>He(l.target.value),className:"w-full border border-gray-300 dark:border-gray-700 rounded px-2 py-1 text-sm bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Status"}),e.jsxs("select",{value:de,onChange:l=>we(l.target.value),className:"w-full border border-gray-300 dark:border-gray-700 rounded px-2 py-1 text-sm bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100",children:[e.jsx("option",{value:"",children:"Todos"}),e.jsx("option",{value:"agendada",children:"Agendada"}),e.jsx("option",{value:"confirmada",children:"Confirmada"}),e.jsx("option",{value:"cancelada",children:"Cancelada"}),e.jsx("option",{value:"realizada",children:"Realizada"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Paciente (nome)"}),e.jsx("input",{value:G,onChange:l=>R(l.target.value),className:"w-full border border-gray-300 dark:border-gray-700 rounded px-2 py-1 text-sm bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100",placeholder:"Filtrar paciente"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Médico (nome)"}),e.jsx("input",{value:w,onChange:l=>V(l.target.value),className:"w-full border border-gray-300 dark:border-gray-700 rounded px-2 py-1 text-sm bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100",placeholder:"Filtrar médico"})]})]})]}),e.jsx("div",{className:"p-6",children:K?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):Or.length===0?e.jsx("div",{className:"text-center py-8 text-sm text-gray-500",children:'Nenhum agendamento encontrado. Use a aba "Agenda" para gerenciar horários dos médicos.'}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700 high-contrast:divide-gray-700",children:[e.jsx("thead",{className:"sticky top-0 z-10 bg-gray-50 dark:bg-gray-900 high-contrast:bg-black",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data/Hora"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Paciente"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Médico"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tipo"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 high-contrast:bg-black divide-y divide-gray-200 dark:divide-gray-700 high-contrast:divide-gray-700",children:Or.map(l=>e.jsxs("tr",{className:"bg-white dark:bg-gray-800 high-contrast:bg-black hover:bg-gray-100 dark:hover:bg-gray-700 high-contrast:hover:bg-gray-900",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 high-contrast:text-white",children:Vo(l.dataHora)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 high-contrast:text-white",children:l.pacienteNome}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 high-contrast:text-white",children:l.medicoNome}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 high-contrast:text-white",children:l.tipo}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("select",{value:l.status,onChange:f=>Js(l.id,f.target.value),className:"text-sm border border-gray-300 dark:border-gray-700 high-contrast:border-gray-700 rounded px-2 py-1 bg-white dark:bg-gray-900 high-contrast:bg-black text-gray-900 high-contrast:text-white",children:[e.jsx("option",{value:"agendada",children:"Agendada"}),e.jsx("option",{value:"confirmada",children:"Confirmada"}),e.jsx("option",{value:"cancelada",children:"Cancelada"}),e.jsx("option",{value:"realizada",children:"Realizada"}),e.jsx("option",{value:"faltou",children:"Faltou"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsx("button",{onClick:()=>Gs(l.id),className:"inline-flex items-center px-3 py-1.5 rounded-lg text-red-600 hover:text-red-900 hover:bg-red-50 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-red-500",children:"Excluir"})})]},l.id))})]})})})]}),o==="agenda"&&e.jsxs("section",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Gerenciar Agenda Médica"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Selecionar Médico"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:se,onChange:l=>oe(l.target.value),children:[e.jsx("option",{value:"",children:"-- Selecione um médico --"}),le.map(l=>e.jsxs("option",{value:l.id,children:[l.nome," — ",l.especialidade]},l.id))]})]}),!se&&e.jsx("p",{className:"text-sm text-gray-500 italic",children:"Selecione um médico acima para gerenciar sua disponibilidade e exceções."})]}),se&&e.jsxs(e.Fragment,{children:[e.jsx($o,{doctorId:se}),e.jsx(To,{doctorId:se}),e.jsx(Io,{doctorId:se})]})]}),o==="relatorios"&&e.jsx("section",{className:"bg-white dark:bg-gray-800 high-contrast:bg-black rounded-lg shadow border border-gray-200 dark:border-gray-700 high-contrast:border-gray-700",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Relatórios"}),e.jsxs("button",{onClick:()=>{k("create"),x(null),C({patientId:"",orderNumber:v(),exam:"",diagnosis:"",conclusion:"",dueAt:"",status:"draft"}),g(!0)},className:"inline-flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white text-sm font-medium px-4 py-2 rounded focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-green-500",children:[e.jsx(Se,{className:"w-4 h-4"}),"Novo Relatório"]})]}),b?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):i.length===0?e.jsx("div",{className:"text-center py-8 text-sm text-gray-500",children:"Nenhum relatório encontrado."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700 high-contrast:divide-gray-700",children:[e.jsx("thead",{className:"sticky top-0 z-10 bg-gray-50 dark:bg-gray-900 high-contrast:bg-black",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Número"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Exame"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Paciente"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 high-contrast:bg-black divide-y divide-gray-200 dark:divide-gray-700 high-contrast:divide-gray-700",children:i.map(l=>e.jsxs("tr",{className:"bg-white dark:bg-gray-800 high-contrast:bg-black hover:bg-gray-100 dark:hover:bg-gray-700 high-contrast:hover:bg-gray-900",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 high-contrast:text-white",children:l.order_number}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 high-contrast:text-white",children:l.exam}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 high-contrast:text-white",children:re.find(f=>f.id===l.patient_id)?.nome||l.patient_id}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${l.status==="draft"?"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200 high-contrast:bg-gray-900 high-contrast:text-white":l.status==="completed"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200 high-contrast:bg-green-900 high-contrast:text-white":l.status==="pending"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200 high-contrast:bg-yellow-900 high-contrast:text-white":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200 high-contrast:bg-red-900 high-contrast:text-white"}`,children:l.status==="draft"?"Rascunho":l.status==="completed"?"Concluído":l.status==="pending"?"Pendente":"Cancelado"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:l.created_at?new Date(l.created_at).toLocaleDateString("pt-BR"):"-"}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right space-x-3",children:[e.jsx("button",{onClick:()=>ae(l.id),className:"inline-flex items-center px-3 py-1.5 rounded-lg text-blue-600 hover:text-blue-800 hover:bg-blue-50 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-blue-500",children:"Ver detalhes"}),e.jsx("button",{onClick:async()=>{if(!l.id)return;k("edit"),x(l.id);const f=await Ua.buscarRelatorioPorId(l.id);if(f.success&&f.data){const T=f.data;C({patientId:T.patient_id||"",orderNumber:T.order_number||"",exam:T.exam||"",diagnosis:T.diagnosis||"",conclusion:T.conclusion||"",dueAt:T.due_at?T.due_at.slice(0,10):"",status:T.status&&["draft","pending","completed","cancelled"].includes(T.status)?T.status:"draft"}),g(!0)}else h.error(f.error||"Erro ao carregar relatório")},className:"inline-flex items-center px-3 py-1.5 rounded-lg text-indigo-600 hover:text-indigo-800 hover:bg-indigo-50 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-indigo-500",children:"Editar"})]})]},l.id))})]})})]})})]}),Te&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",role:"dialog","aria-modal":"true","aria-labelledby":"patient-modal-title",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-3xl w-full max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{id:"patient-modal-title",className:"text-lg font-semibold",children:xa==="create"?"Cadastrar Novo Paciente":"Editar Paciente"}),e.jsx("button",{onClick:Tr,className:"text-gray-400 hover:text-gray-600 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-gray-400","aria-label":"Fechar modal",children:e.jsx(Fe,{className:"w-6 h-6"})})]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Preencha todos os campos obrigatórios (*)"})]}),e.jsx("div",{className:"p-6 overflow-y-auto flex-1",children:e.jsxs("form",{onSubmit:Bs,className:"space-y-4 max-h-[70vh] overflow-y-auto px-1",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-sm font-semibold text-green-600 uppercase tracking-wide border-b pb-1",children:"Dados Pessoais"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome Completo *"}),e.jsx("input",{type:"text",value:B.nome,onChange:l=>ce(f=>({...f,nome:l.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",required:!0,placeholder:"Maria Santos Silva"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome Social"}),e.jsx("input",{type:"text",value:B.social_name,onChange:l=>ce(f=>({...f,social_name:l.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Maria Santos"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"CPF *"}),e.jsx("input",{type:"text",value:B.cpf,onChange:zs,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",required:!0,placeholder:"000.000.000-00",maxLength:14})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data de Nascimento *"}),e.jsx("input",{type:"date",value:B.dataNascimento,onChange:l=>ce(f=>({...f,dataNascimento:l.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sexo *"}),e.jsxs("select",{value:B.sexo,onChange:l=>ce(f=>({...f,sexo:l.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"",children:"Selecione"}),e.jsx("option",{value:"M",children:"Masculino"}),e.jsx("option",{value:"F",children:"Feminino"}),e.jsx("option",{value:"outro",children:"Outro"})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-sm font-semibold text-green-600 uppercase tracking-wide border-b pb-1",children:"Contato"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email *"}),e.jsx("input",{type:"email",value:B.email,onChange:l=>ce(f=>({...f,email:l.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",required:!0,placeholder:"maria@email.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Telefone Celular *"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("select",{value:B.codigoPais,onChange:l=>ce(f=>({...f,codigoPais:l.target.value})),className:"w-24 px-2 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-sm",required:!0,children:Fo.map(l=>e.jsx("option",{value:l.value,children:l.label},l.value))}),e.jsx("input",{type:"text",value:B.ddd,onChange:l=>ce(f=>({...f,ddd:l.target.value.replace(/\D/g,"").slice(0,2)})),className:"w-16 px-2 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-sm text-center",placeholder:"11",required:!0}),e.jsx("input",{type:"tel",value:B.numeroTelefone,onChange:l=>ce(f=>({...f,numeroTelefone:l.target.value.replace(/\D/g,"").slice(0,9)})),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"99999-9999",required:!0})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-sm font-semibold text-green-600 uppercase tracking-wide border-b pb-1",children:"Informações Clínicas"}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tipo Sanguíneo"}),e.jsxs("select",{value:B.tipo_sanguineo,onChange:l=>ce(f=>({...f,tipo_sanguineo:l.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Selecione"}),qo.map(l=>e.jsx("option",{value:l,children:l},l))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Peso (kg)"}),e.jsx("input",{type:"number",min:"10",max:"300",step:"0.1",value:B.peso,onChange:l=>ce(f=>({...f,peso:l.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"65.5"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Altura (m)"}),e.jsx("input",{type:"number",min:"0.5",max:"2.5",step:"0.01",value:B.altura,onChange:l=>ce(f=>({...f,altura:l.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"1.65"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Convênio"}),e.jsxs("select",{value:B.convenio,onChange:l=>ce(f=>({...f,convenio:l.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Selecione"}),as.map(l=>e.jsx("option",{value:l,children:l},l))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Número da Carteirinha"}),e.jsx("input",{type:"text",value:B.numeroCarteirinha,onChange:l=>ce(f=>({...f,numeroCarteirinha:l.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Número da carteirinha"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-sm font-semibold text-green-600 uppercase tracking-wide border-b pb-1",children:"Endereço"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"CEP"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:ts(B.endereco.cep||""),onChange:l=>{const f=l.target.value.replace(/\D/g,"").slice(0,8);ce(T=>({...T,endereco:{...T.endereco,cep:f}}))},onBlur:l=>{const f=l.target.value.replace(/\D/g,"");f.length===8&&Rr(f)},className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"01234-567",maxLength:9}),e.jsx("button",{type:"button",onClick:()=>Rr(B.endereco.cep||""),className:"px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors shadow-sm hover:shadow-md",title:"Buscar endereço pelo CEP",children:e.jsx("span",{className:"text-lg",children:"✓"})})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rua"}),e.jsx("input",{type:"text",value:B.endereco.rua,onChange:l=>ce(f=>({...f,endereco:{...f.endereco,rua:l.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Rua das Flores"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Número"}),e.jsx("input",{type:"text",value:B.endereco.numero,onChange:l=>ce(f=>({...f,endereco:{...f.endereco,numero:l.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"123"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bairro"}),e.jsx("input",{type:"text",value:B.endereco.bairro,onChange:l=>ce(f=>({...f,endereco:{...f.endereco,bairro:l.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Centro"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cidade"}),e.jsx("input",{type:"text",value:B.endereco.cidade,onChange:l=>ce(f=>({...f,endereco:{...f.endereco,cidade:l.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"São Paulo"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Estado"}),e.jsx("input",{type:"text",value:B.endereco.estado,onChange:l=>ce(f=>({...f,endereco:{...f.endereco,estado:l.target.value.toUpperCase()}})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"SP",maxLength:2})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Complemento"}),e.jsx("input",{type:"text",value:B.endereco.complemento,onChange:l=>ce(f=>({...f,endereco:{...f.endereco,complemento:l.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Apto 45, Bloco B..."})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-500 uppercase tracking-wide border-b pb-1",children:"Observações Adicionais"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Observações"}),e.jsx("textarea",{value:B.observacoes,onChange:l=>ce(f=>({...f,observacoes:l.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",rows:3,placeholder:"Observações gerais sobre o paciente..."})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t mt-6 sticky bottom-0 bg-white",children:[e.jsx("button",{type:"button",onClick:()=>{pa(),Tr()},className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-gray-300",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:a,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-green-500",children:a?"Salvando...":xa==="create"?"Cadastrar Paciente":"Salvar Alterações"})]})]})})]})}),d&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",role:"dialog","aria-modal":"true","aria-labelledby":"report-modal-title",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[e.jsx("h3",{id:"report-modal-title",className:"text-lg font-semibold",children:S==="create"?"Novo Relatório":"Editar Relatório"}),e.jsx("button",{onClick:()=>g(!1),className:"text-gray-400 hover:text-gray-600 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-gray-400","aria-label":"Fechar modal",children:e.jsx(Fe,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:async l=>{if(l.preventDefault(),!j.patientId){h.error("Selecione o paciente");return}if(!j.orderNumber.trim()){h.error("Informe o número do pedido");return}if(!$.test(j.orderNumber.trim())){h.error("Formato inválido. Use REL-YYYY-MM-XXXXXX (ex.: REL-2025-10-MUS3TN)");return}E(!0);const f=j.dueAt?`${j.dueAt}T00:00:00`:void 0,T=S==="create"?await Zr.createReport({patientId:j.patientId,orderNumber:j.orderNumber,exam:j.exam||void 0,diagnosis:j.diagnosis||void 0,conclusion:j.conclusion||void 0,dueAt:f,status:j.status}):N?await Zr.updateReport(N,{patientId:j.patientId,orderNumber:j.orderNumber,exam:j.exam||void 0,diagnosis:j.diagnosis||void 0,conclusion:j.conclusion||void 0,dueAt:f,status:j.status}):{success:!1,error:"ID inválido"};E(!1),T.success?(h.success(S==="create"?"Relatório criado":"Relatório atualizado"),g(!1),x(null),await ha()):h.error(T.error||"Erro ao criar relatório")},className:"p-6 space-y-4 overflow-y-auto",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Paciente *"}),e.jsxs("select",{value:j.patientId,onChange:l=>C(f=>({...f,patientId:l.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"",children:"-- Selecione --"}),re.map(l=>e.jsx("option",{value:l.id,children:l.nome},l.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Número do Pedido *"}),e.jsx("input",{type:"text",value:j.orderNumber,onChange:l=>C(f=>({...f,orderNumber:l.target.value.toUpperCase()})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",required:!0,placeholder:"Ex: REL-2025-10-MUS3TN",pattern:"^REL-\\d{4}-\\d{2}-[A-Z0-9]{6}$",title:"Formato: REL-YYYY-MM-XXXXXX (ex.: REL-2025-10-MUS3TN)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Exame"}),e.jsx("input",{type:"text",value:j.exam,onChange:l=>C(f=>({...f,exam:l.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Ex: Hemograma"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Prazo (Data)"}),e.jsx("input",{type:"date",value:j.dueAt,onChange:l=>C(f=>({...f,dueAt:l.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Diagnóstico"}),e.jsx("textarea",{value:j.diagnosis,onChange:l=>C(f=>({...f,diagnosis:l.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Conclusão"}),e.jsx("textarea",{value:j.conclusion,onChange:l=>C(f=>({...f,conclusion:l.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),e.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[e.jsx("button",{type:"button",onClick:()=>g(!1),className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-gray-300",disabled:p,children:"Cancelar"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-green-500",disabled:p,children:p?"Salvando...":S==="create"?"Criar Relatório":"Salvar Alterações"})]})]})]})}),Z&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",role:"dialog","aria-modal":"true","aria-labelledby":"report-details-title",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[e.jsx("h3",{id:"report-details-title",className:"text-lg font-semibold",children:"Detalhes do Relatório"}),e.jsx("button",{onClick:()=>_(!1),className:"text-gray-400 hover:text-gray-600 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-gray-400","aria-label":"Fechar modal",children:e.jsx(Fe,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"p-6 space-y-4",children:O?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):A?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Número"}),e.jsx("div",{className:"text-sm font-medium",children:A.order_number||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Paciente"}),e.jsx("div",{className:"text-sm font-medium",children:re.find(l=>l.id===A.patient_id)?.nome||A.patient_id||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Status"}),e.jsx("div",{className:"text-sm font-medium capitalize",children:A.status||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Prazo"}),e.jsx("div",{className:"text-sm font-medium",children:A.due_at?new Date(A.due_at).toLocaleDateString("pt-BR"):"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Criado em"}),e.jsx("div",{className:"text-sm font-medium",children:A.created_at?new Date(A.created_at).toLocaleString("pt-BR"):"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Atualizado em"}),e.jsx("div",{className:"text-sm font-medium",children:A.updated_at?new Date(A.updated_at).toLocaleString("pt-BR"):"-"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Exame"}),e.jsx("div",{className:"text-sm",children:A.exam||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"CID"}),e.jsx("div",{className:"text-sm",children:A.cid_code||"-"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Diagnóstico"}),e.jsx("div",{className:"text-sm whitespace-pre-wrap",children:A.diagnosis||"-"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Conclusão"}),e.jsx("div",{className:"text-sm whitespace-pre-wrap",children:A.conclusion||"-"})]})]}),A.content_html&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Conteúdo"}),e.jsx("div",{className:"prose max-w-none border rounded p-3 bg-gray-50",dangerouslySetInnerHTML:{__html:A.content_html}})]}),A.content_json&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Conteúdo (JSON)"}),e.jsx("pre",{className:"text-xs bg-gray-100 p-3 rounded overflow-auto",children:JSON.stringify(A.content_json,null,2)})]})]}):e.jsx("div",{className:"text-center text-sm text-gray-500 py-8",children:"Relatório não encontrado."})}),e.jsx("div",{className:"p-6 border-t flex justify-end",children:e.jsx("button",{onClick:()=>_(!1),className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-gray-500",children:"Fechar"})})]})}),Er&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",role:"dialog","aria-modal":"true","aria-labelledby":"doctor-modal-title",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{id:"doctor-modal-title",className:"text-lg font-semibold",children:We==="create"?"Cadastrar Novo Médico":"Editar Médico"}),e.jsx("button",{onClick:Ir,className:"text-gray-400 hover:text-gray-600 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-gray-400","aria-label":"Fechar modal",children:e.jsx(Fe,{className:"w-6 h-6"})})]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Preencha todos os campos obrigatórios (*)"})]}),e.jsx("div",{className:"p-6 overflow-y-auto flex-1",children:e.jsxs("form",{onSubmit:Hs,className:"space-y-4 max-h-[70vh] overflow-y-auto px-1",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-sm font-semibold text-blue-600 uppercase tracking-wide border-b pb-1",children:"Dados Pessoais"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome Completo *"}),e.jsx("input",{type:"text",value:U.nome,onChange:l=>xe(f=>({...f,nome:l.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,placeholder:"Dr. João da Silva"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"CPF *"}),e.jsx("input",{type:"text",value:wa(U.cpf).formatted,onChange:l=>{const{digits:f}=wa(l.target.value);xe(T=>({...T,cpf:f}))},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,placeholder:"000.000.000-00",maxLength:14})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"RG"}),e.jsx("input",{type:"text",value:U.rg,onChange:l=>xe(f=>({...f,rg:l.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"00.000.000-0"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data de Nascimento *"}),e.jsx("input",{type:"date",value:U.dataNascimento,onChange:l=>xe(f=>({...f,dataNascimento:l.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-sm font-semibold text-blue-600 uppercase tracking-wide border-b pb-1",children:"Dados Profissionais"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"CRM *"}),e.jsx("input",{type:"text",value:U.crm,onChange:l=>xe(f=>({...f,crm:l.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,placeholder:"123456"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"UF do CRM *"}),e.jsxs("select",{value:U.crmUf,onChange:l=>xe(f=>({...f,crmUf:l.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"",children:"Selecione"}),["AC","AL","AP","AM","BA","CE","DF","ES","GO","MA","MT","MS","MG","PA","PB","PR","PE","PI","RJ","RN","RS","RO","RR","SC","SP","SE","TO"].map(l=>e.jsx("option",{value:l,children:l},l))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Especialidade *"}),e.jsxs("select",{value:U.especialidade,onChange:l=>xe(f=>({...f,especialidade:l.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"",children:"Selecione"}),["Cardiologia","Dermatologia","Endocrinologia","Gastroenterologia","Ginecologia","Neurologia","Ortopedia","Pediatria","Psiquiatria","Clínico Geral"].map(l=>e.jsx("option",{value:l,children:l},l))]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-sm font-semibold text-blue-600 uppercase tracking-wide border-b pb-1",children:"Contato"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email *"}),e.jsx("input",{type:"email",value:U.email,onChange:l=>xe(f=>({...f,email:l.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,placeholder:"medico@email.com"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Telefone Principal *"}),e.jsx("input",{type:"tel",value:U.telefone,onChange:l=>xe(f=>({...f,telefone:Jo(l.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,placeholder:"(11) 99999-9999"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Telefone Secundário"}),e.jsx("input",{type:"tel",value:U.telefone2,onChange:l=>xe(f=>({...f,telefone2:l.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"(11) 3333-4444"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-sm font-semibold text-blue-600 uppercase tracking-wide border-b pb-1",children:"Endereço"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"CEP *"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:ts(U.cep),onChange:l=>{const f=l.target.value.replace(/\D/g,"").slice(0,8);xe(T=>({...T,cep:f}))},onBlur:l=>{const f=l.target.value.replace(/\D/g,"");f.length===8&&Lr(f)},className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"00000-000",required:!0,maxLength:9}),e.jsx("button",{type:"button",onClick:()=>Lr(U.cep),className:"px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors shadow-sm hover:shadow-md",title:"Buscar endereço pelo CEP",children:e.jsx("span",{className:"text-lg",children:"✓"})})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rua *"}),e.jsx("input",{type:"text",value:U.rua,onChange:l=>xe(f=>({...f,rua:l.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Nome da rua",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Número *"}),e.jsx("input",{type:"text",value:U.numero,onChange:l=>xe(f=>({...f,numero:l.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"123",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bairro *"}),e.jsx("input",{type:"text",value:U.bairro,onChange:l=>xe(f=>({...f,bairro:l.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Bairro",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cidade *"}),e.jsx("input",{type:"text",value:U.cidade,onChange:l=>xe(f=>({...f,cidade:l.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Cidade",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Estado *"}),e.jsx("input",{type:"text",value:U.estado,onChange:l=>xe(f=>({...f,estado:l.target.value.toUpperCase()})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"UF",maxLength:2,required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Complemento"}),e.jsx("input",{type:"text",value:U.complemento,onChange:l=>xe(f=>({...f,complemento:l.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Apto, sala, bloco..."})]})]}),We==="create"&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-sm font-semibold text-blue-600 uppercase tracking-wide border-b pb-1",children:"Acesso ao Sistema"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Senha Provisória *"}),e.jsx("input",{type:"password",value:U.senha,onChange:l=>xe(f=>({...f,senha:l.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,minLength:6,placeholder:"Mínimo 6 caracteres"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"O médico deverá alterar esta senha no primeiro acesso"})]})]}),We==="edit"&&e.jsx("div",{className:"bg-yellow-50 p-3 rounded-lg text-sm text-yellow-800",children:"A senha permanece inalterada neste fluxo. Se necessário, solicite redefinição pelo suporte."}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t mt-6 sticky bottom-0 bg-white",children:[e.jsx("button",{type:"button",onClick:()=>{fa(),Ir()},className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-gray-300",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:a,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-blue-500",children:a?"Salvando...":We==="create"?"Cadastrar Médico":"Salvar Alterações"})]})]})})]})}),e.jsx(Oo,{isOpen:Ds,onClose:()=>rr(!1),patientId:Ms,patientName:Ts,onSuccess:()=>{ta()}})]})},Xo=()=>{const{id:s}=Xs(),r=je(),[a,t]=c.useState(!0),[o,n]=c.useState(null),[i,m]=c.useState(null),[b,y]=c.useState([]),[d,g]=c.useState([]),[p,E]=c.useState("resumo"),[j,C]=c.useState([]),[S,k]=c.useState(!1);c.useEffect(()=>{let A=!0;return(async()=>{if(s){t(!0);try{const ae=await Wa(s);if(!A)return;if(ae.success&&ae.data)n(ae.data);else throw new Error(ae.error||"Paciente não encontrado");try{const le=localStorage.getItem("pacientes_meta")||"{}",te=JSON.parse(le);m(te[s]||null)}catch{m(null)}const se=await Aa.listarPorPaciente(s,{limit:20});se.success&&se.data&&y(se.data);try{const le=await Nr(s);g(le)}catch{console.warn("Falha ao carregar anexos")}const oe=localStorage.getItem(`paciente_hist_${s}`)||"[]";try{C(JSON.parse(oe))}catch{C([])}}catch{h.error("Paciente não encontrado"),r("/painel-secretaria")}finally{A&&t(!1)}}})(),()=>{A=!1}},[s,r]);const N=c.useMemo(()=>[...b].sort((A,X)=>X.dataHora.localeCompare(A.dataHora)),[b]),x=N.find(()=>!0),v=c.useMemo(()=>{const A=new Date().toISOString();return N.filter(X=>X.dataHora>=A).sort((X,ae)=>X.dataHora.localeCompare(ae.dataHora))[0]},[N]),$=c.useMemo(()=>{if(!o?.dataNascimento)return null;const A=new Date(o.dataNascimento);if(Number.isNaN(A.getTime()))return null;const X=Date.now()-A.getTime();return Math.floor(X/(1e3*60*60*24*365.25))},[o?.dataNascimento]),Z=async A=>{if(!s)return;const X=A.target.files;if(!(!X||X.length===0)){k(!0);try{for(const ae of Array.from(X)){const se=await wr(s,ae);g(oe=>[...oe,se])}h.success("Anexo(s) enviado(s) com sucesso")}catch{h.error("Falha ao enviar anexo")}finally{k(!1),A.target.value=""}}},_=async A=>{if(s&&confirm(`Remover anexo "${A.nome||A.id}"?`))try{await kr(s,A.id),g(X=>X.filter(ae=>ae.id!==A.id)),h.success("Anexo removido")}catch{h.error("Erro ao remover anexo")}},O=A=>{if(!A)return"—";const X=new Date(A);return Number.isNaN(X.getTime())?A:new Intl.DateTimeFormat("pt-BR",{dateStyle:"short",timeStyle:"short"}).format(X)},H=({id:A,label:X})=>e.jsx("button",{onClick:()=>E(A),className:`px-4 py-2 text-sm font-medium border-b-2 -mb-px transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 rounded-t ${p===A?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:X});return a?e.jsxs("div",{className:"space-y-4",children:[e.jsx("button",{className:"text-sm text-gray-500 hover:underline",onClick:()=>r(-1),children:"← Voltar"}),e.jsx("div",{className:"animate-pulse h-6 bg-gray-200 w-40 rounded"}),e.jsx("div",{className:"animate-pulse h-4 bg-gray-200 w-full rounded"}),e.jsx("div",{className:"animate-pulse h-4 bg-gray-200 w-2/3 rounded"})]}):o?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("button",{className:"text-sm text-gray-500 hover:underline",onClick:()=>r(-1),children:"← Voltar"}),e.jsxs("h1",{className:"text-2xl font-semibold mt-1",children:["Prontuário: ",o.nome]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["CPF: ",o.cpf||"—"," ",$?`• ${$} anos`:""]})]})}),e.jsxs("div",{className:"flex space-x-2 border-b",children:[e.jsx(H,{id:"resumo",label:"Resumo"}),e.jsx(H,{id:"dados",label:"Dados"}),e.jsx(H,{id:"consultas",label:"Consultas"}),e.jsx(H,{id:"anexos",label:"Anexos"}),e.jsx(H,{id:"historico",label:"Histórico"})]}),p==="resumo"&&e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"p-4 bg-white rounded-xl shadow border border-gray-200",children:[e.jsx("h2",{className:"font-semibold mb-3",children:"Visão Geral"}),e.jsxs("ul",{className:"text-sm space-y-1",children:[e.jsxs("li",{children:["Última consulta: ",O(x?.dataHora)]}),e.jsxs("li",{children:["Próxima consulta: ",O(v?.dataHora)]}),e.jsxs("li",{children:["Convênio: ",o.convenio||"Particular"]}),e.jsxs("li",{children:["VIP: ",o.vip?"Sim":"Não"]}),e.jsxs("li",{children:["Tipo sanguíneo: ",o.tipoSanguineo||"—"]})]})]}),e.jsxs("div",{className:"p-4 bg-white rounded-xl shadow border border-gray-200",children:[e.jsx("h2",{className:"font-semibold mb-3",children:"Contato"}),e.jsxs("ul",{className:"text-sm space-y-1",children:[e.jsxs("li",{children:["Email: ",o.email||"—"]}),e.jsxs("li",{children:["Telefone: ",o.telefone||"—"]}),e.jsxs("li",{children:["Endereço:"," ",o.endereco?.rua?`${o.endereco.rua}, ${o.endereco.numero||"s/n"} - ${o.endereco.bairro||""}`:"—"]}),e.jsxs("li",{children:["Cidade/UF: ",o.endereco?.cidade||"",o.endereco?.estado?`/${o.endereco.estado}`:""]})]})]})]}),p==="dados"&&e.jsxs("div",{className:"p-4 bg-white rounded-xl shadow border border-gray-200 space-y-4",children:[e.jsx("h2",{className:"font-semibold",children:"Dados Completos"}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"RG"}),e.jsx("p",{children:i?.rg||"—"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Estado Civil"}),e.jsx("p",{children:i?.estado_civil||"—"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Profissão"}),e.jsx("p",{children:i?.profissao||"—"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Responsável"}),e.jsx("p",{children:i?.responsavel_nome||"—"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Responsável CPF"}),e.jsx("p",{children:i?.responsavel_cpf||"—"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Código Legado"}),e.jsx("p",{children:i?.codigo_legado||"—"})]}),e.jsxs("div",{className:"md:col-span-3",children:[e.jsx("p",{className:"text-gray-500 mb-1",children:"Documentos Extras"}),i?.documentos&&i.documentos.length>0?e.jsx("ul",{className:"list-disc pl-5 space-y-1",children:i.documentos.map((A,X)=>e.jsxs("li",{children:[A.tipo,": ",A.numero]},X))}):e.jsx("p",{children:"—"})]})]})]}),p==="consultas"&&e.jsxs("div",{className:"p-4 bg-white rounded-xl shadow border border-gray-200",children:[e.jsx("h2",{className:"font-semibold mb-4",children:"Consultas"}),N.length===0&&e.jsx("p",{className:"text-sm text-gray-500",children:"Nenhuma consulta encontrada."}),e.jsx("ul",{className:"divide-y",children:N.map(A=>e.jsxs("li",{className:"py-3 flex items-center justify-between text-sm",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:[O(A.dataHora)," ",A.tipo&&`• ${A.tipo}`]}),e.jsxs("p",{className:"text-gray-500",children:["Status: ",A.status]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"text-blue-600 hover:underline text-xs",children:"Detalhes"}),e.jsx("button",{className:"text-red-600 hover:underline text-xs",children:"Cancelar"})]})]},A.id))})]}),p==="anexos"&&e.jsxs("div",{className:"p-4 bg-white rounded-xl shadow border border-gray-200 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"font-semibold",children:"Anexos"}),e.jsxs("label",{className:"text-sm bg-blue-600 text-white px-3 py-1 rounded cursor-pointer hover:bg-blue-700 focus-within:outline-none focus-within:ring-2 focus-within:ring-blue-500 focus-within:ring-offset-2",children:[S?"Enviando...":"Enviar Arquivos",e.jsx("input",{type:"file",multiple:!0,className:"hidden",onChange:Z,disabled:S})]})]}),d.length===0&&e.jsx("p",{className:"text-sm text-gray-500",children:"Nenhum anexo."}),e.jsx("ul",{className:"divide-y",children:d.map(A=>e.jsxs("li",{className:"py-3 flex items-center justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:A.nome||A.id}),e.jsxs("p",{className:"text-gray-500 text-xs",children:[A.tipo||A.categoria||"arquivo"," ",A.tamanho?`• ${(A.tamanho/1024).toFixed(1)} KB`:""]})]}),e.jsxs("div",{className:"flex gap-3",children:[A.url&&e.jsx("a",{href:A.url,target:"_blank",rel:"noreferrer",className:"text-blue-600 hover:underline focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 rounded",children:"Abrir"}),e.jsx("button",{onClick:()=>_(A),className:"text-red-600 hover:underline focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-red-500 focus-visible:ring-offset-2 rounded",children:"Remover"})]})]},A.id))})]}),p==="historico"&&e.jsxs("div",{className:"p-4 bg-white rounded-xl shadow border border-gray-200",children:[e.jsx("h2",{className:"font-semibold mb-4",children:"Histórico de Alterações (Local)"}),j.length===0&&e.jsx("p",{className:"text-sm text-gray-500",children:"Nenhum registro ainda."}),e.jsx("ul",{className:"divide-y",children:j.map(A=>e.jsxs("li",{className:"py-3 text-sm",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:A.campo})," alterado"," ",A.de?`de "${A.de}" `:"",'para "',A.para,'"']}),e.jsxs("p",{className:"text-xs text-gray-500",children:[O(A.data)," ",A.usuario&&`• ${A.usuario}`]})]},A.id))})]})]}):null},ns=s=>s?new Date(s*1e3).toLocaleString():"-",Qo=()=>{const[s,r]=c.useState(""),[a,t]=c.useState(null),[o,n]=c.useState(!1),[i,m]=c.useState(null),b=()=>{const j=localStorage.getItem("authToken");r(j),t(j?ma(j):null)};c.useEffect(()=>{b()},[]);const y=async()=>{n(!0),m(null);const j=await Ee.refreshToken();j.success||m(j.error||"Falha ao renovar"),b(),n(!1)},d=a?.payload,g=a?.expired,p=d?.exp,E=d?.iat;return e.jsxs("div",{className:"max-w-3xl mx-auto space-y-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Token Inspector"}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Token atual (localStorage: authToken)"}),e.jsx("button",{onClick:b,"aria-label":"Recarregar token do localStorage",className:"text-xs px-3 py-1 rounded bg-gray-100 hover:bg-gray-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-400 focus-visible:ring-offset-2",children:"Recarregar"})]}),e.jsx("textarea",{className:"w-full text-xs font-mono border rounded p-2 h-32",readOnly:!0,value:s||""}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:`p-3 rounded border ${g?"border-red-300 bg-red-50":"border-green-300 bg-green-50"}`,children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",a?g?"EXPIRADO":"VÁLIDO":"SEM TOKEN"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Expiração:"})," ",ns(p)]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Emitido:"})," ",ns(E)]}),p&&e.jsxs("p",{children:[e.jsx("strong",{children:"TTL restante (s):"})," ",Math.max(0,p-Math.floor(Date.now()/1e3))]})]}),e.jsxs("div",{className:"p-3 rounded border bg-gray-50",children:[e.jsx("p",{className:"font-semibold mb-1",children:"Claims Principais"}),e.jsx("pre",{className:"text-[11px] whitespace-pre-wrap leading-tight",children:JSON.stringify(d,null,2)})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:y,disabled:o,className:"px-4 py-2 rounded bg-indigo-600 text-white text-sm disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500 focus-visible:ring-offset-2",children:o?"Renovando...":"Forçar Refresh"}),e.jsx("button",{onClick:()=>{Ee.logout(),b()},className:"px-4 py-2 rounded bg-gray-200 text-sm hover:bg-gray-300 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-400 focus-visible:ring-offset-2","aria-label":"Fazer logout e limpar token",children:"Logout"}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(s||"")},disabled:!s,className:"px-4 py-2 rounded bg-blue-100 text-blue-700 text-sm disabled:opacity-40 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-400 focus-visible:ring-offset-2","aria-label":"Copiar token para a área de transferência",children:"Copiar"})]}),i&&e.jsx("p",{className:"text-sm text-red-600",children:i})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Página apenas para depuração em desenvolvimento. Remover antes de produção."})]})};function Zo(){const[s,r]=c.useState([]),[a,t]=c.useState([]),o=c.useCallback(d=>{t(g=>[...g,`[${new Date().toLocaleTimeString()}] ${d}`])},[]),n=d=>{try{const g=d.split(".");if(g.length!==3)return{valid:!1};const p=JSON.parse(atob(g[1])),E=Math.floor(Date.now()/1e3);return{valid:!0,expired:p.exp?p.exp<E:!1,exp:p.exp,sub:p.sub,email:p.email,role:p.role}}catch{return{valid:!1}}},i=c.useCallback(()=>{const g=["authToken","token","refreshToken","authUser","appSession"].map(p=>{const E=localStorage.getItem(p);if(!E)return{key:p,present:!1};const j={key:p,present:!0,value:E,preview:E.length>100?E.substring(0,100)+"...":E};return(p==="authToken"||p==="token")&&(j.decoded=n(E)),j});r(g),o("Tokens escaneados")},[o]),m=()=>{let d=0;s.forEach(g=>{g.decoded?.expired&&(localStorage.removeItem(g.key),d++,o(`❌ Removido: ${g.key} (expirado)`))}),o(d===0?"✅ Nenhum token expirado encontrado":`✅ ${d} token(s) expirado(s) removido(s)`),i()},b=()=>{["authToken","token","refreshToken","authUser","appSession"].forEach(g=>localStorage.removeItem(g)),o("🗑️ TODOS os tokens removidos"),i()},y=async()=>{o("🔐 Testando login...");try{const d=await fetch("https://yuanqfswhberkoevtmfr.supabase.co/auth/v1/token?grant_type=password",{method:"POST",headers:{"Content-Type":"application/json",apikey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inl1YW5xZnN3aGJlcmtvZXZ0bWZyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ5NTQzNjksImV4cCI6MjA3MDUzMDM2OX0.g8Fm4XAvtX46zifBZnYVH4tVuQkqUH6Ia9CXQj4DztQ"},body:JSON.stringify({email:"riseup@popcode.com.br",password:"riseup"})});if(d.ok){const g=await d.json();localStorage.setItem("authToken",g.access_token),localStorage.setItem("refreshToken",g.refresh_token),localStorage.setItem("authUser",JSON.stringify(g.user)),o(`✅ Login OK! Token salvo. exp=${n(g.access_token).exp}`),i()}else{const g=await d.text();o(`❌ Login falhou: ${d.status} ${g}`)}}catch(d){o(`❌ Erro: ${d}`)}};return c.useEffect(()=>{i(),o("Página de diagnóstico carregada")},[i,o]),e.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-6",children:"🔧 Admin - Diagnóstico de Autenticação"}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Ações"}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx("button",{onClick:i,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2",children:"🔄 Escanear Tokens"}),e.jsx("button",{onClick:m,className:"px-4 py-2 bg-yellow-600 text-white rounded hover:bg-yellow-700 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-yellow-500 focus-visible:ring-offset-2",children:"🧹 Limpar Expirados"}),e.jsx("button",{onClick:b,className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-red-500 focus-visible:ring-offset-2",children:"🗑️ Limpar TODOS"}),e.jsx("button",{onClick:y,className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-green-500 focus-visible:ring-offset-2",children:"🔐 Testar Login Admin"}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-500 focus-visible:ring-offset-2",children:"♻️ Recarregar Página"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Tokens no localStorage"}),e.jsxs("div",{className:"space-y-4",role:"list","aria-label":"Lista de tokens no armazenamento local",children:[s.length===0&&e.jsx("p",{className:"text-gray-500",children:"Nenhum token encontrado"}),s.map(d=>e.jsxs("div",{role:"listitem",className:`p-4 rounded border-2 ${d.present?d.decoded?.expired?"border-red-300 bg-red-50":d.decoded?.valid?"border-green-300 bg-green-50":"border-blue-300 bg-blue-50":"border-gray-300 bg-gray-50"}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h3",{className:"font-mono font-bold",children:d.key}),e.jsx("span",{className:`px-2 py-1 text-xs rounded ${d.present?d.decoded?.expired?"bg-red-200 text-red-800":d.decoded?.valid?"bg-green-200 text-green-800":"bg-blue-200 text-blue-800":"bg-gray-200 text-gray-700"}`,children:d.present?d.decoded?.expired?"EXPIRADO":d.decoded?.valid?"VÁLIDO":"PRESENTE":"AUSENTE"})]}),d.present&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-xs text-gray-600 break-all font-mono mb-2",children:d.preview}),d.decoded&&e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Válido:"})," ",d.decoded.valid?"✅":"❌"]}),d.decoded.expired!==void 0&&e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Expirado:"})," ",d.decoded.expired?"⚠️ SIM":"✅ NÃO"]}),d.decoded.exp&&e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Expira em:"})," ",new Date(d.decoded.exp*1e3).toLocaleString()]}),d.decoded.email&&e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Email:"})," ",d.decoded.email]}),d.decoded.role&&e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Role:"})," ",d.decoded.role]})]})]})]},d.key))]})]}),e.jsxs("div",{className:"bg-gray-900 text-green-400 rounded-lg shadow p-6 font-mono text-sm",children:[e.jsx("h2",{id:"diagnostic-log-title",className:"text-xl font-semibold mb-4 text-white",children:"📋 Log"}),e.jsxs("div",{className:"space-y-1 max-h-96 overflow-y-auto focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-400 focus-visible:ring-offset-2 rounded",role:"log","aria-live":"polite","aria-relevant":"additions text","aria-labelledby":"diagnostic-log-title",tabIndex:0,children:[a.length===0&&e.jsx("p",{className:"text-gray-500",children:"Nenhuma ação ainda"}),a.map((d,g)=>e.jsx("div",{children:d},g))]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6 mt-6",children:[e.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"ℹ️ Informações"}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:"• Esta página ajuda a diagnosticar problemas de autenticação"}),e.jsx("li",{children:'• Tokens expirados causam erro 401 "No API key found in request"'}),e.jsx("li",{children:'• Use "Limpar Expirados" para remover tokens inválidos'}),e.jsx("li",{children:'• Use "Testar Login Admin" para obter token válido (riseup@popcode.com.br)'}),e.jsx("li",{children:"• Após limpar/login, recarregue a página para aplicar mudanças"})]})]})]})})}const Wo=()=>{const[s,r]=c.useState(!1),[a,t]=c.useState(null),o=async()=>{r(!0),t(null);try{console.log("🧪 [TESTE SQUAD 18] Iniciando cadastro...");const n=await ar.signupPaciente({nome:"Paciente Teste SQUAD 18",email:"teste.squad18@clinica.com",password:"123456",telefone:"11999998888",cpf:"12345678900",dataNascimento:"1990-01-01",endereco:{cep:"01310100",rua:"Avenida Paulista",numero:"1000",bairro:"Bela Vista",cidade:"São Paulo",estado:"SP"}});console.log("🎯 [TESTE SQUAD 18] Resultado:",n),t(n),n.success?h.success("✅ Paciente SQUAD 18 cadastrado com sucesso na API!"):h.error(`❌ Erro: ${n.error}`)}catch(n){console.error("💥 [TESTE SQUAD 18] Erro:",n);const i=n instanceof Error?n.message:"Erro desconhecido";t({success:!1,error:i}),h.error("Erro ao cadastrar")}finally{r(!1)}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-white flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-2xl w-full bg-white rounded-lg shadow-lg p-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-6",children:"🧪 Teste de Cadastro SQUAD 18"}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[e.jsx("h2",{className:"font-semibold text-blue-900 mb-2",children:"Dados do Teste:"}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:"✉️ Email: teste.squad18@clinica.com"}),e.jsx("li",{children:"👤 Nome: Paciente Teste SQUAD 18"}),e.jsx("li",{children:"🔑 Senha: 123456"}),e.jsx("li",{children:"📞 Telefone: 11999998888"}),e.jsx("li",{children:"📍 Endpoint: /auth/v1/signup"})]})]}),e.jsx("button",{onClick:o,disabled:s,className:"w-full bg-gradient-to-r from-purple-600 to-blue-600 text-white py-4 px-6 rounded-lg font-semibold text-lg hover:from-purple-700 hover:to-blue-700 disabled:opacity-50 transition-all shadow-lg mb-6",children:s?"⏳ Testando...":"🚀 Executar Teste de Cadastro"}),a&&e.jsxs("div",{className:`rounded-lg p-6 ${a.success?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:[e.jsx("h3",{className:`font-bold text-lg mb-3 ${a.success?"text-green-900":"text-red-900"}`,children:a.success?"✅ SUCESSO!":"❌ ERRO"}),e.jsx("pre",{className:"text-sm overflow-auto bg-white p-4 rounded border",children:JSON.stringify(a,null,2)})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("a",{href:"/",className:"text-blue-600 hover:text-blue-800 underline",children:"← Voltar para Home"})})]})})};async function en(s){try{const r={select:"*"};s?.active!==void 0&&(r.active=`eq.${s.active}`),s?.specialty&&(r.specialty=`ilike.%${s.specialty}%`);const a=await Q.get(Y.DOCTORS,{params:r});return a.success&&a.data?{success:!0,data:Array.isArray(a.data)?a.data:[a.data]}:{success:!1,error:a.error||"Erro ao listar médicos"}}catch(r){return console.error("Erro ao listar médicos:",r),{success:!1,error:r instanceof Error?r.message:"Erro desconhecido"}}}async function an(s){try{const r=await Q.post(Y.DOCTORS,s,{headers:{Prefer:"return=representation"}});return r.success&&r.data?{success:!0,data:Array.isArray(r.data)?r.data[0]:r.data,message:"Médico criado com sucesso"}:{success:!1,error:r.error||"Erro ao criar médico"}}catch(r){return console.error("Erro ao criar médico:",r),{success:!1,error:r instanceof Error?r.message:"Erro ao criar médico"}}}async function rn(s,r){try{const a=await Q.patch(`${Y.DOCTORS}?id=eq.${s}`,r,{headers:{Prefer:"return=representation"}});return a.success&&a.data?{success:!0,data:Array.isArray(a.data)?a.data[0]:a.data,message:"Médico atualizado com sucesso"}:{success:!1,error:a.error||"Erro ao atualizar médico"}}catch(a){return console.error("Erro ao atualizar médico:",a),{success:!1,error:a instanceof Error?a.message:"Erro ao atualizar médico"}}}async function sn(s){try{const r=await Q.delete(`${Y.DOCTORS}?id=eq.${s}`);return r.success?{success:!0,message:"Médico deletado com sucesso"}:{success:!1,error:r.error||"Erro ao deletar médico"}}catch(r){return console.error("Erro ao deletar médico:",r),{success:!1,error:r instanceof Error?r.message:"Erro ao deletar médico"}}}async function tn(s){try{const r=await Q.post("/functions/v1/create-user",s);return r.success&&r.data?r.data:{success:!1,error:r.error||"Erro ao criar usuário"}}catch(r){return console.error("Erro ao criar usuário:",r),{success:!1,error:r instanceof Error?r.message:"Erro ao criar usuário"}}}class on{async getCurrentUserInfo(){try{console.log("[adminUserService] Buscando informações do usuário atual...");const r=await ne.get("/functions/v1/user-info");return console.log("[adminUserService] Usuário atual:",r.data),{success:!0,data:r.data}}catch(r){console.error("[adminUserService] Erro ao buscar usuário:",r);const a=r;return{success:!1,error:a?.response?.data?.error||a?.response?.data?.message||a?.message||"Erro ao buscar informações do usuário"}}}async getUserRoles(r){try{console.log("[adminUserService] Buscando roles do usuário:",r);const a=await ne.get(`/rest/v1/user_roles?user_id=eq.${r}`);return console.log("[adminUserService] Roles encontrados:",a.data),{success:!0,data:a.data}}catch(a){console.error("[adminUserService] Erro ao buscar roles:",a);const t=a;return{success:!1,error:t?.response?.data?.error||t?.response?.data?.message||t?.message||"Erro ao buscar roles do usuário"}}}async getAllUserRoles(){try{console.log("[adminUserService] Buscando todos os roles...");const r=await ne.get("/rest/v1/user_roles?select=*");return console.log("[adminUserService] Total de roles:",r.data.length),{success:!0,data:r.data}}catch(r){console.error("[adminUserService] Erro ao buscar roles:",r);const a=r;return{success:!1,error:a?.response?.data?.error||a?.response?.data?.message||a?.message||"Erro ao buscar roles"}}}async addUserRole(r,a){try{console.log("[adminUserService] Adicionando role:",{userId:r,role:a});const t=await ne.post("/rest/v1/user_roles",{user_id:r,role:a},{headers:{Prefer:"return=representation"}});return console.log("[adminUserService] Role adicionado:",t.data),{success:!0,data:t.data[0]}}catch(t){console.error("[adminUserService] Erro ao adicionar role:",t);const o=t;return{success:!1,error:o?.response?.data?.error||o?.response?.data?.message||o?.message||"Erro ao adicionar role"}}}async removeUserRole(r){try{return console.log("[adminUserService] Removendo role:",r),await ne.delete(`/rest/v1/user_roles?id=eq.${r}`),console.log("[adminUserService] Role removido com sucesso"),{success:!0}}catch(a){console.error("[adminUserService] Erro ao remover role:",a);const t=a;return{success:!1,error:t?.response?.data?.error||t?.response?.data?.message||t?.message||"Erro ao remover role"}}}async listAllUsers(){try{console.log("[adminUserService] Listando todos os usuários...");const r=await ne.get("/rest/v1/profiles?select=*"),a=await this.getAllUserRoles(),t=a.success&&a.data?a.data:[];console.log("[adminUserService] Total de usuários:",r.data.length),console.log("[adminUserService] Total de roles:",t.length);const o=new Map;return t.forEach(i=>{o.has(i.user_id)||o.set(i.user_id,[]),o.get(i.user_id)?.push(i.role)}),{success:!0,data:r.data.map(i=>{const m=o.get(i.id)||[],b={isAdmin:m.includes("admin"),isManager:m.includes("gestor"),isDoctor:m.includes("medico"),isSecretary:m.includes("secretaria"),isAdminOrManager:m.includes("admin")||m.includes("gestor")};return{user:{id:i.id,email:i.email||"",created_at:i.created_at||""},profile:i,roles:m,permissions:b}})}}catch(r){console.error("[adminUserService] Erro ao listar usuários:",r);const a=r;return{success:!1,error:a?.response?.data?.error||a?.response?.data?.message||a?.message||"Erro ao listar usuários"}}}async updateUser(r,a){try{console.log("[adminUserService] Atualizando usuário:",r,a);const t={};a.full_name!==void 0&&(t.full_name=a.full_name),a.phone!==void 0&&(t.phone=a.phone),a.email!==void 0&&(t.email=a.email),a.disabled!==void 0&&(t.disabled=a.disabled);const o=await ne.patch(`/rest/v1/profiles?id=eq.${r}`,t,{headers:{Prefer:"return=representation"}});return console.log("[adminUserService] Usuário atualizado:",o.data),{success:!0,data:o.data[0]}}catch(t){console.error("[adminUserService] Erro ao atualizar usuário:",t);const o=t;return{success:!1,error:o?.response?.data?.error||o?.response?.data?.message||o?.message||"Erro ao atualizar usuário"}}}async disableUser(r){return this.updateUser(r,{disabled:!0})}async enableUser(r){return this.updateUser(r,{disabled:!1})}async deleteUser(r){try{return console.log("[adminUserService] Deletando usuário:",r),await ne.delete(`/rest/v1/profiles?id=eq.${r}`),console.log("[adminUserService] Usuário deletado com sucesso"),{success:!0}}catch(a){console.error("[adminUserService] Erro ao deletar usuário:",a);const t=a;return{success:!1,error:t?.response?.data?.error||t?.response?.data?.message||t?.message||"Erro ao deletar usuário"}}}}const Le=new on,nn=()=>{const{roles:s}=ke(),r=je(),[a,t]=c.useState("pacientes"),[o,n]=c.useState(!1),[i,m]=c.useState([]),[b,y]=c.useState(!1),[d,g]=c.useState(null),[p,E]=c.useState({full_name:"",cpf:"",email:"",phone_mobile:"",birth_date:"",social_name:"",sex:"",blood_type:"",weight_kg:"",height_m:"",street:"",number:"",complement:"",neighborhood:"",city:"",state:"",cep:""}),[j,C]=c.useState([]),[S,k]=c.useState(""),[N,x]=c.useState(!1),[v,$]=c.useState(null),[Z,_]=c.useState({}),[O,H]=c.useState(null),[A,X]=c.useState([]),[ae,se]=c.useState(""),[oe,le]=c.useState({email:"",password:"",full_name:"",phone:"",role:"user"}),[te,re]=c.useState([]),[W,P]=c.useState(!1),[q,D]=c.useState(null),[I,K]=c.useState({crm:"",crm_uf:"SP",specialty:"",full_name:"",cpf:"",email:"",phone_mobile:"",phone2:"",cep:"",street:"",number:"",complement:"",neighborhood:"",city:"",state:"",birth_date:"",rg:"",active:!0});c.useEffect(()=>{s.includes("admin")||s.includes("gestor")||(h.error("Acesso negado: apenas administradores"),r("/"))},[s,r]),c.useEffect(()=>{a==="pacientes"?w():a==="usuarios"?ee():a==="medicos"&&V()},[a]);const ee=async()=>{n(!0);try{const u=await Le.listAllUsers();u.success&&u.data?C(u.data):h.error(u.error||"Erro ao carregar usuários")}catch{h.error("Erro ao carregar usuários")}finally{n(!1)}},w=async()=>{n(!0);try{const u=await Xe({per_page:100});"data"in u&&m(u.data)}catch(u){console.error("Erro ao carregar pacientes:",u),h.error("Erro ao carregar pacientes")}finally{n(!1)}},V=async()=>{n(!0);try{const u=await en();u.success&&u.data&&re(u.data)}catch(u){console.error("Erro ao carregar médicos:",u),h.error("Erro ao carregar médicos")}finally{n(!1)}},G=async u=>{u.preventDefault(),n(!0);try{const L=await tn(oe);L.success?(h.success(`Usuário ${oe.full_name} criado com sucesso!`),x(!1),$e()):h.error(L.error||"Erro ao criar usuário")}catch(L){console.error("Erro ao criar usuário:",L),h.error("Erro ao criar usuário")}finally{n(!1)}},R=u=>{$(u),_({full_name:u.profile?.full_name||"",email:u.profile?.email||"",phone:u.profile?.phone||"",disabled:u.profile?.disabled||!1})},de=async()=>{if(v)try{const u=await Le.updateUser(v.user.id,Z);u.success?(h.success("Usuário atualizado com sucesso!"),$(null),ee()):h.error(u.error||"Erro ao atualizar usuário")}catch{h.error("Erro ao atualizar usuário")}},we=async(u,L)=>{try{const z=L?await Le.enableUser(u):await Le.disableUser(u);z.success?(h.success(`Usuário ${L?"habilitado":"desabilitado"} com sucesso!`),ee()):h.error(z.error||"Erro ao alterar status do usuário")}catch{h.error("Erro ao alterar status do usuário")}},ie=async(u,L)=>{if(confirm(`Tem certeza que deseja deletar o usuário "${L}"? Esta ação não pode ser desfeita.`))try{const z=await Le.deleteUser(u);z.success?(h.success("Usuário deletado com sucesso!"),ee()):h.error(z.error||"Erro ao deletar usuário")}catch{h.error("Erro ao deletar usuário")}},he=u=>{g(u),E({full_name:u.nome,cpf:u.cpf||"",email:u.email||"",phone_mobile:u.telefone||"",birth_date:u.dataNascimento||"",social_name:u.socialName||"",sex:u.sexo||"",blood_type:u.tipoSanguineo||"",weight_kg:u.pesoKg?.toString()||"",height_m:u.alturaM?.toString()||"",street:u.endereco?.rua||"",number:u.endereco?.numero||"",complement:u.endereco?.complemento||"",neighborhood:u.endereco?.bairro||"",city:u.endereco?.cidade||"",state:u.endereco?.estado||"",cep:u.endereco?.cep||""}),y(!0)},Be=async u=>{u.preventDefault(),n(!0);try{const L={nome:p.full_name,cpf:p.cpf.replace(/\D/g,""),email:p.email,telefone:p.phone_mobile,dataNascimento:p.birth_date,socialName:p.social_name,sexo:p.sex,tipoSanguineo:p.blood_type,pesoKg:p.weight_kg?parseFloat(p.weight_kg):void 0,alturaM:p.height_m?parseFloat(p.height_m):void 0,endereco:{rua:p.street,numero:p.number,complemento:p.complement,bairro:p.neighborhood,cidade:p.city,estado:p.state,cep:p.cep}};if(d){const z=await Ma(d.id,L);z.success?(h.success("Paciente atualizado com sucesso!"),y(!1),g(null),De(),w()):h.error(z.error||"Erro ao atualizar paciente")}else{const z=await Da(L);z.success?(h.success("Paciente criado com sucesso!"),y(!1),De(),w()):h.error(z.error||"Erro ao criar paciente")}}catch(L){console.error("Erro ao salvar paciente:",L),h.error("Erro ao salvar paciente")}finally{n(!1)}},He=async(u,L)=>{if(confirm(`Tem certeza que deseja deletar o paciente "${L}"? Esta ação não pode ser desfeita.`))try{console.log("[PainelAdmin] Deletando paciente:",{id:u,nome:L});const z=await Ta(u);console.log("[PainelAdmin] Resultado da deleção:",z),z.success?(h.success("Paciente deletado com sucesso!"),w()):(console.error("[PainelAdmin] Falha ao deletar:",z.error),h.error(z.error||"Erro ao deletar paciente"))}catch(z){console.error("[PainelAdmin] Erro ao deletar paciente:",z),h.error("Erro ao deletar paciente")}},Qe=u=>{D(u),K({crm:u.crm||"",crm_uf:u.crm_uf||"SP",specialty:u.specialty||"",full_name:u.full_name||"",cpf:u.cpf||"",email:u.email||"",phone_mobile:u.phone_mobile||"",phone2:u.phone2||"",cep:u.cep||"",street:u.street||"",number:u.number||"",complement:u.complement||"",neighborhood:u.neighborhood||"",city:u.city||"",state:u.state||"",birth_date:u.birth_date||"",rg:u.rg||"",active:u.active??!0}),P(!0)},ga=async u=>{u.preventDefault(),n(!0);try{const L={...I,cpf:I.cpf.replace(/\D/g,"")};if(q){const z=await rn(q.id,L);z.success?(h.success("Médico atualizado com sucesso!"),P(!1),D(null),Ve(),V()):h.error(z.error||"Erro ao atualizar médico")}else{const z=await an(L);z.success?(h.success("Médico criado com sucesso!"),P(!1),Ve(),V()):h.error(z.error||"Erro ao criar médico")}}catch(L){console.error("Erro ao salvar médico:",L),h.error("Erro ao salvar médico")}finally{n(!1)}},Ne=async(u,L)=>{if(confirm(`Tem certeza que deseja deletar o médico "${L}"? Esta ação não pode ser desfeita.`))try{const z=await sn(u);z.success?(h.success("Médico deletado com sucesso!"),V()):h.error(z.error||"Erro ao deletar médico")}catch{h.error("Erro ao deletar médico")}},De=()=>{E({full_name:"",cpf:"",email:"",phone_mobile:"",birth_date:"",social_name:"",sex:"",blood_type:"",weight_kg:"",height_m:"",street:"",number:"",complement:"",neighborhood:"",city:"",state:"",cep:""})},$e=()=>{le({email:"",password:"",full_name:"",phone:"",role:"user"})},Ve=()=>{K({crm:"",crm_uf:"SP",specialty:"",full_name:"",cpf:"",email:"",phone_mobile:"",phone2:"",cep:"",street:"",number:"",complement:"",neighborhood:"",city:"",state:"",birth_date:"",rg:"",active:!0})},Ze=["AC","AL","AP","AM","BA","CE","DF","ES","GO","MA","MT","MS","MG","PA","PB","PR","PE","PI","RJ","RN","RS","RO","RR","SC","SP","SE","TO"],M=["admin","gestor","medico","secretaria","user"];return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 p-6",children:[e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"bg-white rounded-xl shadow p-6 mb-6 border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Painel de Administração"}),e.jsx("p",{className:"text-gray-600",children:"Gerenciar pacientes, usuários e médicos do sistema"})]}),e.jsx(gt,{className:"w-12 h-12 text-blue-600"})]})}),e.jsxs("div",{className:"bg-white rounded-xl shadow border border-gray-200 mb-6",children:[e.jsxs("div",{className:"flex border-b",role:"tablist","aria-label":"Seções do administrador",children:[e.jsxs("button",{onClick:()=>t("pacientes"),id:"tab-pacientes-tab",role:"tab","aria-selected":a==="pacientes","aria-controls":"tab-pacientes-panel",className:`flex items-center gap-2 px-6 py-4 font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 ${a==="pacientes"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-blue-600"}`,children:[e.jsx(la,{className:"w-5 h-5"}),"Pacientes"]}),e.jsxs("button",{onClick:()=>t("usuarios"),id:"tab-usuarios-tab",role:"tab","aria-selected":a==="usuarios","aria-controls":"tab-usuarios-panel",className:`flex items-center gap-2 px-6 py-4 font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 ${a==="usuarios"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-blue-600"}`,children:[e.jsx(Sa,{className:"w-5 h-5"}),"Usuários"]}),e.jsxs("button",{onClick:()=>t("medicos"),id:"tab-medicos-tab",role:"tab","aria-selected":a==="medicos","aria-controls":"tab-medicos-panel",className:`flex items-center gap-2 px-6 py-4 font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 ${a==="medicos"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-blue-600"}`,children:[e.jsx(Ge,{className:"w-5 h-5"}),"Médicos"]})]}),e.jsxs("div",{className:"p-6",children:[a==="pacientes"&&e.jsxs("div",{id:"tab-pacientes-panel",role:"tabpanel","aria-labelledby":"tab-pacientes-tab",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Pacientes Cadastrados"}),e.jsxs("button",{onClick:()=>y(!0),className:"flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-green-500 focus-visible:ring-offset-2",children:[e.jsx(Se,{className:"w-5 h-5"}),"Novo Paciente"]})]}),o?e.jsx("div",{className:"text-center py-8",children:"Carregando..."}):e.jsx("div",{className:"grid gap-4",children:i.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"Nenhum paciente cadastrado"}):i.map((u,L)=>e.jsxs("div",{className:`rounded-lg p-4 flex items-center justify-between transition-colors ${L%2===0?"bg-white":"bg-gray-50"} hover:bg-gray-100`,children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:u.nome}),e.jsxs("p",{className:"text-gray-600 text-sm",children:[u.email," | ",u.telefone]}),e.jsxs("p",{className:"text-gray-500 text-xs",children:["CPF: ",u.cpf," | Nascimento: ",u.dataNascimento]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>he(u),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2",title:"Editar",children:e.jsx(ka,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>He(u.id,u.nome),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-red-500 focus-visible:ring-offset-2",title:"Deletar",children:e.jsx(Ye,{className:"w-4 h-4"})})]})]},u.id))})]}),a==="usuarios"&&e.jsxs("div",{id:"tab-usuarios-panel",role:"tabpanel","aria-labelledby":"tab-usuarios-tab",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Gerenciar Usuários"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:ee,disabled:o,className:"flex items-center gap-2 bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-500 focus-visible:ring-offset-2",children:[e.jsx(xt,{className:`w-4 h-4 ${o?"animate-spin":""}`}),"Atualizar"]}),e.jsxs("button",{onClick:()=>x(!0),className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2",children:[e.jsx(Se,{className:"w-5 h-5"}),"Novo Usuário"]})]})]}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx(ra,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Buscar por nome ou email...",value:S,onChange:u=>k(u.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-blue-600/40 transition-colors"})]}),o?e.jsx("div",{className:"text-center py-8",children:"Carregando usuários..."}):e.jsx("div",{className:"overflow-auto max-h-[70vh] bg-white rounded-lg border border-gray-200",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold",children:"Nome"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold",children:"Email"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold",children:"Telefone"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold",children:"Roles"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold",children:"Ações"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:j.filter(u=>{const L=S.toLowerCase();return u.profile?.full_name?.toLowerCase().includes(L)||u.profile?.email?.toLowerCase().includes(L)||u.user.email.toLowerCase().includes(L)}).length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-gray-500",children:S?"Nenhum usuário encontrado":"Nenhum usuário cadastrado"})}):j.filter(u=>{const L=S.toLowerCase();return u.profile?.full_name?.toLowerCase().includes(L)||u.profile?.email?.toLowerCase().includes(L)||u.user.email.toLowerCase().includes(L)}).map(u=>e.jsxs("tr",{className:"hover:bg-gray-50 odd:bg-white even:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"font-medium text-gray-900",children:u.profile?.full_name||"Sem nome"})}),e.jsx("td",{className:"px-4 py-3 text-gray-600",children:u.profile?.email||u.user.email}),e.jsx("td",{className:"px-4 py-3 text-gray-600",children:u.profile?.phone||"-"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"flex flex-wrap gap-1",children:u.roles&&u.roles.length>0?u.roles.map((L,z)=>e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${L==="admin"?"bg-purple-100 text-purple-700":L==="gestor"?"bg-blue-100 text-blue-700":L==="medico"?"bg-indigo-100 text-indigo-700":L==="secretaria"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:L},z)):e.jsx("span",{className:"text-gray-400 text-xs",children:"Sem roles"})})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${u.profile?.disabled?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:u.profile?.disabled?"Desabilitado":"Ativo"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("button",{onClick:()=>R(u),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2",title:"Editar",children:e.jsx(ka,{className:"w-4 h-4"})}),e.jsx("button",{onClick:async()=>{H(u);const L=await Le.getUserRoles(u.user.id);L.success&&L.data&&X(L.data)},className:"p-2 text-purple-600 hover:bg-purple-50 rounded-lg transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-purple-500 focus-visible:ring-offset-2",title:"Gerenciar Roles",children:e.jsx(Va,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>we(u.user.id,!!u.profile?.disabled),className:`p-2 rounded-lg transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 ${u.profile?.disabled?"text-green-600 hover:bg-green-50 focus-visible:ring-green-500":"text-orange-600 hover:bg-orange-50 focus-visible:ring-orange-500"}`,title:u.profile?.disabled?"Habilitar":"Desabilitar",children:u.profile?.disabled?e.jsx(dr,{className:"w-4 h-4"}):e.jsx(ht,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>ie(u.user.id,u.profile?.full_name||u.user.email),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-red-500 focus-visible:ring-offset-2",title:"Deletar",children:e.jsx(Ye,{className:"w-4 h-4"})})]})})]},u.user.id))})]})})]}),a==="medicos"&&e.jsxs("div",{id:"tab-medicos-panel",role:"tabpanel","aria-labelledby":"tab-medicos-tab",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Médicos Cadastrados"}),e.jsxs("button",{onClick:()=>P(!0),className:"flex items-center gap-2 bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-purple-500 focus-visible:ring-offset-2",children:[e.jsx(Se,{className:"w-5 h-5"}),"Novo Médico"]})]}),o?e.jsx("div",{className:"text-center py-8",children:"Carregando..."}):e.jsx("div",{className:"grid gap-4",children:te.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"Nenhum médico cadastrado"}):te.map((u,L)=>e.jsxs("div",{className:`rounded-lg p-4 flex items-center justify-between transition-colors ${L%2===0?"bg-white":"bg-gray-50"} hover:bg-gray-100`,children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-lg",children:u.full_name}),e.jsxs("p",{className:"text-gray-600 text-sm",children:[u.specialty," | CRM: ",u.crm,"/",u.crm_uf]}),e.jsxs("p",{className:"text-gray-500 text-xs",children:[u.email," | ",u.phone_mobile]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-3 py-1 rounded-full text-sm ${u.active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:u.active?"Ativo":"Inativo"}),e.jsx("button",{onClick:()=>Qe(u),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2",title:"Editar",children:e.jsx(ka,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>Ne(u.id,u.full_name||"Médico sem nome"),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-red-500 focus-visible:ring-offset-2",title:"Deletar",children:e.jsx(Ye,{className:"w-4 h-4"})})]})]},u.id))})]})]})]})]}),b&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",role:"dialog","aria-modal":"true","aria-labelledby":"paciente-modal-title",children:e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{id:"paciente-modal-title",className:"text-2xl font-bold mb-4",children:"Novo Paciente"}),e.jsxs("form",{onSubmit:Be,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Nome Completo *"}),e.jsx("input",{type:"text",required:!0,value:p.full_name,onChange:u=>E({...p,full_name:u.target.value}),className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-600 focus:border-green-600/40"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Nome Social"}),e.jsx("input",{type:"text",value:p.social_name,onChange:u=>E({...p,social_name:u.target.value}),className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-600 focus:border-green-600/40"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"CPF *"}),e.jsx("input",{type:"text",required:!0,value:p.cpf,onChange:u=>E({...p,cpf:u.target.value}),className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-600 focus:border-green-600/40",placeholder:"00000000000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Email *"}),e.jsx("input",{type:"email",required:!0,value:p.email,onChange:u=>E({...p,email:u.target.value}),className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-600 focus:border-green-600/40"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Telefone *"}),e.jsx("input",{type:"text",required:!0,value:p.phone_mobile,onChange:u=>E({...p,phone_mobile:u.target.value}),className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-600 focus:border-green-600/40",placeholder:"(00) 00000-0000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Data de Nascimento"}),e.jsx("input",{type:"date",value:p.birth_date,onChange:u=>E({...p,birth_date:u.target.value}),className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-600 focus:border-green-600/40"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Sexo"}),e.jsxs("select",{value:p.sex,onChange:u=>E({...p,sex:u.target.value}),className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-600 focus:border-green-600/40",children:[e.jsx("option",{value:"",children:"Selecione"}),e.jsx("option",{value:"M",children:"Masculino"}),e.jsx("option",{value:"F",children:"Feminino"}),e.jsx("option",{value:"Outro",children:"Outro"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tipo Sanguíneo"}),e.jsx("input",{type:"text",value:p.blood_type,onChange:u=>E({...p,blood_type:u.target.value}),className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-600 focus:border-green-600/40",placeholder:"A+"})]})]}),e.jsxs("div",{className:"flex gap-2 justify-end pt-4",children:[e.jsx("button",{type:"button",onClick:()=>{y(!1),g(null),De()},className:"px-4 py-2 border rounded-lg hover:bg-gray-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-400 focus-visible:ring-offset-2",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:o,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-green-500 focus-visible:ring-offset-2",children:o?d?"Salvando...":"Criando...":d?"Salvar":"Criar Paciente"})]})]})]})})}),N&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",role:"dialog","aria-modal":"true","aria-labelledby":"usuario-modal-title",children:e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 shadow-xl max-w-md w-full",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{id:"usuario-modal-title",className:"text-2xl font-bold mb-4",children:"Novo Usuário"}),e.jsxs("form",{onSubmit:G,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Nome Completo *"}),e.jsx("input",{type:"text",required:!0,value:oe.full_name,onChange:u=>le({...oe,full_name:u.target.value}),className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-blue-600/40"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Email *"}),e.jsx("input",{type:"email",required:!0,value:oe.email,onChange:u=>le({...oe,email:u.target.value}),className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-blue-600/40"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Senha Temporária * (mínimo 6 caracteres)"}),e.jsx("input",{type:"password",required:!0,minLength:6,value:oe.password,onChange:u=>le({...oe,password:u.target.value}),className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-blue-600/40"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Telefone"}),e.jsx("input",{type:"text",value:oe.phone||"",onChange:u=>le({...oe,phone:u.target.value}),className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-blue-600/40",placeholder:"(00) 00000-0000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Role/Papel *"}),e.jsx("select",{required:!0,value:oe.role,onChange:u=>le({...oe,role:u.target.value}),className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-blue-600/40",children:M.map(u=>e.jsx("option",{value:u,children:u},u))})]}),e.jsxs("div",{className:"flex gap-2 justify-end pt-4",children:[e.jsx("button",{type:"button",onClick:()=>{x(!1),$e()},className:"px-4 py-2 border rounded-lg hover:bg-gray-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-400 focus-visible:ring-offset-2",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:o,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2",children:o?"Criando...":"Criar Usuário"})]})]})]})})}),W&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",role:"dialog","aria-modal":"true","aria-labelledby":"medico-modal-title",children:e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 shadow-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{id:"medico-modal-title",className:"text-2xl font-bold mb-4",children:"Novo Médico"}),e.jsxs("form",{onSubmit:ga,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Nome Completo *"}),e.jsx("input",{type:"text",required:!0,value:I.full_name,onChange:u=>K({...I,full_name:u.target.value}),className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-purple-600/40"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Especialidade"}),e.jsx("input",{type:"text",value:I.specialty,onChange:u=>K({...I,specialty:u.target.value}),className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-purple-600/40",placeholder:"Cardiologia"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"CRM *"}),e.jsx("input",{type:"text",required:!0,value:I.crm,onChange:u=>K({...I,crm:u.target.value}),className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-purple-600/40",placeholder:"123456"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"UF do CRM *"}),e.jsx("select",{required:!0,value:I.crm_uf,onChange:u=>K({...I,crm_uf:u.target.value}),className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-purple-600/40",children:Ze.map(u=>e.jsx("option",{value:u,children:u},u))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"CPF *"}),e.jsx("input",{type:"text",required:!0,value:I.cpf,onChange:u=>K({...I,cpf:u.target.value}),className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-purple-600/40",placeholder:"000.000.000-00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"RG"}),e.jsx("input",{type:"text",value:I.rg,onChange:u=>K({...I,rg:u.target.value}),className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-purple-600/40"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Email *"}),e.jsx("input",{type:"email",required:!0,value:I.email,onChange:u=>K({...I,email:u.target.value}),className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-purple-600/40"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Telefone"}),e.jsx("input",{type:"text",value:I.phone_mobile,onChange:u=>K({...I,phone_mobile:u.target.value}),className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-purple-600/40",placeholder:"(00) 00000-0000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Data de Nascimento"}),e.jsx("input",{type:"date",value:I.birth_date,onChange:u=>K({...I,birth_date:u.target.value}),className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-purple-600/40"})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center gap-2 mt-6",children:[e.jsx("input",{type:"checkbox",checked:I.active,onChange:u=>K({...I,active:u.target.checked}),className:"w-4 h-4 focus:outline-none focus:ring-2 focus:ring-purple-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Ativo"})]})})]}),e.jsxs("div",{className:"flex gap-2 justify-end pt-4",children:[e.jsx("button",{type:"button",onClick:()=>{P(!1),D(null),Ve()},className:"px-4 py-2 border rounded-lg hover:bg-gray-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-400 focus-visible:ring-offset-2",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:o,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-purple-500 focus-visible:ring-offset-2",children:o?q?"Salvando...":"Criando...":q?"Salvar":"Criar Médico"})]})]})]})})}),v&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",role:"dialog","aria-modal":"true","aria-labelledby":"editar-usuario-title",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl border border-gray-200 max-w-md w-full p-6",children:[e.jsx("h2",{id:"editar-usuario-title",className:"text-xl font-bold text-gray-900 mb-4",children:"Editar Usuário"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome Completo"}),e.jsx("input",{type:"text",value:Z.full_name||"",onChange:u=>_({...Z,full_name:u.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-blue-600/40"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{type:"email",value:Z.email||"",onChange:u=>_({...Z,email:u.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-blue-600/40"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Telefone"}),e.jsx("input",{type:"tel",value:Z.phone||"",onChange:u=>_({...Z,phone:u.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-blue-600/40"})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:()=>$(null),className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-400 focus-visible:ring-offset-2",children:"Cancelar"}),e.jsx("button",{onClick:de,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2",children:"Salvar"})]})]})}),O&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",role:"dialog","aria-modal":"true","aria-labelledby":"gerenciar-roles-title",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl border border-gray-200 max-w-md w-full p-6",children:[e.jsxs("h2",{id:"gerenciar-roles-title",className:"text-xl font-bold text-gray-900 mb-2 flex items-center gap-2",children:[e.jsx(Va,{className:"w-5 h-5 text-purple-600"}),"Gerenciar Roles"]}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:O.profile?.full_name||O.user.email}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Roles Atuais:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:A.length>0?A.map(u=>e.jsxs("div",{className:`flex items-center gap-1 px-3 py-1 rounded-full text-xs font-semibold ${u.role==="admin"?"bg-purple-100 text-purple-700":u.role==="gestor"?"bg-blue-100 text-blue-700":u.role==="medico"?"bg-indigo-100 text-indigo-700":u.role==="secretaria"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:[u.role,e.jsx("button",{onClick:async()=>{const L=await Le.removeUserRole(u.id);if(L.success){h.success("Role removido com sucesso!");const z=await Le.getUserRoles(O.user.id);z.success&&z.data&&X(z.data),ee()}else h.error(L.error||"Erro ao remover role")},className:"hover:bg-black hover:bg-opacity-10 rounded-full p-0.5",children:e.jsx(Fe,{className:"w-3 h-3"})})]},u.id)):e.jsx("span",{className:"text-gray-400 text-sm",children:"Nenhum role atribuído"})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Adicionar Role:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:ae,onChange:u=>se(u.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-purple-600/40 text-sm",children:[e.jsx("option",{value:"",children:"Selecione um role..."}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"gestor",children:"Gestor"}),e.jsx("option",{value:"medico",children:"Médico"}),e.jsx("option",{value:"secretaria",children:"Secretária"}),e.jsx("option",{value:"user",children:"Usuário"})]}),e.jsxs("button",{onClick:async()=>{if(!ae){h.error("Selecione um role");return}const u=await Le.addUserRole(O.user.id,ae);if(u.success){h.success("Role adicionado com sucesso!"),se("");const L=await Le.getUserRoles(O.user.id);L.success&&L.data&&X(L.data),ee()}else h.error(u.error||"Erro ao adicionar role")},disabled:!ae,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-purple-500 focus-visible:ring-offset-2",children:[e.jsx(Se,{className:"w-4 h-4"}),"Adicionar"]})]})]}),e.jsx("div",{className:"flex gap-3 mt-6",children:e.jsx("button",{onClick:()=>{H(null),X([]),se("")},className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-400 focus-visible:ring-offset-2",children:"Fechar"})})]})})]})},is=[{category:"Agendamento",question:"Como agendar uma consulta?",answer:"Para agendar uma consulta, vá até a seção 'Agendar Consulta' no menu lateral, selecione o médico desejado, escolha uma data e horário disponível, e confirme o agendamento. Você receberá uma confirmação por e-mail."},{category:"Agendamento",question:"Posso cancelar ou remarcar uma consulta?",answer:"Sim, você pode cancelar ou remarcar suas consultas em 'Minhas Consultas'. Recomendamos fazer isso com pelo menos 24 horas de antecedência para evitar taxas de cancelamento."},{category:"Agendamento",question:"Posso agendar consulta para outra pessoa?",answer:"Sim, você pode agendar consultas para dependentes cadastrados em seu perfil. Basta selecioná-los no momento do agendamento."},{category:"Consultas",question:"Como funciona a teleconsulta?",answer:"A teleconsulta é realizada por videochamada. No horário da consulta, acesse 'Minhas Consultas' e clique em 'Iniciar Consulta Online'. Certifique-se de ter uma conexão estável de internet e permita o acesso à câmera e microfone."},{category:"Consultas",question:"Quanto tempo antes devo chegar para a consulta presencial?",answer:"Recomendamos chegar com 15 minutos de antecedência para realizar o check-in e atualizar suas informações cadastrais se necessário."},{category:"Consultas",question:"Como acesso o histórico das minhas consultas?",answer:"Seu histórico completo de consultas está disponível em 'Minhas Consultas'. Lá você pode ver consultas realizadas, relatórios médicos e prescrições anteriores."},{category:"Pagamento",question:"Quais formas de pagamento são aceitas?",answer:"Aceitamos cartão de crédito, débito, PIX e boleto bancário. Os pagamentos são processados de forma segura através da nossa plataforma."},{category:"Pagamento",question:"Posso parcelar o pagamento?",answer:"Sim, oferecemos parcelamento em até 3x sem juros no cartão de crédito para consultas acima de R$ 150,00."},{category:"Pagamento",question:"Como funciona o reembolso em caso de cancelamento?",answer:"Cancelamentos feitos com mais de 24 horas de antecedência têm reembolso integral. Cancelamentos com menos de 24 horas podem ter retenção de 30% como taxa administrativa."},{category:"Informações Médicas",question:"Como acesso meu histórico médico?",answer:"Seu histórico médico, incluindo consultas anteriores, exames e receitas, pode ser acessado na seção 'Meu Perfil'. Você pode fazer download de documentos quando necessário."},{category:"Informações Médicas",question:"Os médicos têm acesso ao meu histórico completo?",answer:"Sim, os médicos da plataforma têm acesso ao seu histórico de consultas e exames realizados dentro do sistema para oferecer melhor atendimento."},{category:"Informações Médicas",question:"Posso adicionar exames feitos fora da plataforma?",answer:"Sim, você pode fazer upload de exames e documentos médicos externos na seção 'Meu Perfil' > 'Documentos Médicos'."},{category:"Segurança",question:"Meus dados estão seguros?",answer:"Sim, utilizamos criptografia de ponta a ponta e seguimos todos os protocolos da LGPD para proteger seus dados pessoais e médicos."},{category:"Segurança",question:"Quem tem acesso às minhas informações?",answer:"Apenas você, os médicos que te atendem e profissionais autorizados da clínica têm acesso às suas informações. Nunca compartilhamos seus dados com terceiros sem autorização."},{category:"Suporte",question:"Como entro em contato com o suporte?",answer:"Você pode entrar em contato através do chat online, telefone (0800-123-4567) ou e-mail (secretaria.mediconnect@gmail.com). Horário de atendimento: Segunda a Sexta, das 8h às 18h."},{category:"Suporte",question:"O que fazer em caso de emergência?",answer:"Em casos de emergência, procure imediatamente o pronto-socorro mais próximo ou ligue para 192 (SAMU). Nossa plataforma é destinada a consultas agendadas e não substitui o atendimento de emergência."},{category:"Médicos",question:"Posso escolher qualquer médico?",answer:"Sim, você pode escolher qualquer médico disponível na plataforma. Recomendamos verificar a especialidade, avaliações de outros pacientes e disponibilidade antes de agendar."},{category:"Médicos",question:"Como avaliar um médico após a consulta?",answer:"Após cada consulta, você receberá um convite por e-mail para avaliar o atendimento. Você também pode avaliar acessando 'Minhas Consultas' e selecionando a consulta realizada."}],ln=()=>{const s=je(),[r,a]=c.useState(""),[t,o]=c.useState(null),[n,i]=c.useState("Todas"),m=["Todas",...Array.from(new Set(is.map(d=>d.category)))],b=is.filter(d=>{const g=d.question.toLowerCase().includes(r.toLowerCase())||d.answer.toLowerCase().includes(r.toLowerCase()),p=n==="Todas"||d.category===n;return g&&p}),y=d=>{o(t===d?null:d)};return e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx("div",{className:"bg-gradient-to-br from-blue-600 to-blue-400 dark:from-blue-700 dark:to-blue-500 text-white py-12",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>s("/acompanhamento"),className:"absolute left-0 top-0 flex items-center gap-2 px-4 py-2 bg-white/10 hover:bg-white/20 rounded-lg transition-colors backdrop-blur-sm",children:[e.jsx(xs,{className:"h-5 w-5"}),e.jsx("span",{children:"Voltar ao Painel"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(hs,{className:"h-16 w-16 mx-auto mb-4"}),e.jsx("h1",{className:"text-4xl font-bold mb-2",children:"Central de Ajuda"}),e.jsx("p",{className:"text-blue-100 text-lg",children:"Encontre respostas para suas dúvidas rapidamente"})]})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 -mt-16 mb-8",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 hover:shadow-xl transition-shadow",children:e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("div",{className:"h-14 w-14 rounded-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center mb-4",children:e.jsx(Ha,{className:"h-7 w-7 text-blue-600 dark:text-blue-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Chat Online"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mb-4",children:"Fale conosco em tempo real"}),e.jsx("button",{className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg transition-colors",children:"Iniciar Chat"})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 hover:shadow-xl transition-shadow",children:e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("div",{className:"h-14 w-14 rounded-full bg-green-100 dark:bg-green-900 flex items-center justify-center mb-4",children:e.jsx(Ka,{className:"h-7 w-7 text-green-600 dark:text-green-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Telefone"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mb-4",children:"0800-123-4567"}),e.jsx("button",{className:"w-full border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 py-2 px-4 rounded-lg transition-colors",children:"Ligar Agora"})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 hover:shadow-xl transition-shadow",children:e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("div",{className:"h-14 w-14 rounded-full bg-purple-100 dark:bg-purple-900 flex items-center justify-center mb-4",children:e.jsx(da,{className:"h-7 w-7 text-purple-600 dark:text-purple-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"E-mail"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mb-4",children:"secretaria.mediconnect@gmail.com"}),e.jsx("button",{className:"w-full border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 py-2 px-4 rounded-lg transition-colors",children:"Enviar E-mail"})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-md p-6 mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Perguntas Frequentes"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"Busque por palavras-chave ou navegue pelas categorias"}),e.jsxs("div",{className:"relative mb-6",children:[e.jsx(ra,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar em perguntas frequentes...",value:r,onChange:d=>a(d.target.value),className:"w-full pl-12 pr-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:m.map(d=>e.jsx("button",{onClick:()=>i(d),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${n===d?"bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:d},d))})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-md p-6 mb-8",children:[e.jsx("div",{className:"space-y-4",children:b.map((d,g)=>e.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden",children:[e.jsxs("button",{onClick:()=>y(g),className:"w-full flex items-center justify-between p-4 text-left hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("span",{className:"px-2 py-1 bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-400 text-xs font-medium rounded",children:d.category}),e.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:d.question})]}),e.jsx(br,{className:`h-5 w-5 text-gray-400 transition-transform flex-shrink-0 ml-4 ${t===g?"transform rotate-180":""}`})]}),t===g&&e.jsx("div",{className:"px-4 pb-4 pt-2 bg-gray-50 dark:bg-gray-700/50",children:e.jsx("p",{className:"text-gray-600 dark:text-gray-300 leading-relaxed pl-16",children:d.answer})})]},g))}),b.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Pa,{className:"h-12 w-12 text-gray-400 mx-auto mb-3"}),e.jsxs("p",{className:"text-gray-500 dark:text-gray-400 text-lg",children:['Nenhuma pergunta encontrada para "',r,'"']}),e.jsx("p",{className:"text-gray-400 dark:text-gray-500 text-sm mt-2",children:"Tente outro termo de busca ou entre em contato conosco"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-md p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-6",children:"Recursos Adicionais"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("button",{className:"flex items-center gap-4 p-4 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors text-left",children:[e.jsx("div",{className:"h-12 w-12 rounded-lg bg-blue-100 dark:bg-blue-900 flex items-center justify-center flex-shrink-0",children:e.jsx(ps,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Guia do Usuário"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Manual completo da plataforma"})]})]}),e.jsxs("button",{className:"flex items-center gap-4 p-4 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors text-left",children:[e.jsx("div",{className:"h-12 w-12 rounded-lg bg-red-100 dark:bg-red-900 flex items-center justify-center flex-shrink-0",children:e.jsx(ca,{className:"h-6 w-6 text-red-600 dark:text-red-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Vídeos Tutoriais"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Aprenda assistindo"})]})]}),e.jsxs("button",{className:"flex items-center gap-4 p-4 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors text-left",children:[e.jsx("div",{className:"h-12 w-12 rounded-lg bg-green-100 dark:bg-green-900 flex items-center justify-center flex-shrink-0",children:e.jsx(ua,{className:"h-6 w-6 text-green-600 dark:text-green-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Termos de Uso"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Leia nossos termos"})]})]}),e.jsxs("button",{className:"flex items-center gap-4 p-4 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors text-left",children:[e.jsx("div",{className:"h-12 w-12 rounded-lg bg-purple-100 dark:bg-purple-900 flex items-center justify-center flex-shrink-0",children:e.jsx(Va,{className:"h-6 w-6 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Política de Privacidade"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Como protegemos seus dados"})]})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-blue-400 dark:from-blue-700 dark:to-blue-500 rounded-xl shadow-md p-8 mt-8 text-center text-white",children:[e.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Ainda tem dúvidas?"}),e.jsx("p",{className:"text-blue-100 mb-6",children:"Nossa equipe está pronta para ajudar você"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[e.jsx("button",{className:"bg-white text-blue-600 hover:bg-blue-50 px-6 py-3 rounded-lg font-medium transition-colors",children:"Falar com Suporte"}),e.jsx("button",{className:"border-2 border-white text-white hover:bg-white/10 px-6 py-3 rounded-lg font-medium transition-colors",children:"Agendar Retorno de Ligação"})]})]})]})]})},ls=[{category:"Agenda",question:"Como gerenciar minha disponibilidade?",answer:"Acesse 'Disponibilidade' no menu lateral para configurar seus horários de atendimento. Você pode definir horários recorrentes e adicionar exceções para datas específicas."},{category:"Agenda",question:"Posso bloquear horários específicos?",answer:"Sim, na seção 'Disponibilidade', você pode adicionar exceções para bloquear horários em datas específicas, como férias ou compromissos pessoais."},{category:"Agenda",question:"Como visualizar minhas próximas consultas?",answer:"No Dashboard, você verá um resumo das próximas consultas. Para ver detalhes completos, acesse a seção 'Consultas' no menu lateral."},{category:"Consultas",question:"Como realizar uma teleconsulta?",answer:"No horário da consulta, acesse 'Consultas', localize o agendamento e clique em 'Iniciar Consulta Online'. Certifique-se de ter uma boa conexão de internet."},{category:"Consultas",question:"Posso cancelar ou remarcar uma consulta?",answer:"Sim, acesse 'Consultas', selecione o agendamento desejado e escolha a opção de cancelar ou remarcar. O paciente será notificado automaticamente."},{category:"Consultas",question:"Como registro o prontuário após a consulta?",answer:"Após finalizar a consulta, clique em 'Adicionar Relatório' para registrar anamnese, diagnóstico, prescrição e orientações."},{category:"Relatórios",question:"Como criar relatórios médicos?",answer:"Na seção 'Relatórios', você pode criar novos documentos médicos incluindo anamnese, exame físico, diagnóstico e prescrição. Os relatórios ficam vinculados ao histórico do paciente."},{category:"Relatórios",question:"Os pacientes têm acesso aos relatórios?",answer:"Sim, após você criar e salvar um relatório, o paciente pode acessá-lo em seu painel pessoal."},{category:"Relatórios",question:"Posso editar um relatório após criado?",answer:"Sim, você pode editar relatórios acessando a seção 'Relatórios' e selecionando o documento desejado."},{category:"Pacientes",question:"Como acesso o histórico completo de um paciente?",answer:"Durante ou após uma consulta, clique no nome do paciente para ver seu histórico completo de consultas, exames e relatórios anteriores."},{category:"Pacientes",question:"Como adicionar anotações privadas sobre um paciente?",answer:"No prontuário do paciente, você pode adicionar observações que ficam visíveis apenas para você e outros médicos autorizados."},{category:"Pagamento",question:"Como recebo pelos atendimentos?",answer:"Os pagamentos são processados automaticamente pela plataforma. Você receberá seus honorários na conta bancária cadastrada de acordo com o cronograma estabelecido."},{category:"Pagamento",question:"Posso definir valores diferentes por tipo de consulta?",answer:"Sim, você pode configurar valores específicos para consultas presenciais e teleconsultas em 'Configurações'."},{category:"Sistema",question:"Como atualizar meus dados cadastrais?",answer:"Acesse 'Configurações' no menu lateral para atualizar suas informações pessoais, dados bancários, especialidades e outras configurações."},{category:"Sistema",question:"Como funciona a notificação de novos agendamentos?",answer:"Você receberá notificações por e-mail e SMS sempre que um novo agendamento for realizado. Você pode configurar suas preferências em 'Configurações'."},{category:"Sistema",question:"Meus dados estão seguros?",answer:"Sim, utilizamos criptografia de ponta a ponta e seguimos rigorosamente os protocolos da LGPD para proteger todos os dados médicos e pessoais."},{category:"Suporte",question:"Como reportar problemas técnicos?",answer:"Entre em contato através do chat online, telefone (0800-123-4567) ou e-mail (secretaria.mediconnect@gmail.com). Nossa equipe técnica está disponível de segunda a sexta, das 8h às 18h."},{category:"Suporte",question:"Existe treinamento para usar a plataforma?",answer:"Sim, oferecemos vídeos tutoriais e documentação completa. Você também pode agendar uma sessão de treinamento personalizada com nossa equipe."}],cn=()=>{const s=je(),[r,a]=c.useState(""),[t,o]=c.useState(null),[n,i]=c.useState("Todas"),m=["Todas",...Array.from(new Set(ls.map(d=>d.category)))],b=ls.filter(d=>{const g=d.question.toLowerCase().includes(r.toLowerCase())||d.answer.toLowerCase().includes(r.toLowerCase()),p=n==="Todas"||d.category===n;return g&&p}),y=d=>{o(t===d?null:d)};return e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx("div",{className:"bg-gradient-to-br from-indigo-600 to-indigo-400 dark:from-indigo-700 dark:to-indigo-500 text-white py-12",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>s("/painel-medico"),className:"absolute left-0 top-0 flex items-center gap-2 px-4 py-2 bg-white/10 hover:bg-white/20 rounded-lg transition-colors backdrop-blur-sm",children:[e.jsx(xs,{className:"h-5 w-5"}),e.jsx("span",{children:"Voltar ao Painel"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(hs,{className:"h-16 w-16 mx-auto mb-4"}),e.jsx("h1",{className:"text-4xl font-bold mb-2",children:"Central de Ajuda - Médicos"}),e.jsx("p",{className:"text-indigo-100 text-lg",children:"Suporte especializado para profissionais de saúde"})]})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 -mt-16 mb-8",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 hover:shadow-xl transition-shadow",children:e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("div",{className:"h-14 w-14 rounded-full bg-indigo-100 dark:bg-indigo-900 flex items-center justify-center mb-4",children:e.jsx(Ha,{className:"h-7 w-7 text-indigo-600 dark:text-indigo-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Chat Prioritário"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mb-4",children:"Suporte especializado para médicos"}),e.jsx("button",{className:"w-full bg-indigo-600 hover:bg-indigo-700 text-white py-2 px-4 rounded-lg transition-colors",children:"Iniciar Chat"})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 hover:shadow-xl transition-shadow",children:e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("div",{className:"h-14 w-14 rounded-full bg-green-100 dark:bg-green-900 flex items-center justify-center mb-4",children:e.jsx(Ka,{className:"h-7 w-7 text-green-600 dark:text-green-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Linha Direta"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mb-4",children:"0800-123-4567 (Opção 2)"}),e.jsx("button",{className:"w-full border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 py-2 px-4 rounded-lg transition-colors",children:"Ligar Agora"})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 hover:shadow-xl transition-shadow",children:e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("div",{className:"h-14 w-14 rounded-full bg-purple-100 dark:bg-purple-900 flex items-center justify-center mb-4",children:e.jsx(da,{className:"h-7 w-7 text-purple-600 dark:text-purple-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"E-mail Suporte"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mb-4",children:"secretaria.mediconnect@gmail.com"}),e.jsx("button",{className:"w-full border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 py-2 px-4 rounded-lg transition-colors",children:"Enviar E-mail"})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-md p-6 mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Perguntas Frequentes"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"Dúvidas comuns de médicos e profissionais de saúde"}),e.jsxs("div",{className:"relative mb-6",children:[e.jsx(ra,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar em perguntas frequentes...",value:r,onChange:d=>a(d.target.value),className:"w-full pl-12 pr-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent dark:bg-gray-700 dark:text-white"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:m.map(d=>e.jsx("button",{onClick:()=>i(d),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${n===d?"bg-indigo-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:d},d))})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-md p-6 mb-8",children:[e.jsx("div",{className:"space-y-4",children:b.map((d,g)=>e.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden",children:[e.jsxs("button",{onClick:()=>y(g),className:"w-full flex items-center justify-between p-4 text-left hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("span",{className:"px-2 py-1 bg-indigo-100 dark:bg-indigo-900 text-indigo-600 dark:text-indigo-400 text-xs font-medium rounded",children:d.category}),e.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:d.question})]}),e.jsx(br,{className:`h-5 w-5 text-gray-400 transition-transform flex-shrink-0 ml-4 ${t===g?"transform rotate-180":""}`})]}),t===g&&e.jsx("div",{className:"px-4 pb-4 pt-2 bg-gray-50 dark:bg-gray-700/50",children:e.jsx("p",{className:"text-gray-600 dark:text-gray-300 leading-relaxed pl-16",children:d.answer})})]},g))}),b.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Pa,{className:"h-12 w-12 text-gray-400 mx-auto mb-3"}),e.jsxs("p",{className:"text-gray-500 dark:text-gray-400 text-lg",children:['Nenhuma pergunta encontrada para "',r,'"']}),e.jsx("p",{className:"text-gray-400 dark:text-gray-500 text-sm mt-2",children:"Tente outro termo de busca ou entre em contato conosco"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-md p-6 mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-6",children:"Recursos para Médicos"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("button",{className:"flex items-center gap-4 p-4 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors text-left",children:[e.jsx("div",{className:"h-12 w-12 rounded-lg bg-indigo-100 dark:bg-indigo-900 flex items-center justify-center flex-shrink-0",children:e.jsx(ps,{className:"h-6 w-6 text-indigo-600 dark:text-indigo-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Manual do Médico"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Guia completo da plataforma"})]})]}),e.jsxs("button",{className:"flex items-center gap-4 p-4 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors text-left",children:[e.jsx("div",{className:"h-12 w-12 rounded-lg bg-red-100 dark:bg-red-900 flex items-center justify-center flex-shrink-0",children:e.jsx(ca,{className:"h-6 w-6 text-red-600 dark:text-red-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Treinamentos"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Vídeos e webinars"})]})]}),e.jsxs("button",{className:"flex items-center gap-4 p-4 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors text-left",children:[e.jsx("div",{className:"h-12 w-12 rounded-lg bg-green-100 dark:bg-green-900 flex items-center justify-center flex-shrink-0",children:e.jsx(ua,{className:"h-6 w-6 text-green-600 dark:text-green-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Modelos de Relatórios"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Templates prontos"})]})]}),e.jsxs("button",{className:"flex items-center gap-4 p-4 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors text-left",children:[e.jsx("div",{className:"h-12 w-12 rounded-lg bg-purple-100 dark:bg-purple-900 flex items-center justify-center flex-shrink-0",children:e.jsx(Va,{className:"h-6 w-6 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Conformidade LGPD"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Segurança e privacidade"})]})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-indigo-600 to-indigo-400 dark:from-indigo-700 dark:to-indigo-500 rounded-xl shadow-md p-8 text-center text-white",children:[e.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Precisa de ajuda específica?"}),e.jsx("p",{className:"text-indigo-100 mb-6",children:"Nossa equipe de suporte médico está à disposição"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[e.jsx("button",{className:"bg-white text-indigo-600 hover:bg-indigo-50 px-6 py-3 rounded-lg font-medium transition-colors",children:"Falar com Especialista"}),e.jsx("button",{className:"border-2 border-white text-white hover:bg-white/10 px-6 py-3 rounded-lg font-medium transition-colors",children:"Solicitar Treinamento"})]})]})]})]})},dn=()=>{const{user:s}=ke();return s?.role&&["medico","gestor","admin"].includes(s.role)?e.jsx(cn,{}):e.jsx(ln,{})};function un(){return e.jsx(Qs,{children:e.jsxs("div",{className:"app-root min-h-screen bg-gray-50 dark:bg-slate-900 dark:bg-gradient-to-br dark:from-slate-900 dark:to-slate-800 transition-colors duration-300",children:[e.jsx("a",{href:"#main-content",className:"fixed -top-20 left-4 z-50 px-3 py-2 bg-blue-600 text-white rounded shadow transition-all focus:top-4 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-blue-500",children:"Pular para o conteúdo"}),e.jsx(Bt,{}),e.jsx("main",{id:"main-content",className:"container mx-auto px-4 py-8",children:e.jsxs(Zs,{children:[e.jsx(me,{path:"/",element:e.jsx(eo,{})}),e.jsx(me,{path:"/paciente",element:e.jsx(ao,{})}),e.jsx(me,{path:"/login-secretaria",element:e.jsx(ro,{})}),e.jsx(me,{path:"/login-medico",element:e.jsx(so,{})}),e.jsx(me,{path:"/cadastro-medico",element:e.jsx(jo,{})}),e.jsx(me,{path:"/cadastro-paciente",element:e.jsx(wo,{})}),e.jsx(me,{path:"/dev/token",element:e.jsx(Qo,{})}),e.jsx(me,{path:"/admin/diagnostico",element:e.jsx(Zo,{})}),e.jsx(me,{path:"/teste-squad18",element:e.jsx(Wo,{})}),e.jsx(me,{path:"/cadastro",element:e.jsx(vo,{})}),e.jsx(me,{path:"/ajuda",element:e.jsx(dn,{})}),e.jsx(me,{element:e.jsx(La,{roles:["admin","gestor"]}),children:e.jsx(me,{path:"/admin",element:e.jsx(nn,{})})}),e.jsx(me,{element:e.jsx(La,{roles:["medico","gestor","secretaria","admin"]}),children:e.jsx(me,{path:"/painel-medico",element:e.jsx(_o,{})})}),e.jsxs(me,{element:e.jsx(La,{roles:["secretaria","gestor","admin"]}),children:[e.jsx(me,{path:"/painel-secretaria",element:e.jsx(Ko,{})}),e.jsx(me,{path:"/pacientes/:id",element:e.jsx(Xo,{})})]}),e.jsxs(me,{element:e.jsx(La,{roles:["paciente","user","admin","gestor"]}),children:[e.jsx(me,{path:"/acompanhamento",element:e.jsx(bo,{})}),e.jsx(me,{path:"/agendamento",element:e.jsx(ho,{})})]}),e.jsx(me,{path:"*",element:e.jsx(cr,{to:"/",replace:!0})})]})}),e.jsx(Ws,{position:"top-right"}),e.jsx(Jt,{})]})})}(()=>{try{const s=localStorage.getItem("accessibility-prefs");if(!s)return;const r=JSON.parse(s),a=document.documentElement;typeof r.fontSize=="number"&&(a.style.fontSize=`${r.fontSize}%`);const t=(o,n)=>{o?a.classList.add(n):a.classList.remove(n)};t(r.highContrast,"high-contrast"),t(r.darkMode,"dark"),t(r.dyslexicFont,"dyslexic-font"),t(r.lineSpacing,"line-spacing"),t(r.reducedMotion,"reduced-motion"),t(r.lowBlueLight,"low-blue-light"),t(r.focusMode,"focus-mode")}catch{}})();Ys.createRoot(document.getElementById("root")).render(e.jsxs(c.StrictMode,{children:[e.jsx($t,{children:e.jsx(un,{})}),e.jsx(et,{position:"top-right",autoClose:3e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"colored"})]}));export{Y as E,Q as h};
